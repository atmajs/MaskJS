UTest({
	'should evaluate script' () {
		var template = `
			script {
				window.foo = {
					// this refers to the window ctx
					isGlobal: this === window
				};
			}
		`;
		document.body.appendChild(mask.render(template));
		
		is_(window.foo, 'Object');
		eq_(window.foo.isGlobal, true);
	},
	'should serialize script node': {
		'single' () {
			var template = "section{script src=foo.js;}";
			var ast = mask.parse(template);
			var str = mask.stringify(ast);
			eq_(str, template);
		},
		'body' () {
			var template = "section{script type='text/mask'{ @@%any text }}";
			var ast = mask.parse(template);
			var str = mask.stringify(ast);
			eq_(str, template);
		}
	},
	'should render via literal' () {
		var template = `
			script > "var a = 10;"
		`;
		var dom = mask.render(template);
		eq_(dom.textContent, "var a = 10;");
	},
	'should interpolate script sources' () {
		var template = "each (scripts) > script src='~[.]'"
		var model = { scripts : [ '1.js', '2.js', '3.js' ] };
		return UTest.domtest(mask.render(template, model), `
			find (script) {
				length 3;
				eq(0) > attr('src', '1.js');
				eq(1) > attr('src', '2.js');
				eq(2) > attr('src', '3.js');
			}
		`);
	},
	'should interpolate script content' () {
		var template = "script > :html > '''~[foo]''' "
		var model = { foo : "var foo;" };
		var dom = mask.render(template, model);
		var script = dom.querySelector('script');
		notEq_(script, null);
		eq_(script.tagName, 'SCRIPT');
		eq_(script.textContent, "var foo;");
	}
})