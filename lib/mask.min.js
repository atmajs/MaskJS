(function(t,e){"use strict";var n="undefined"==typeof document?null:document,r=function(){return e(n)};"object"==typeof exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t.mask=r()})(this,function(document){"use strict";function util_extend(t,e){null==t&&(t={});for(var n in e)hasOwnProp.call(e,n)!==!1&&(t[n]=e[n]);return t}function util_getProperty(t,e){if("."===e)return t;for(var n=t,r=e.split("."),i=-1,o=r.length;null!=n&&o>++i;)n=n[r[i]];return n}function util_interpolate(t,e,n,r,i,o){for(var l,s,a,u,d=t.length,c=0,f=null,h="",p=!0;d>c;c++)p===!0?null==f?h+=t[c]:f.push(t[c]):(u=t[c],s=null,a=u.indexOf(":"),-1===a?s=util_getProperty(e,u):(l=a>0?u.substring(0,a).replace(regexpWhitespace,""):"",""===l&&(l="condition"),u=u.substring(a+1),"function"==typeof ModelUtils[l]&&(s=ModelUtils[l](u,e,n,r,i,o))),null!=s&&("object"==typeof s&&null==f&&(f=[h]),null==f?h+=s:f.push(s))),p=!p;return null==f?h:f}function Template(t){this.template=t,this.index=0,this.length=t.length}function Node(t,e){this.type=Dom.NODE,this.tagName=t,this.parent=e,this.attr={}}function TextNode(t,e){this.content=t,this.parent=e,this.type=Dom.TEXTNODE}function Fragment(){this.nodes=[]}function Component(t,e,n){this.tagName=t,this.parent=e,this.controller=n,this.attr={}}function builder_build(t,e,n,r,i,o){if(null==t)return r;var l,s=t.type;if(null==r&&1!==s&&(r=create_container()),null==i&&(i=new Component),10===s||t instanceof Array){for(var a=0,u=t.length;u>a;a++)builder_build(t[a],e,n,r,i,o);return r}if(null==s&&(null!=t.tagName?s=1:null!=t.content&&(s=2)),1===s||2===s){var d=create_node(t,e,n,r,i);if(null==d)return r||d;null!=o&&(o.push(d),o=null),r=d}if(4===s){var c=t.controller,f="function"==typeof c?new c(e):c;if(null!=f){f.compoName=t.tagName,f.attr=util_extend(f.attr,t.attr);for(var h in f.attr)"function"==typeof f.attr[h]&&(f.attr[h]=f.attr[h](e,"attr",n));if(f.nodes=t.nodes,f.parent=i,null!=listeners&&null!=listeners.compoCreated)for(var p=listeners.compoCreated,u=p.length,a=0;u>a;a++)p[a](f,e,n,r);if("function"==typeof f.render)return f.render(e,n,r),r;"function"==typeof f.renderStart&&f.renderStart(e,n,r),null!=f.tagName&&f.tagName!==t.compoName&&(f.nodes={tagName:f.tagName,attr:f.attr,nodes:f.nodes,type:1}),t=f}(i.components||(i.components=[])).push(t),i=t,l=[],null!=t.model&&(e=t.model)}var g=t.nodes;if(null!=g){null!=o&&null==l&&(l=o);for(var m=g instanceof Array,v=m===!0?g.length:1,b=0;v>b;b++)builder_build(m===!0?g[b]:g,e,n,r,i,l)}if(4===s&&"function"==typeof t.renderEnd&&t.renderEnd(l,e,n,r),null!=o&&o!==l)for(var y=o.length,C=l.length,a=-1;C>++a;)o[y+a]=l[a];return r}function create_container(){return document.createDocumentFragment()}function create_node(t,e,n,r,i){var o,l,s,a,u=t.tagName,d=t.attr,c=t.type;if(2===c){if(a=t.content,"function"!=typeof a)return r.appendChild(document.createTextNode(a)),null;var f=a(e,"node",n,r),h="";if("string"==typeof f)return r.appendChild(document.createTextNode(f)),null;for(o=0,l=f.length;l>o;o++)if(s=f[o],"object"!=typeof s)h+=s;else{if(""!==h&&(r.appendChild(document.createTextNode(h)),h=""),null==s.nodeType){console.warn("Not a HTMLElement",s,t,e),h+=""+s;continue}r.appendChild(s)}return""!==h&&r.appendChild(document.createTextNode(h)),null}var p,g,m=document.createElement(u);for(p in d)hasOwnProp.call(d,p)!==!1&&("function"==typeof d[p]?(g=d[p](e,"attr",n,m,p),g instanceof Array&&(g=g.join(""))):g=d[p],g&&("function"==typeof CustomAttributes[p]?CustomAttributes[p](t,g,m,e,n,i):m.setAttribute(p,g)));return null!=r&&r.appendChild(m),m}var regexpWhitespace=/\s/g,regexpEscapedChar={"'":/\\'/g,'"':/\\"/g,"{":/\\\{/g,">":/\\>/g,";":/\\>/g},hasOwnProp={}.hasOwnProperty,listeners=null;Template.prototype={skipWhitespace:function(){for(var t=this.template,e=this.index,n=this.length;n>e&&!(t.charCodeAt(e)>32);e++);return this.index=e,this},skipToAttributeBreak:function(){var t,e=this.template,n=this.index,r=this.length;do if(t=e.charCodeAt(++n),35===t&&123===e.charCodeAt(n+1))return this.index=n,this.sliceToChar("}"),this.index++,void 0;while(46!==t&&35!==t&&62!==t&&123!==t&&32!==t&&59!==t&&r>n);this.index=n},sliceToChar:function(t){for(var e,n,r=this.template,i=this.index,o=i,l=!1;(n=r.indexOf(t,i))>-1&&(i=n,92===r.charCodeAt(i-1));)l=!0,i++;return e=r.substring(o,i),this.index=i,l?e.replace(regexpEscapedChar[t],t):e}};var ConditionUtil=function(){function t(t,e){var n,r=e,i=t.index;if(null==r&&(t.skipWhitespace(),i=t.index,e=r=t.template.charCodeAt(t.index)),34===r||39===r)return t.index++,n=t.sliceToChar(39===r?"'":'"'),t.index++,n;do r=t.template.charCodeAt(++t.index);while(t.index<t.length&&32!==r&&33!==r&&60!==r&&61!==r&&62!==r&&40!==r&&41!==r&&38!==r&&124!==r);return n=t.template.substring(i,t.index),r=e,45===r||r>47&&58>r?n-0:116===r&&"true"===n?!0:102===r&&"false"===n?!1:{value:n}}function e(n,r){var i,o={assertions:null,join:null,left:null,right:null};null==r&&(r=[]),"string"==typeof n&&(n=new Template(n));t:for(;;){if(n.skipWhitespace(),n.index>=n.length)break;switch(i=n.template.charCodeAt(n.index)){case 61:case 60:case 62:case 33:var l=n.index;do i=n.template.charCodeAt(++n.index);while(n.index<n.length&&(60===i||61===i||62===i));o.sign=n.template.substring(l,n.index);continue;case 38:case 124:n.template.charCodeAt(++n.index)!==i&&console.error("Unary operation not valid"),o.join=38===i?"&&":"||",r.push(o),o={assertions:null,join:null,left:null,right:null},++n.index;continue;case 40:n.index++,e(n,o.assertions=[]);break;case 41:n.index++;break t;default:o[null==o.left?"left":"right"]=t(n,i);continue}}return(o.left||o.assertions)&&r.push(o),r}function n(n){if(null!=i[n])return i[n];var r=n.length,o={assertions:null,case1:null,case2:null},l=n.indexOf("?"),s=new Template(n);return-1!==l&&(s.length=l),o.assertions=e(s),-1!==l&&(s.length=r,s.index=l+1,o.case1=t(s),s.skipWhitespace(),58===s.template.charCodeAt(s.index)&&(s.index++,o.case2=t(s))),i[n]=o}function r(t,e){"string"==typeof t&&(t=n(t).assertions),null!=t.assertions&&(t=t.assertions);var i,o,l,s,a,u=!1;for(s=0,a=t.length;a>s;s++){if(i=t[s],i.assertions)u=r(i.assertions,e);else if(o="object"==typeof i.left?util_getProperty(e,i.left.value):i.left,null==i.right)u=o,"!"===i.sign&&(u=!u);else switch(l="object"==typeof i.right?util_getProperty(e,i.right.value):i.right,i.sign){case"<":u=l>o;break;case"<=":u=l>=o;break;case">":u=o>l;break;case">=":u=o>=l;break;case"!=":u=o!==l;break;case"==":u=o===l}if(u){if("&&"===i.join)continue;break}if("||"!==i.join&&"&&"===i.join)for(++s;a>s&&"||"!==t[s].join;s++);}return u}var i=[];return{condition:function(t,e){var i=n(t),o=r(i.assertions,e);return null!=i.case1&&(o=o?i.case1:i.case2),null==o?"":"object"==typeof o&&o.value?util_getProperty(e,o.value):o},isCondition:r,parse:n,out:{isCondition:r,parse:n}}}(),ModelUtils={condition:ConditionUtil.condition},CustomAttributes={"class":null,id:null,style:null,name:null,type:null},CustomTags={div:null,span:null,input:null,button:null,textarea:null,select:null,option:null,h1:null,h2:null,h3:null,h4:null,h5:null,h6:null,a:null,p:null,img:null,table:null,td:null,tr:null,pre:null,ul:null,li:null,ol:null,i:null,b:null,strong:null,form:null},Dom={NODE:1,TEXTNODE:2,FRAGMENT:3,COMPONENT:4,CONTROLLER:9,SET:10,Node:Node,TextNode:TextNode,Fragment:Fragment,Component:Component};Node.prototype={constructor:Node,type:Dom.NODE,tagName:null,parent:null,attr:null,nodes:null,__single:null},TextNode.prototype={type:Dom.TEXTNODE,content:null,parent:null},Fragment.prototype={constructor:Fragment,type:Dom.FRAGMENT,nodes:null},Component.prototype={constructor:Component,type:Dom.COMPONENT,parent:null,attr:null,controller:null,nodes:null,components:null};var Parser=function(t,e,n,r){function i(t){for(var e=-1;-1!==(e=t.indexOf(l,e))&&t.charCodeAt(e+1)!==u;)e++;if(-1===e)return t;for(var n=[],r=0,i=0,o=0;;){var o=t.indexOf(s,e+2);if(-1===o)break;for(n[i++]=r===e?"":t.substring(r,e),n[i++]=t.substring(e+2,o),r=e=o+1;-1!==(e=t.indexOf(l,e))&&t.charCodeAt(e+1)!==u;)e++;if(-1===e)break}return t.length>r&&(n[i]=t.substring(r)),t=null,function(t,e,r,i,o){if(null==e){for(var l,s="",a=0,u=n.length;u>a;a++)l=n[a],s+=1===a%2?"~["+l+"]":l;return s}return util_interpolate(n,t,e,r,i,o)}}function o(t,e,n,r){for(var i,o=0,l=0,s=0,a=/[\r\n]+/g,u={2:"tag",3:"tag",5:"attribute key",6:"attribute value",8:"literal"}[n];;){if(i=a.exec(t),null==i)break;if(i.index>e)break;l++,o=i.index}s=e-o;var d=["Mask - Unexpected",r,"at(",l,":",s,") [ in",u,"]"];console.error(d.join(" "),{template:t,stopped:t.substring(e)})}var l="~",s="]",a=126,u=91,d=93;return{parse:function(l){for(var s,c,f,h,p,g,m,v=new n,b=v,y=2,C=3,x=0,N=l.length,A=2,w=3,_=5,T=6,k=7,O=8,E=9;;)if(N>x&&33>(g=l.charCodeAt(x)))x++;else{if(C===_&&(null!=s&&(v.attr["class"]=i(s),s=null),null!=f&&(v.attr[f]=f,f=null,c=null)),null!=c){if(y===_)null==f?f=c:h=c,null!=f&&null!=h&&("class"!==f?v.attr[f]=h:s=null==s?h:s+" "+h,f=null,h=null);else if(C===w)p=null!=CustomTags[c]?new r(c,v,CustomTags[c]):new t(c,v),null==v.nodes?v.nodes=[p]:v.nodes.push(p),v=p,y=_;else if(C===O){if(p=new e(c,v),null==v.nodes?v.nodes=[p]:v.nodes.push(p),v.__single===!0)do v=v.parent;while(null!=v&&null!=v.__single);y=A}c=null}if(x>=N){y===_&&(null!=s&&(v.attr["class"]=i(s)),null!=f&&(v.attr[f]=f));break}if(y===E){for(v=v.parent;null!=v&&null!=v.__single;)v=v.parent;y=A}if(123!==g)if(62!==g)if(59!==g||null==v.nodes)if(59!==g&&125!==g)if(39!==g&&34!==g)if(y!==A||(C=w,y=w,46!==g&&35!==g)){if(y===_)if(46===g)x++,f="class",y=k;else if(35===g)x++,f="id",y=k;else{if(61===g){x++,y=T;continue}if(null!=f){c=f;continue}}if((y===T||y===k)&&(C=y,y=_),47===g&&47===l.charCodeAt(x+1)){for(x++;10!==g&&13!==g&&N>x;)g=l.charCodeAt(++x);for(;33>g&&N>x;)g=l.charCodeAt(++x)}var j=null;for(m=x;N>x;){if(g=l.charCodeAt(x),g===a&&l.charCodeAt(x+1)===u){j=!0,++x;do g=l.charCodeAt(++x);while(g!==d&&N>x)}if(39===g||34===g||47===g||60===g){o(l,x,y,String.fromCharCode(g));break}if(C!==T&&(46===g||35===g||61===g))break;if(62===g||123===g||33>g||59===g)break;x++}if(c=l.substring(m,x),!c){o(l,x,y,"*EMPTY*");break}j===!0&&(y===_&&"class"===f)==!1&&(c=i(c))}else c="div";else{y===T?y=_:C=y=O,x++;var P,M=!1,U=39===g?"'":'"';for(m=x;(P=l.indexOf(U,x))>-1&&(x=P,92===l.charCodeAt(P-1));)M=!0,x++;c=l.substring(m,x),M===!0&&(c=c.replace(regexpEscapedChar[U],U)),c=i(c),x++}else x++,C=y,y=E;else x++;else C=y,y=A,x++,v.__single=!0;else C=y,y=A,x++}if(isNaN(g))throw console.log(g,_index,_length),"";return null!=v.parent&&v.parent!==b&&v.parent.__single!==!0&&null!=v.nodes&&console.warn("Mask - ",v.parent.tagName,JSON.stringify(v.parent.attr),"was not proper closed."),1===b.nodes.length?b.nodes[0]:b},cleanObject:function(t){if(t instanceof Array){for(var e=0;t.length>e;e++)this.cleanObject(t[e]);return t}return delete t.parent,delete t.__single,null!=t.nodes&&this.cleanObject(t.nodes),t},setInterpolationQuotes:function(t,e){return t&&2===t.length?e&&1===e.length?(a=t.charCodeAt(0),u=t.charCodeAt(1),d=e.charCodeAt(0),s=e,l=t.charAt(0),void 0):(console.error("Interpolation End must be of 1 Character"),void 0):(console.error("Interpolation Start must contain 2 Characters"),void 0)}}}(Node,TextNode,Fragment,Component),cache={},Mask={render:function(t,e,n,r,i){return null!=r&&"function"!=typeof r.appendChild&&(console.error(".render(template[, model, cntx, container, controller]","Container should implement .appendChild method"),console.warn("Args:",arguments)),"string"==typeof t&&(t=hasOwnProp.call(cache,t)?cache[t]:cache[t]=Parser.parse(t)),builder_build(t,e,n,r,i)},compile:Parser.parse,parse:Parser.parse,registerHandler:function(t,e){CustomTags[t]=e},getHandler:function(t){return null!=t?CustomTags[t]:CustomTags},registerAttrHandler:function(t,e){CustomAttributes[t]=e},registerUtility:function(t,e){ModelUtils[t]=e},clearCache:function(t){"string"==typeof t?delete cache[t]:cache={}},ValueUtils:{condition:ConditionUtil.condition,out:ConditionUtil},Utils:{Condition:ConditionUtil,getProperty:util_getProperty},Dom:Dom,plugin:function(source){eval(source)},on:function(t,e){null==listeners&&(listeners={}),(listeners[t]||(listeners[t]=[])).push(e)},delegateReload:function(){},setInterpolationQuotes:Parser.setInterpolationQuotes};return Mask.renderDom=Mask.render,function(t){var e=function(){function e(t){for(var e="";t--;)e+=" ";return e}function n(t,n,i){var o,l;null==n&&(n=0),null==i&&(o=!0,i=[]);var s=i.length;if(t.type===c.FRAGMENT&&(t=t.nodes),t instanceof Array)for(l=0;t.length>l;l++)r(t[l],n,i);else r(t,n,i);var a=e(n);for(l=s;i.length>l;l++)i[l]=a+i[l];return o?i.join(0===d?"":"\n"):void 0}function r(t,e,r){return"string"==typeof t.content?(r.push(a(t.content)),void 0):"function"==typeof t.content?(r.push(a(t.content())),void 0):o(t)?(r.push(i(t)+";"),void 0):l(t)?(r.push(i(t)+" > "),n(s(t),d,r),void 0):(r.push(i(t)+"{"),n(t.nodes,d,r),r.push("}"),void 0)}function i(t){var e=t.tagName,n=t.attr.id||"",r=t.attr["class"]||"";"function"==typeof n&&(n=n()),"function"==typeof r&&(r=r()),n&&(n=-1!==n.indexOf(" ")?"":"#"+n),r&&(r="."+r.split(" ").join("."));var i="";for(var o in t.attr)if("id"!==o&&"class"!==o){var l=t.attr[o];"function"==typeof l&&(l=l()),(u===!1||/\s/.test(l))&&(l=a(l)),i+=" "+o+"="+l}return"div"===e&&(n||r)&&(e=""),e+n+r+i}function o(t){return null==t.nodes||t.nodes instanceof Array&&0===t.nodes.length}function l(t){return t.nodes&&(t.nodes instanceof Array==!1||1===t.nodes.length)}function s(t){return t.nodes instanceof Array?t.nodes[0]:t.nodes}function a(t){return-1===t.indexOf('"')?'"'+t.trim()+'"':-1===t.indexOf("'")?"'"+t.trim()+"'":'"'+t.replace(/"/g,'\\"').trim()+'"'}var u,d,c=t.Dom;return function(e,r){return"string"==typeof e&&(e=t.parse(e)),"number"==typeof r?(d=r,u=0===d):(d=r&&r.indent||4,u=0===d||r&&r.minimizeAttributes),n(e)}}();Mask.stringify=e}(Mask),function(t){function e(){}function n(t,e,n,r){null==t.nodes&&"undefined"!=typeof Compo&&Compo.ensureTemplate(t);var i=util_getProperty(e,t.attr.foreach||t.attr.each),o=t.nodes,l=null;if(t.nodes=[],t.template=o,i instanceof Array!=!1)for(var s,a=0,u=i.length;u>a;a++)s=i[a],l=new Component,l.nodes=o,l.model=s,l.container=r,t.nodes[a]=l}t.registerHandler("%",e),e.prototype={constructor:e,renderStart:function(t,e,r){var i=this.attr;if(null!=i.use)return this.model=util_getProperty(t,i.use),void 0;if(null==i["debugger"]){if(null!=i.log){var o=i.log,l=util_getProperty(t,o);return console.log("Key: %s, Value: %s",o,l),void 0}if(this.model=t,null!=i["if"]){var s=i["if"];return this.state=ConditionUtil.isCondition(s,t),this.state||(this.nodes=null),void 0}if(null!=i["else"]){var a=this.parent.components,u=a&&a[a.length-1];return null!=u&&"%"===u.compoName&&null!=u.attr["if"]?(u.state&&(this.nodes=null),void 0):(console.error("Previous Node should be \"% if='condition'\"",u,this.parent),void 0)}(null!=i.foreach||null!=i.each)&&n(this,t,e,r)}},render:null}}(Mask),function(t){function e(){}function n(){}var r={};t.templates=r,t.registerHandler(":template",e),e.prototype.render=function(){return null!=this.attr.id?(console.warn("Template Should be defined with ID attribute for future lookup"),void 0):(r[this.attr.id]=this,void 0)},t.registerHandler(":html",n),n.prototype.render=function(t,e,n){var r=null;if(null!=this.attr.template){var i=this.attr.template[0];"#"===i&&(r=document.getElementById(this.attr.template.substring(1)).innerHTML)}return this.nodes&&(r=this.nodes[0].content),null==r?(console.warn("No HTML for node",this),void 0):(n.innerHTML=r,void 0)}}(Mask),function(t){function e(t,e){for(var n=0,r=e.length-1;r>n;n++){var i=e.shift();null==t[i]&&(t[i]={}),t=t[i]}return t}function n(t,e){if(null==e)return t;null==t&&(t={});for(var n in e)t[n]=e[n];return t}function r(t,e){for(var n=e.split("."),r=n.length,i=0;r>i;i++){if(null==t)return null;t=t[n[i]]}return t}function i(t,e,n){for(var r=e.split("."),i=r.length,o=0,l=null;i-1>o;o++)l=r[o],null==t[l]&&(t[l]={}),t=t[l];t[r[o]]=n}function o(t,n,r){if(null==t.__observers&&Object.defineProperty(t,"__observers",{value:{},enumerable:!1}),t.__observers[n])return t.__observers[n].push(r),void 0;var i=t.__observers[n]=[r],o=n.split("."),l=o.length>1?e(t,o):t,s=o[0],a=l[s];Object.defineProperty(l,s,{get:function(){return a},set:function(t){a=t;for(var e=0,n=i.length;n>e;e++)i[e](t)}})}function l(t,e){function n(n){t[n]=function(){Array.prototype[n].apply(this,arguments),e(this,n,arguments)}}Object.defineProperty(t,"hasObserver",{value:!0,enumerable:!1,writable:!1});for(var r=0,i=["push","unshift","splice","pop","shift","reverse","sort"],o=i.length;o>r;r++)n(i[r])}function s(t,e,n){return"function"==typeof g?(g(t).on(e,n),void 0):null!=t.addEventListener?(t.addEventListener(e,n,!1),void 0):(t.attachEvent&&t.attachEvent("on"+e,n),void 0)}function a(){}function u(){}function d(t,e,r,i){if(this.constructor===d){var l=r.attr.bindingProvider||e.tagName.toLowerCase();if(m[l]instanceof Function)return new m[l](t,e,r);n(this,m[l])}return null==i&&(i=":bind"===r.compoName?"single":"dual"),this.node=r,this.model=t,this.element=e,this.property=r.attr.property||("single"===i?"element.innerHTML":"element.value"),this.setter=r.attr.setter,this.getter=r.attr.getter,this.dismiss=0,o(t,r.attr.value,this.objectChanged.bind(this)),"single"!==i&&s(e,r.attr.changeEvent||"change",this.domChanged.bind(this)),this.objectChanged(),this}function c(){}function f(){}function h(t,e){if(null==e&&(e=[]),null==t.components)return e;for(var n,r=t.components,i=0,o=r.length;o>i;i++)n=r[i],"validate"!==n.compoName?h(n):e.push(n);return e}function p(t,e){if(null==t)return null;if(null!=t.slots&&t.slots[e]!==void 0){var n=t.slots[e];return"string"==typeof n&&(n=t[n]),"function"!=typeof n&&console.error("Controller defines slot, but that is not a function",t,e),n.bind(t)}return p(t.parent,e)}var g=window.jQuery||window.Zepto||window.$;null==g&&console.warn("Without jQuery/Zepto etc. binder is limited (mouse dom event bindings)"),t.registerHandler(":visible",a),a.prototype={constructor:a,refresh:function(e,n){n.style.display=t.Utils.Condition.isCondition(this.attr.check,e)?"":"none"},renderStart:function(t,e,n){this.refresh(t,n),this.attr.bind&&o(t,this.attr.bind,this.refresh.bind(this,t,n))}},t.registerHandler(":bind",u),u.prototype.renderStart=function(t,e,n){new d(t,n,this,"single")},t.registerUtility("bind",function(t,e,n,i,l,s){var a=r(e,t);switch(n){case"node":var u=document.createTextNode(a);return o(e,t,function(t){u.textContent=t}),u;case"attr":return o(e,t,function(t){var e=l.getAttribute(s);l.setAttribute(s,e.replace(a,t)),a=t}),a}return console.error("Unknown binding type",arguments),"Unknown"});var m={};t.registerBinding=function(t,e){m[t]=e},t.BindingProvider=d,d.prototype={constructor:d,objectChanged:function(t){this.dismiss-->0||(null==t&&(t=this.objectWay.get(this.model,this.node.attr.value)),this.domWay.set(this,t),t instanceof Array&&t.hasObserver!==!0&&l(t,this.objectChanged.bind(this)))},domChanged:function(){var t=this.domWay.get(this);if(this.node.validations)for(var e,n=0,r=this.node.validations.length;r>n;n++)if(e=this.node.validations[n],e.validate(t,this.element,this.objectChanged.bind(this))===!1)return;this.dismiss=1,this.objectWay.set(this.model,this.node.attr.value,t),this.dismiss=0},objectWay:{get:function(e,n){return":"===n[0]?t.Utils.ConditionUtil.condition(n.substring(1)):r(e,n)},set:function(t,e,n){i(t,e,n)}},domWay:{get:function(t){return t.getter?t.node.parent[t.getter]():r(t,t.property)},set:function(t,e){t.setter?t.node.parent[t.setter](e):i(t,t.property,e)}}},t.registerHandler(":dualbind",c),c.prototype.renderEnd=function(t,e,n,r){if(this.components)for(var i,o=0,l=this.components.length;l>o;o++)i=this.components[o],":validate"===i.compoName&&(this.validations||(this.validations=[])).push(i);new d(e,r,this)},function(){function e(){}function n(t,e,n){console.warn("Validate Notification:",t,e);var r=g(t).next(".-validate-invalid");0===r.length&&(r=g("<div>").addClass("-validate-invalid").html("<span></span><button>cancel</button>").insertAfter(t)),r.children("button").off().on("click",function(){r.hide(),n&&n()}).end().children("span").text(e).end().show()}function i(t){g(t).next(".-validate-invalid").hide()}t.registerValidator=function(t,e){o[t]=e},t.registerHandler(":validate",e),e.prototype={constructor:e,renderStart:function(t,e,n){this.element=n,this.model=t},validate:function(t,e,o){null==e&&(e=this.element),this.attr.getter&&(t=r({node:this,element:e},this.attr.getter)),null==this.validators&&this.initValidators();for(var l,s=0,a=this.validators.length;a>s;s++)if(l=this.validators[s],l.validate(this,t)===!1)return n(e,this.message,o),!1;return i(e),!0},initValidators:function(){this.validators=[],this.message=this.attr.message,delete this.attr.message;for(var t in this.attr)if(t in o!=!1){var e=o[t];"function"==typeof e&&(e=new e(this)),this.validators.push(e)}else console.error("Unknown Validator:",t,this)}};var o={match:{validate:function(t,e){return RegExp(t.attr.match).test(e)}},unmatch:{validate:function(t,e){return!RegExp(t.attr.unmatch).test(e)}},minLength:{validate:function(t,e){return e.length>=parseInt(t.attr.minLength,10)}},maxLength:{validate:function(t,e){return e.length<=parseInt(t.attr.maxLength,10)}}}}(),t.registerHandler(":validate:group",f),f.prototype={constructor:f,validate:function(){for(var t,e=h(this),n=0,r=e.length;r>n;n++)if(t=e[n],!t.validate())return!1;return!0}},t.registerAttrHandler("x-signal",function(t,e,n,r,i,o){for(var l,a=e.split(";"),u=0,d=a.length;d>u;u++){l=a[u];var c=l.substring(0,l.indexOf(":")),f=l.substring(l.indexOf(":")+1).trim(),h=p(o,f);h&&s(n,c,h),!h&&console.warn("No slot found for signal",f,o)}})}(Mask),Mask});