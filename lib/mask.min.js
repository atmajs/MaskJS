/*!
 * MaskJS v0.12.5
 * Part of the Atma.js Project
 * http://atmajs.com/
 *
 * MIT license
 * http://opensource.org/licenses/MIT
 *
 * (c) 2012, 2015 Atma.js and other contributors
 */
!function(e,n){"use strict";function t(){return n(i,r,o)}var r,o,i="undefined"==typeof window||null==window.navigator?global:window;return"undefined"==typeof exports||null!=e&&e!==exports&&e!==i||(e=exports),o=i.document,r=e||i,"function"==typeof define&&define.amd?define(t):t()}(this,function(global,exports,document){"use strict";function util_interpolate(e,n,t,r,o,i,s){for(var l,u,a,c,f,p=e.length,d=-1,h=null,m="",v=!0;++d<p;){if(v===!0)null==h?m+=e[d]:h.push(e[d]);else{if(c=e[d],u=null,a=c.indexOf(":"),-1===a)u=obj_getPropertyEx(c,t,r,i);else{if(l=a>0?c.substring(0,a).trim():"",""===l&&(l="expression"),c=c.substring(a+1),f=custom_Utils[l],null==f){log_error("Undefined custom util `%s`",l);continue}u=f(c,t,r,o,i,s,n)}null!=u&&("object"==typeof u&&null==h&&(h=[m]),null==h?m+=u:h.push(u))}v=!v}return null==h?m:h}function Template(e){this.template=e,this.index=0,this.length=e.length}function VarStatement(){}var coll_each,coll_remove,coll_map,coll_indexOf,coll_find;if(function(){coll_each=function(e,n,t){if(null==t&&(t=e),null==e)return e;for(var r=e.length,o=0;r>o;o++)n.call(t,e[o],o);return t},coll_indexOf=function(e,n){if(null==e)return-1;for(var t=e.length,r=0;t>r;r++)if(e[r]===n)return r;return-1},coll_remove=function(e,n){var t=coll_indexOf(e,n);return-1===t?!1:(e.splice(t,1),!0)},coll_map=function(e,n,t){var r=new Array(e.length);return coll_each(e,function(e,t){r[t]=n.call(this,e,t)},t),r},coll_find=function(e,n,t){for(var r=e.length,o=0;r>o;o++)if(n.call(t||e,e[o],o))return!0;return!1}}(),void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(e,n){coll_each(this,e,n)}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(e){return coll_indexOf(this,e)}),null==String.prototype.trim&&(String.prototype.trim=function(){var e,n=-1,t=this.length;if(0===t)return this;for(;++n<t&&(e=this.charCodeAt(n),!(e>32)););for(;0!==--t&&(e=this.charCodeAt(t),!(e>32)););return 0!==n&&t!==length-1?this.substring(n,t+1):this}),null==Function.prototype.bind){var _Array_slice;Function.prototype.bind=function(){if(arguments.length<2&&"undefined"==typeof arguments[0])return this;var e=this,n=_Array_slice.call(arguments),t=n.shift();return function(){return e.apply(t,n.concat(_Array_slice.call(arguments)))}}}var is_Function,is_Array,is_ArrayLike,is_String,is_Object,is_notEmptyString,is_rawObject;!function(){is_Function=function(e){return"function"==typeof e},is_Object=function(e){return null!=e&&"object"==typeof e},is_Array=is_ArrayLike=function(e){return null!=e&&"object"==typeof e&&"number"==typeof e.length&&"function"==typeof e.slice},is_String=function(e){return"string"==typeof e},is_notEmptyString=function(e){return"string"==typeof e&&""!==e},is_rawObject=function(e){return null==e||"object"!=typeof e?!1:e.constructor===Object}}();var obj_getProperty,obj_setProperty,obj_extend,obj_extendMany,obj_create;!function(){obj_getProperty=function(e,n){if("."===n)return e;for(var t=n.split("."),r=t.length,o=-1;null!=e&&++o<r;)e=e[t[o]];return e},obj_setProperty=function(e,n,t){for(var r,o=n.split("."),i=o.length-1,s=-1;++s<i;)r=o[s],null==e[r]&&(e[r]={}),e=e[r];e[o[s]]=t},obj_extend=function(e,n){if(null==n)return e||{};if(null==e)return obj_create(n);for(var t in n)e[t]=n[t];return e},obj_extendMany=function(e){for(var n=arguments.length,t=1;n>t;t++)e=obj_extend(e,arguments[t]);return e},obj_create=Object.create||function(e){var n=function(){};return n.prototype=e,new n}}();var arr_remove,arr_each,arr_indexOf,arr_contains;!function(){arr_remove=function(e,n){var t=e.indexOf(n);return-1===t?!1:(e.splice(t,1),!0)},arr_each=function(e,n,t){e.forEach(n,t)},arr_indexOf=function(e,n){return e.indexOf(n)},arr_contains=function(e,n){return-1!==e.indexOf(n)}}();var fn_proxy,fn_apply,fn_doNothing;!function(){fn_proxy=function(e,n){return function(){return fn_apply(e,n,arguments)}},fn_apply=function(e,n,t){var r=t.length;return 0===r?e.call(n):1===r?e.call(n,t[0]):2===r?e.call(n,t[0],t[1]):3===r?e.call(n,t[0],t[1],t[2]):4===r?e.call(n,t[0],t[1],t[2],t[3]):e.apply(n,t)},fn_doNothing=function(){return!1}}();var class_create;!function(){class_create=function(){var e=_Array_slice.call(arguments),n=e.pop();null==n&&(n={});for(var t,r,o,i=n.hasOwnProperty("constructor")?n.constructor:null,s=e.length;--s>-1;){r=e[s],"function"==typeof r&&(null==t&&(t=r),r=r.prototype);for(var l in r)null==n[l]&&(n[l]=r[l]);null==o&&(o=r)}if(n.Parent=o,null==i)i=null==t?function(){}:function(){return t.apply(this,_Array_slice.call(arguments))};else if(t){var u=i;i=function(){var e=_Array_slice.call(arguments),n=t.apply(this,e);return void 0!==n?n:u.apply(this,e)}}return n.constructor=i,i.prototype=n,i}}();var class_Dfr;!function(){function e(e,n,t,r){return null==r?e:(null!=n?fn_apply(r,e,n):t.push(r),e)}function n(e){e._done=null,e._fail=null,e._always=null}function t(e,n,t){if(null!=e){for(var r,o=e.length,i=-1;++i<o;)r=e[i],r&&fn_apply(r,n,t);e.length=0}}function r(e){return null==e||"object"!=typeof e?!1:e instanceof class_Dfr?!0:"function"==typeof e.done&&"function"==typeof e.fail}class_Dfr=function(){},class_Dfr.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){return this._rejected=null,this._resolved=null,this},isResolved:function(){return null!=this._resolved},isRejected:function(){return null!=this._rejected},isBusy:function(){return null==this._resolved&&null==this._rejected},resolve:function(){var e=this._done,r=this._always;return this._resolved=arguments,n(this),t(e,this,arguments),t(r,this,[this]),this},reject:function(){var e=this._fail,r=this._always;return this._rejected=arguments,n(this),t(e,this,arguments),t(r,this,[this]),this},then:function(e,n){return this.pipe(e,n)},done:function(n){return null!=this._rejected?this:e(this,this._resolved,this._done||(this._done=[]),n)},fail:function(n){return null!=this._resolved?this:e(this,this._rejected,this._fail||(this._fail=[]),n)},always:function(n){return e(this,this._rejected||this._resolved,this._always||(this._always=[]),n)},pipe:function(e){function n(e,n,t){return function(){if(null!=t){var o=t.apply(this,arguments);if(null!=o)return r(o)===!0?void o.pipe(e):void e[n](o)}e[n].apply(e,arguments)}}var t;if("function"==typeof e){t=new class_Dfr;var o=e,i=arguments.length>1?arguments[1]:null;return this.done(n(t,"resolve",o)).fail(n(t,"reject",i)),t}t=e;for(var s,l=arguments.length,u=1===l,a=1===l,c=0;++c<l;)switch(s=arguments[c]){case"done":u=!0;break;case"fail":a=!0;break;default:console.error("Unsupported pipe channel",arguments[c])}return u&&this.done(t.resolveDelegate()),a&&this.fail(t.rejectDelegate()),this},pipeCallback:function(){var e=this;return function(n){if(null!=n)return void e.reject(n);var t=_Array_slice.call(arguments,1);fn_apply(e.resolve,e,t)}}},class_Dfr.run=function(e,n){var t=new class_Dfr;return null==n&&(n=t),e.call(n,t.resolveDelegate(),t.rejectDelegate(),t),t}}();var _Array_slice=Array.prototype.slice,_Array_splice=Array.prototype.splice,_Array_indexOf=Array.prototype.indexOf,_Object_create=obj_create,_Object_hasOwnProp=Object.hasOwnProperty,__rgxEscapedChar={"'":/\\'/g,'"':/\\"/g,"{":/\\\{/g,">":/\\>/g,";":/\\>/g},__cfg={allowCache:!0},attr_extend;!function(){attr_extend=function(e,n){if(null==e)return null==n?{}:obj_create(n);if(null==n)return e;var t;for(t in n)"class"!==t||"string"!=typeof e[t]?e[t]=n[t]:e[t]+=" "+n[t];return e}}(),Template.prototype={skipWhitespace:function(){for(var e=this.template,n=this.index,t=this.length;t>n&&!(e.charCodeAt(n)>32);n++);return this.index=n,this},skipToAttributeBreak:function(){var e,n=this.template,t=this.index,r=this.length;do if(e=n.charCodeAt(++t),35===e&&123===n.charCodeAt(t+1))return this.index=t,this.sliceToChar("}"),void this.index++;while(46!==e&&35!==e&&62!==e&&123!==e&&32!==e&&59!==e&&r>t);this.index=t},sliceToChar:function(e){for(var n,t,r=this.template,o=this.index,i=o,s=!1;(t=r.indexOf(e,o))>-1&&(o=t,92===r.charCodeAt(o-1));)s=!0,o++;return n=r.substring(i,o),this.index=o,s?n.replace(__rgxEscapedChar[e],e):n}};var arr_pushMany;!function(){arr_pushMany=function(e,n){if(null!=n&&null!=e)for(var t=e.length,r=n.length,o=-1;++o<r;)e[t+o]=n[o]}}();var obj_getPropertyEx,obj_toDictionary;!function(){function e(e,n,t,r){for(var o=e;r>t&&null!=o;)o=o[n[t]],t++;return o}obj_getPropertyEx=function(n,t,r,o){if("."===n)return t;var i,s=n.split("."),l=t,u=-1,a=s.length,c=s[0];for("$c"===c?(l=o,u++):"$a"===c?(l=o&&o.attr,u++):"$u"===c?(l=customUtil_$utils,u++):"$ctx"===c&&(l=r,u++),i=u;null!=l&&++u<a;)l=l[s[u]];if(null==l&&-1===i)for(var f;null!=o;){if(f=o.scope,null!=f&&(l=e(f,s,0,a),null!=l))return l;o=o.parent}return l},obj_toDictionary=function(e){var n,t=[],r=0;for(n in e)t[r++]={key:n,value:e[n]};return t}}();var listeners_on,listeners_off,listeners_emit;!function(){listeners_on=function(n,t){(e[n]||(e[n]=[])).push(t)},listeners_off=function(n,t){return null==t?void(e[n]=[]):void arr_remove(e[n],t)},listeners_emit=function(n){var t=e[n];if(null==t)return!1;var r=t.length,o=-1,i=_Array_slice.call(arguments,1);if(0===r)return!1;for(;++o<r;)t[o].apply(null,i);return!0};var e={compoCreated:null,error:null}}();var throw_,parser_error,parser_warn,log,log_warn,log_error,log_errorNode;!function(){function e(e){function r(t,r,o){this.type="Parser"+e,this.message=t,this.original=r,this.index=o,this.stack=n()}return t(r,Error),r}function n(){var e=(new Error).stack;return null==e?null:e.split("\n").slice(6,8).join("\n")}function t(e,n){e.prototype=obj_create(n.prototype)}function r(e,n,t,r,u,a,c){n+=o(u)+i(t,r,c)+"\nParser "+s(a)+l(e,t,r);var d="error"===e?f:p;return new d(n,t,r)}function o(e){return null==e?"":("number"==typeof e&&(e=String.fromCharCode(e))," Invalid token: `"+e+"`")}function i(e,n,t){if(null==n||!t)return"";var r=u(e,n),o=r[1],i=r[2];return" at "+(t||"")+"("+o+":"+i+")"}function s(e){var n={2:"tag",3:"tag",5:"attribute key",6:"attribute value",8:"literal","var":"VarStatement",expr:"Expression"};return null==e||null==n[e]?"":' on "'+n[e]+'"'}function l(e,n,t){if(null==t)return"";var r=u(n,t),o=r[0],i=r[1],s=r[2];return null==t?"":" at ("+i+":"+s+") \n"+c(o,i,s)}function u(e,n){var t=e.substring(0,n).split("\n"),r=t.length,o=n+1-t.slice(0,r-1).join("\n").length;return r>1&&(o-=1),[e.split("\n"),r,o]}if(throw_=function(e){log_error(e),listeners_emit("error",e)},parser_error=function(e,n,t,o,i,s){var l=r("error",e,n,t,o,i,s);listeners_emit("error",l)||(log_error(l.message),log_warn("\n"+l.stack))},parser_warn=function(e,n,t,o,i,s){var l=r("warn",e,n,t,o,i,s);listeners_emit("error",l)||(log_warn(l.message),log("\n"+l.stack))},log_errorNode=function(e){return parser_parse('div style="background:red;color:white;">tt>"'+e+'"')},"undefined"==typeof console)log=log_warn=log_error=function(){};else{var a=Function.prototype.bind;log=a.call(console.warn,console),log_warn=a.call(console.warn,console,"MaskJS [Warn] :"),log_error=a.call(console.error,console,"MaskJS [Error] :")}var c,f=e("Error"),p=e("Warning");!function(){function e(e,n){for(var t=String(e);t.length<n;)t+=" ";return t}function n(e,n){for(var t="";--n>-1;)t+=e;return t}c=function(t,r,o){var i=3,s=2,l=r-1-i,u=l+i+s,a="";0>l&&(l=0),u>t.length&&(u=t.length);for(var c,f=String(u).length;u>l;l++)a&&(a+="\n"),c=e(l+1,f),a+=c+"|"+t[l],l+1===r&&(a+="\n"+n(" ",f+1),a+=t[l].substring(0,o-1).replace(/[^\s]/g," "),a+="^");return a}}()}();var path_getDir,path_getFile,path_getExtension,path_resolveCurrent,path_normalize,path_win32Normalize,path_resolveUrl,path_combine,path_isRelative;!function(){function e(e){for(;-1!==e.indexOf("../");)e=e.replace(r,"");return e.replace(/\/\.\//g,"/")}var n=!0;path_getDir=function(e){return e.substring(0,e.lastIndexOf("/")+1)},path_getFile=function(e){return e=e.replace("file://","").replace(/\\/g,"/").replace(/\?[^\n]+$/,""),/^\/\w+:\/[^\/]/i.test(e)?e.substring(1):e},path_getExtension=function(e){var n=e.indexOf("?");if(-1!==n)return path_getExtension(e.substring(0,n));var t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)},path_resolveCurrent=function(){if(null==document)return"undefined"==typeof module?"":path_win32Normalize(module.parent.filename);var e=window.location.pathname.replace(/\/[^\/]+\.\w+$/,"");return"/"===e[e.length-1]?e:e+"/"},path_normalize=function(e){return e.replace(/\\/g,"/").replace(/([^:\/])\/{2,}/g,"$1/").replace(/\.\//g,"")},path_win32Normalize=function(e){return e=path_normalize(e),"file:"===e.substring(0,5)?e:"file:///"+e},path_resolveUrl=function(r,o){return t.test(r)?e(r):("./"===r.substring(0,2)&&(r=r.substring(2)),"/"===r[0]&&__cfg.path&&(r=__cfg.path+r.substring(1),t.test(r))?e(r):("/"===r[0]?(n===!1||__cfg.lockedToFolder===!0)&&(r=r.substring(1)):null!=o&&(r=o+r),e(r)))},path_isRelative=function(e){var n=e.charCodeAt(0);switch(n){case 47:return!1;case 102:case 104:return t.test(e)===!1}return!0},path_combine=function(){for(var e,n="",t=arguments.length,r=-1;++r<t;)e=arguments[r],e&&(e=path_normalize(e),""!==n?("/"!==n[n.length-1]&&(n+="/"),"/"===e[0]&&(e=e.substring(1)),n+=e):n=e);return n};var t=/^(file|https?):/i,r=/([^\/]+\/)?\.\.\//}();var file_get,file_getScript;!function(){function e(e,n,r){n=path_resolveUrl(n,r);var o=t[n];return void 0!==o?o:(o=new class_Dfr,e(n,o.pipeCallback()),o)}file_get=function(t,r){return e(n,t,r)},file_getScript=function(n,t){return e(r,n,t)};var n,t={};!function(){n=function(e,n){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState){var r,o=t.responseText;200!==t.status&&(r={status:t.status,content:o},log_warn("File error",e,t.status)),n(r,o)}},t.open("GET",e,!0),t.send()}}();var r;!function(){r=function(t,r){var o=new n(t).done(function(e){r(null,e)}).fail(function(e){r(e)});e.load(o)};var e,n=class_create(class_Dfr,{exports:null,url:null,state:0,constructor:function(e){this.url=e},load:function(){if(0!==this.state)return this;this.state=1,global.module={};var e=this;return t(this.url,function(n){return e.state=4,n&&"error"===n.type?void e.reject(n):void e.resolve(e.exports=global.module.exports)}),this}});!function(){function n(){if(0!==t.length){var e=t[0];0===e.state&&e.load().always(n)}}e={load:function(e){t.push(e),n()}};var t=[]}();var t;!function(){t=function(n,t){var r=document.createElement("script");r.type="text/javascript",r.src=n,"onreadystatechange"in r?r.onreadystatechange=function(){("complete"===this.readyState||"loaded"===this.readyState)&&t()}:r.onload=r.onerror=t,void 0===e&&(e=document.getElementsByTagName("head")[0]),e.appendChild(r)};var e}()}()}();var custom_Utils,custom_Statements,custom_Attributes,custom_Tags,custom_Tags_global,custom_Tags_defs,custom_Parsers,custom_Optimizers,customUtil_get,customUtil_$utils,customUtil_register,customTag_register,customTag_registerResolver;!function(){var e={div:null,span:null,input:null,button:null,textarea:null,select:null,option:null,h1:null,h2:null,h3:null,h4:null,h5:null,h6:null,a:null,p:null,img:null,table:null,td:null,tr:null,pre:null,ul:null,li:null,ol:null,i:null,em:null,b:null,br:null,strong:null,form:null,audio:null,video:null,canvas:null,svg:null},n={"class":null,id:null,style:null,name:null,type:null,value:null,required:null};custom_Utils={expression:function(e,n,t,r,o){return ExpressionUtil.eval(e,n,t,o)}},custom_Optimizers={},custom_Statements={},custom_Attributes=obj_create(n),custom_Tags=obj_create(e),custom_Tags_global=obj_create(e),custom_Parsers=obj_create(e),custom_Tags_defs={},function(e,n){function t(e){function n(e,n){this.ID=null,this.tagName=e.tagName,this.attr=e.attr,this.expression=e.expression,this.nodes=e.nodes,this.nextSibling=e.nextSibling,this.parent=n,this.components=null}return n.prototype=e,n}customTag_register=function(n,r){null!=r&&"object"==typeof r&&(r.__Ctor=t(r)),e[n]=r},customTag_registerResolver=function(t){var o=e[t];return null!=o?void(o!==r&&(n[t]=o)):void(e[t]=r)};var r;!function(){r=function(e,t,r,o,i){for(var s,l=e.tagName;null!=i;){if(is_Function(i.getHandler)&&(s=i.getHandler(l),null!=s))return s;i=i.parent}return s=n[l],null!=s?s:(log_error("Component not found:",l),null)}}()}(custom_Tags,custom_Tags_global),function(e){function n(e){if("parsed"===e.arguments)return r(e.process);var n=fn_proxy(e.process||t,e);return n.util=e,n}function t(e,n,t,r,o,i,s){return"node"===s?(this.nodeRenderStart(e,n,t,r,o),this.node(e,n,t,r,o)):(this.attrRenderStart(e,n,t,r,o,i),this.attr(e,n,t,r,o,i))}function r(e){return function(n,t,r,o,i){var s=ExpressionUtil.evalStatements(n,t,r,i);return e.apply(null,s)}}customUtil_$utils={},customUtil_register=function(t,r){return is_Function(r)?void(e[t]=r):(e[t]=n(r),void("parsed"===r.arguments&&(customUtil_$utils[t]=r.process)))},customUtil_get=function(n){return null!=n?e[n]:e}}(custom_Utils)}();var ExpressionUtil=function(){function e(e,n){null==n&&(n=!1),t=e,o=0,i=e.length,r=new en;var s,k,K=r,Y=Q;e:for(;;)if(i>o&&(s=t.charCodeAt(o))<33)o++;else{if(o>=i)break;if(k=bn(s),null==k&&i>o)break;if(k===M){if(n===!0)return[r,o];break}if(n===!0){var q=K.parent;if(null!=q&&q.type===I&&null==q.parent&&k===P)return[r,o]}if(k===M)break;switch(k){case C:K=dn(K,new nn(K)),K=dn(K,new en(K)),o++;continue;case A:var Z=I;Y===J&&(Y=Q,Z=B);do K=K.parent;while(null!=K&&K.type!==Z);if(Z===I&&(K=K.parent),null==K){mn("OutOfAst Exception",s);break e}o++;continue;case j:K=dn(K,new on(K)),k=R,o++;break;case O:for(;null!=K&&K.type!==G;)K=K.parent;o++;continue;case S:if(Y!==J){Y=Q;do K=K.parent;while(null!=K&&K.type!==I&&K.type!==G);if(o++,null==K){mn("Unexpected comma",s);break e}if(K.type===G){k=R;break}continue}do K=K.parent;while(null!=K&&K.type!==B);if(null==K){mn("OutOfAst Exception",s);break e}K=K.newArgument(),o++;continue;case D:r=new fn(r),K=r.case1,o++;continue;case L:K=r.case2,o++;continue;case T:s=t.charCodeAt(o+1),s>=48&&57>=s?k=$:(k=K.type===I?P:F,o++);break;case N:if(K.type===z||K.type===V||K.type===W){K=dn(K,new an(K)),K=K.getBody(),o++;continue}K=dn(K,new rn(K)),K=K.body,o++;continue;case E:do K=K.parent;while(null!=K&&K.type!==V&&K.type!==X);o++;continue}if(K.type===I&&(K=dn(K,new nn(K))),l!==k&&h!==k||null!=K.body)switch(k){case l:case u:case c:case a:case f:case d:case p:case m:case v:case g:case _:case y:case b:case x:case w:for(;K&&K.type!==H;)K=K.parent;if(null==K.body)return mn("Unexpected operator",s);K.join=k;do K=K.parent;while(null!=K&&K.type!==I);if(null==K)return mn("Unexpected operator",s);o++;continue;case U:case $:if(null!=K.body&&null==K.join)return mn("Directive expected",s);U===k&&(o++,dn(K,new tn(gn(s))),o++),$===k&&dn(K,new tn(_n(s)));continue;case P:case F:var hn=yn();if(k===P&&("null"===hn&&(hn=null),"false"===hn&&(hn=!1),"true"===hn&&(hn=!0),"string"!=typeof hn)){dn(K,new tn(hn));continue}for(;i>o;){s=t.charCodeAt(o);{if(!(33>s))break;o++}}if(40===s){Y=J,o++;var xn=dn(K,new sn(K,hn));K=xn.newArgument();continue}var wn=k===P?ln:un;K=dn(K,new wn(K,hn));break;case R:if(125===vn())continue;var kn=yn();if(58!==vn())return mn("Object parser. Semicolon expeted",s);o++,K=K.nextProp(kn),k=P;continue}else K=dn(K,new cn(K,k)),o++}return null==K.body&&K.type===H?mn("Unexpected end of expression",s):(pn(r),r)}function n(t,r,o,i){var k,C;if(null==t)return null;if("."===t)return r;if(C="string"==typeof t?s.hasOwnProperty(t)===!0?s[t]:s[t]=e(t):t,null==C)return null;var A,N,E,j=C.type;if(I===j){var O,S;e:for(A=0,E=C.body.length;E>A;A++)if(N=C.body[A],O=n(N,r,o,i),null!=S&&null!=S.join){if(S.join===d)if(k)k=O;else for(;E>A&&C.body[A].join!==p;A++);if(S.join===p){if(k)break e;if(O){k=O;break e}}switch(S.join){case l:k-=O;break;case u:k+=O;break;case a:k/=O;break;case c:k*=O;break;case f:k%=O;break;case g:k=k!=O;break;case _:k=k!==O;break;case m:k=k==O;break;case v:k=k===O;break;case y:k=k>O;break;case b:k=k>=O;break;case x:k=O>k;break;case w:k=O>=k}S=N}else S=N,k=O}if(H===j)return k=n(C.body,r,o,i),null==C.next?k:hn(C.next,k);if(K===j)return C.body;if(X===j){var T=C.body.body,D=T.length,A=-1;for(k=new Array(D);++A<D;)k[A]=n(T[A],r,o,i);return k}if(G===j){k={};var L=C.props;for(var M in L)k[M]=n(L[M],r,o,i);return k}if(z===j||B===j||V===j||W===j)return hn(C,r,o,i);if(Y===j)switch(k=n(C.body,r,o,i),C.prefix){case l:k=-k;break;case h:k=!k}return q===j&&(k=n(C.body,r,o,i),k=n(k?C.case1:C.case2,r,o,i)),k}var t,r,o=0,i=0,s={},l="-",u="+",a="/",c="*",f="%",p="||",d="&&",h="!",m="==",v="===",g="!=",_="!==",y=">",b=">=",x="<",w="<=",k=".",C=20,A=21,N=22,E=23,j=24,O=25,S=26,T=27,D=28,L=29,M=30,P=31,F=32,U=33,$=34,R=35,I=1,H=2,z=3,B=4,W=5,V=6,K=7,G=10,X=11,Y=12,q=13,Q=1,J=2,Z={};Z[k]=1,Z[a]=2,Z[c]=2,Z[l]=3,Z[u]=3,Z[y]=4,Z[b]=4,Z[x]=4,Z[w]=4,Z[m]=5,Z[v]=5,Z[g]=5,Z[_]=5,Z[d]=6,Z[p]=6;var en,nn,tn,rn,on,sn,ln,un,an,cn,fn;!function(){en=function(e){this.parent=e,this.type=I,this.body=[],this.join=null},nn=function(e){this.parent=e},nn.prototype={constructor:nn,type:H,join:null,body:null},tn=function(e){this.type=K,this.body=e,this.join=null},rn=function(e){this.type=X,this.parent=e,this.body=new en(this)},on=function(e){this.type=G,this.parent=e,this.props={}},on.prototype={nextProp:function(e){var n=new nn(this);return this.props[e]=n,n}},sn=function(e,n){this.parent=e,this.type=B,this.body=n,this.arguments=[],this.next=null},sn.prototype={constructor:sn,newArgument:function(){var e=new en(this);return this.arguments.push(e),e}},ln=function(e,n){this.type=z,this.parent=e,this.body=n,this.next=null},un=function(e,n){this.type=W,this.parent=e,this.body=n,this.next=null},an=function(e){this.parent=e,this.body=new nn(this),this.body.body=new en(this.body),this.next=null},an.prototype={type:V,getBody:function(){return this.body.body}},cn=function(e,n){this.parent=e,this.prefix=n},cn.prototype={constructor:cn,type:Y,body:null},fn=function(e){this.body=e,this.case1=new en(this),this.case2=new en(this)},fn.prototype={constructor:fn,type:q,case1:null,case2:null}}();var pn,dn;!function(){function e(e){if(0===e.length)return null;var n=new en(e[0].parent);return n.join=e[e.length-1].join,n.body=e,n}dn=function(e,n){switch(e.type){case I:return e.body.push(n),n;case H:if(n.type===W||n.type===V)return e.next=n;case Y:return e.body=n;case z:case B:case W:case V:return e.next=n}return mn("Invalid expression")},pn=function(n){if(n.type!==I)return void(null!=n.body&&"object"==typeof n.body&&pn(n.body));for(var t,r,o,i=n.body,s=0,l=i.length;l>s;s++)pn(i[s]);for(s=1;l>s&&(t=i[s],r=i[s-1],!(Z[r.join]>Z[t.join]));s++);if(s!==l){for(o=[i[0]],s=1;l>s;s++){t=i[s],r=i[s-1];var u=Z[r.join];if(u>Z[t.join]&&l-1>s){for(var a,c,f=s;++s<l&&(a=i[s].join,null!=a)&&!(u<=Z[a]););c=i.slice(f,s+1),t=e(c),pn(t)}o.push(t)}n.body=o}}}();var hn,mn;!function(){mn=function(e,n){return parser_error(e,t,o,n,"expr")},hn=function(e,t,r,o){var i,s,l,u,a,c=e,f=e.body;if("$c"===f){s=o;var p=c.next,d=null!=p&&p.body;if(null!=d&&null==s[d]){if(p.type===B&&"function"==typeof Compo.prototype[d])i=o,s=Compo.prototype[d],c=p;else for(;;){if(s=s.parent,null==s)break;if(null!=s[d]){i=s,s=s[d],c=p;break}}null==s&&(f="$c."+d,c=p)}}else if("$a"===f)s=o&&o.attr;else if("$u"===f)s=customUtil_$utils;else if("$ctx"===f)s=r;else if(null!=t&&(i=t,s=t[f]),null==s)for(;null!=o&&(i=o.scope,null!=i&&(s=i[f]),null==s);)o=o.parent;if(null==s)return(null==c||null!=c.next)&&log_warn("<mask:expression> Accessor error:",f),null;for(;;){if(c.type===B){for(l=[],u=-1,a=c.arguments.length;++u<a;)l[u]=n(c.arguments[u],t,r,o);s=s.apply(i,l)}if(null==s||null==c.next)break;if(c=c.next,f=c.type===V?n(c.body,t,r,o):c.body,i=s,s=s[f],null==s)break}return s}}();var vn,gn,_n,yn,bn;!function(){vn=function(){for(var e;i>o;){if(e=t.charCodeAt(o),e>32)return e;o++}return null},gn=function(e){for(var n,r,i=!1,s=39===e?"'":'"',l=o;(n=t.indexOf(s,o))>-1&&(o=n,92===t.charCodeAt(n-1));)i=!0,o++;return r=t.substring(l,o),i===!0&&(r=r.replace(__rgxEscapedChar[s],s)),r},_n=function(){for(var e,n,r=o;;){if(e=t.charCodeAt(o),46===e){if(n===!0)return mn("Invalid number",e),null;n=!0}if(!((e>=48&&57>=e||46===e)&&i>o))break;o++}return+t.substring(r,o)},yn=function(){var e,n=o,r=t.charCodeAt(o);if(34===r||39===r)return o++,e=gn(r),o++,e;for(;;){if(o===i)break;if(r=t.charCodeAt(o),36!==r&&95!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;o++}else o++}return t.substring(n,o)},bn=function(e){if(null==e&&o===i)return null;switch(e){case 40:return C;case 41:return A;case 123:return j;case 125:return O;case 91:return N;case 93:return E;case 44:return S;case 46:return T;case 59:return M;case 43:return u;case 45:return l;case 42:return c;case 47:return a;case 37:return f;case 61:return t.charCodeAt(++o)!==e?(mn("Assignment violation: View can only access model/controllers","="),null):t.charCodeAt(o+1)===e?(o++,v):m;case 33:return 61===t.charCodeAt(o+1)?(o++,61===t.charCodeAt(o+1)?(o++,_):g):h;case 62:return 61===t.charCodeAt(o+1)?(o++,b):y;case 60:return 61===t.charCodeAt(o+1)?(o++,w):x;case 38:return t.charCodeAt(++o)!==e?(mn("Not supported: Bitwise AND",e),null):d;case 124:return t.charCodeAt(++o)!==e?(mn("Not supported: Bitwise OR",e),null):p;case 63:return D;case 58:return L}return e>=65&&90>=e||e>=97&&122>=e||95===e||36===e?P:e>=48&&57>=e?$:34===e||39===e?U:(mn("Unexpected or unsupported directive",e),null)}}();var xn;return function(){function t(e,s,l,u){if(null==e)return null;var a,c,f=e.type;if(I===f)for(var p=e.body,d=p.length,h=-1;++h<d;)c=t(p[h],s,l,u),a=o(a,c);if(z===f||W===f||V===f){for(var m,v=e.body,g=e.next;null!=g;){if(m=g.type,B===m)return t(g,s,l,u);if(z!==m&&W!==m&&V!==m)return log_error("Ast Exception: next should be a symbol/function ref"),null;var _=m===V?n(g.body,s,l,u):g.body;if("string"!=typeof _)return log_warn("Can`t extract accessor name",v),null;v+="."+_,g=g.next}return v}switch(f){case H:case Y:case q:c=t(e.body,s,l,u),a=o(a,c)}if(q===f&&(c=t(r.case1,s,l,u),a=o(a,c),c=t(r.case2,s,l,u),a=o(a,c)),B===f){for(var y=e.arguments,d=y.length,h=-1;++h<d;)c=t(y[h],s,l,u),a=o(a,c);c=null;var b=e;e:for(;b=b.parent;)switch(b.type){case z:case W:case V:c=b.body+(null==c?"":"."+c);break;case I:case H:break e;default:c=null;break e}null!=c&&(a=o(a,c)),e.next&&(c=t(e.next,s,l,u),a=o(a,{accessor:i(e),ref:c}))}return a}function o(e,n){if(null==e)return n;if(null==n)return e;if(("object"!=typeof e||null==e.length)&&(e=[e]),"object"!=typeof n||null==n.length)return-1===e.indexOf(n)&&e.push(n),e;for(var t=0,r=n.length;r>t;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}function i(e){var n=e;e:for(;n.parent;){switch(n.parent.type){case I:case H:break e}n=n.parent}return s(n,e.next)}function s(e,n){if(e===n||null==e)return null;if("object"!=typeof e)return e;if(null!=e.length&&"function"==typeof e.splice){for(var t=[],r=0,o=e.length;o>r;r++)t[r]=s(e[r],n);return t}var i={};for(var l in e)null!=e[l]&&"parent"!==l&&(i[l]=s(e[l],n));return i}xn=function(n,r,o,i){return"string"==typeof n&&(n=e(n)),t(n,r,o,i)}}(),{parse:e,eval:n,varRefs:xn,evalStatements:function(t,r,o,i){for(var s=e(t).body,l=[],u=s.length,a=-1,c=new en;++a<u;)c.body.push(s[a]),null==s[a].join&&(l.push(n(c,r,o,i)),c.body.length=0);return l}}}(),Dom;!function(){function e(e){var n=this.nodes;if(null==n)return void(this.nodes=[e]);n.push(e);var t=n[n.length-2];t.nextSibling=e}function n(e,n){this.type=Dom.NODE,this.tagName=e,this.parent=n,this.attr={}}function t(e,n){this.content=e,this.parent=n}function r(e,n,t){this.tagName=e,this.parent=n,this.controller=t,this.attr={}}function o(){}var i=1,s=2,l=3,u=4,a=9,c=10,f=15;n.prototype={constructor:n,type:i,tagName:null,parent:null,attr:null,nodes:null,expression:null,appendChild:e,stringify:null,__single:null},t.prototype={type:s,content:null,parent:null},r.prototype={constructor:r,type:u,parent:null,attr:null,controller:null,nodes:null,components:null,model:null,modelRef:null},o.prototype={constructor:o,type:l,nodes:null,appendChild:e},Dom={NODE:i,TEXTNODE:s,FRAGMENT:l,COMPONENT:u,CONTROLLER:a,SET:c,STATEMENT:f,Node:n,TextNode:t,Fragment:o,Component:r}}(),function(){function e(e,n,t,r){function o(e){return ExpressionUtil.eval(e,n,t,r)}if(o(e.expression))return e.nodes;for(;;){if(e=e.nextSibling,null==e||"else"!==e.tagName)break;var i=e.expression;if(null==i||""===i||o(i))return e.nodes}return null}custom_Statements["if"]={getNodes:e,render:function(n,t,r,o,i,s){var l=e(n,t,r,i);null!=l&&builder_build(l,t,r,o,i,s)}}}(),function(){function e(e,t,r,o,i,s,l,u){builder_build(n(r,e,t[0],t[1],t[2],t[3]),o,i,s,l,u)}function n(e,n,o,i,s,l){return"of"===s?is_Array(n)===!1?(log_error("<ForStatement> Value is not enumerable",n),null):t(e,n,o,i,l):"in"===s?"object"!=typeof n?(log_warn("<ForStatement> Value is not an object",n),null):(is_Array(n)&&log_warn("<ForStatement> Consider to use `for..of` for Arrays"),r(e,n,o,i,l)):void 0}function t(e,n,t,r,i){for(var s,l=-1,u=n.length,a=new Array(u);++l<u;)s={},s[t]=n[l],r&&(s[r]=l),a[l]=o(d,e,s,l,t,i);return a}function r(e,n,t,r,i){var s,l,u,a=[],c=0;for(l in n)u=n[l],s={},s[t]=l,r&&(s[r]=u),a[c++]=o(h,e,s,l,r,i);return a}function o(e,n,t,r,o,s){return{type:Dom.COMPONENT,tagName:e,nodes:n,controller:i(e,t,r,o,s)}}function i(e,n,t,r,o){return{meta:{serializeScope:!0},compoName:e,scope:n,elements:null,propVal:r,key:t,expression:o,renderEnd:s,dispose:l,serializeScope:u}}function s(e){this.elements=e}function l(){this.elements&&(this.elements.length=0)}function u(e){var n=this,t=n.expression,r=n.key,o=n.propVal,i=e[o];return null!=i&&"object"==typeof i&&(e[o]="$ref:("+t+')."'+r+'"'),e}function a(e){m=e,g=e.length,v=0;var n,t,r,o,i;if(i=c(),40===i&&(o=!0,v++,c()),n=f(),i=c(),44===i){if(o!==!0)return p("Parenthese must be used in multiple var declarion");v++,c(),t=f()}if(o){if(i=c(),41!==i)return p("Closing parenthese expected");v++}i=c();var r;return 105===i&&110===m.charCodeAt(++v)&&(r="in"),111===i&&102===m.charCodeAt(++v)&&(r="of"),null==r?p("Invalid FOR statement. (in|of) expected"):(_[0]=n,_[1]=t,_[2]=r,_[3]=m.substring(++v),_)}function c(){for(var e;g>v;v++)if(e=m.charCodeAt(v),!(33>e))return e;return-1}function f(){for(var e,n=v;g>v;v++)if(e=m.charCodeAt(v),e>48&&57>e){if(n===v)return p("Variable name begins with a digit")}else if(!(36===e||95===e||e>=97&&122>=e||e>=65&&90>=e))break;return n===v?p("Variable declaration expected"):m.substring(n,v)}function p(e){throw new Error("<ForStatement parser> "+e+" `"+m.substring(v,20)+"`")}var d="for..of::item",h="for..in::item";custom_Statements["for"]={render:function(n,t,r,o,i,s){a(n.expression);var l=ExpressionUtil.eval(_[3],t,r,i);null!=l&&e(l,_,n.nodes,t,r,o,i,s)},build:e,parseFor:a,createForNode:o,getNodes:n,getHandler:function(e,n){return i(e,n)}},function(){function e(e){function n(){}return n.prototype={meta:{serializeScope:!0},serializeScope:u,type:Dom.COMPONENT,compoName:e,renderEnd:s,dispose:l},n}custom_Tags[d]=e(d),custom_Tags[h]=e(h)}();var m,v,g,_=["prop1","prop2","in|of","expression"]}(),function(){function e(e,t){for(var r=t.length,o=new Array(r),i=e.nodes,s=e.expression,l="."===s?'."':"("+e.expression+')."',u=0;r>u;u++)o[u]=n(i,t[u],l,u);return o}function n(e,n,r,o){return{type:Dom.COMPONENT,tagName:"each::item",nodes:e,controller:t(n,o,r)}}function t(e,n,t){return{compoName:"each::item",model:e,scope:{index:n},modelRef:t+n+'"',attr:null,meta:null}}custom_Statements.each={render:function(n,t,r,o,i,s){var l=ExpressionUtil.eval(n.expression,t,r,i);null!=l&&builder_build(e(n,l),l,r,o,i,s)}}}(),custom_Statements["with"]={render:function(e,n,t,r,o,i){var s=ExpressionUtil.eval(e.expression,n,t,o);builder_build(e.nodes,s,t,r,o,i)}},function(){function e(e,t,r,o,i){if(null==t)return null;for(var s,l,u,a,c=t.length,f=-1;++f<c;)if(s=t[f],"default"!==s.tagName)if("case"===s.tagName)if(l=s.expression){if(n(l,r,o,i)==e){u=s;break}}else log_warn("<mask:switch:case> Expression expected");else log_warn("<mask:switch> Case expected",s.tagName);else a=s;return null==u&&(u=a),null!=u?u.nodes:null}var n=ExpressionUtil.eval;custom_Statements["switch"]={render:function(t,r,o,i,s,l){var u=n(t.expression,r,o,s),a=e(u,t.nodes,r,o,s);null!=a&&builder_build(a,r,o,i,s,l)},getNodes:e}}(),function(){function e(e){this.parent=e,this.compoName="include",this.components=[],this.templates=null}custom_Statements.include={render:function(n,t,r,o,i,s){for(var l,u=ExpressionUtil.evalStatements(n.expression);null!=i&&(l=i.resource,null==l);)i=i.parent;
var i=new e(i),a=Compo.pause(i,r);include.instance(l&&l.url).load.apply(l,u).done(function(e){i.templates=e.load,builder_build(n.nodes,t,r,o,i,s),a()})}}}(),custom_Statements["import"]={render:function(e,n,t,r,o,i){var s=e.expression,l=ExpressionUtil.evalStatements(s,n,t,o),u=l[0];if("string"!=typeof u)return void log_error("<mask:import> Invalid argument",s);for(;;){if("include"===o.compoName)break;if(o=o.parent,null==o)break}if(null!=o){var a=o.templates[u];null!=a&&builder_build(parser_parse(a),n,t,r,o,i)}}},custom_Tags["var"]=VarStatement,VarStatement.prototype={renderStart:function(e,n){var t,r,o=this.parent,i=o.scope;null==i&&(i=o.scope={}),this.model={};for(t in this.attr)r=ExpressionUtil.eval(this.attr[t],e,n,o),this.model[t]=i[t]=r;this.attr={}},onRenderStartClient:function(){var e=this.parent,n=e.scope;null==n&&(n=e.scope={});for(var t in this.model)n[t]=this.model[t]}},function(){function e(e,n){for(var t=0;t<e.length;t++)e[t].style.display=n?"":"none"}custom_Statements.visible={toggle:e,render:function(n,t,r,o,i,s){var l=[];builder_build(n.nodes,t,r,o,i,l),arr_pushMany(s,l);var u=ExpressionUtil.eval(n.expression,t,r,i);e(l,u)}}}();var parser_parse,parser_parseAttr,parser_ensureTemplateFunction,parser_setInterpolationQuotes,parser_cleanObject,parser_ObjectLexer,Parser;!function(e,n,t){function r(e){for(var n=-1;-1!==(n=e.indexOf(c,n))&&e.charCodeAt(n+1)!==h;)n++;if(-1===n)return e;for(var t,r=e.length,i=[],s=0,l=0;;){if(t=o(e,n+2,r,h,m),-1===t)break;for(i[l++]=s===n?"":e.substring(s,n),i[l++]=e.substring(n+2,t),s=n=t+1;-1!==(n=e.indexOf(c,n))&&e.charCodeAt(n+1)!==h;)n++;if(-1===n)break}return r>s&&(i[l]=e.substring(s)),e=null,function(e,n,t,r,o,s){if(null==e){for(var l,u="",a=i.length,d=-1;++d<a;)l=i[d],u+=d%2===1?c+f+l+p:l;return u}return util_interpolate(i,e,n,t,r,o,s)}}var o,i,s,l,u,a,c="~",f="[",p="]",d=126,h=91,m=93;!function(){o=function(e,n,t,r,o){for(var s,l=0,u=n;t>n;n++)if(s=e.charCodeAt(n),34!==s&&39!==s)if(s!==r){if(s===o&&-1===--l)return n}else l++;else n=i(e,n+1,t,34===s?'"':"'");return parser_warn("Group was not closed",e,u),t},s=function(e,n,t){for(var r;t>n;)if(r=e.charCodeAt(n),36!==r&&95!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;n++}else n++;return n},l=function(e,n,t){for(var r;t>n;)if(r=e.charCodeAt(n),36!==r&&95!==r&&58!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;n++}else n++;return n},i=function(e,n,t,r){for(var o=n;-1!==(n=e.indexOf(r,n));){if(92!==e.charCodeAt(n-1))return n;n++}return parser_warn("Quote was not closed",e,o-1),t},u=function(e,n,t){for(;t>n;n++)if(e.charCodeAt(n)>32)return n;return n},a=function(e,n,t){for(;t>n;n++)if(e.charCodeAt(n)<33)return n;return n}}();var v;!function(){function e(e){var r=n(e);return function(e,n,o,i,s){return t(r,e,n,o,i,s)}}var n;!function(){function e(e,t,r,i,s,l){var u=++i;i=o(r,i,s,91,93);var a=n(r,u,i);i++,40!==r.charCodeAt(i)&&_("Punctuation group expected"),u=++i,i=o(r,i,s,40,41);var c=r.substring(u,i);return t.push(new f(e,a,new p(c),l)),i}function t(e,n,t,r,i){var s=++r;return r=o(t,r,i,40,41),n.push(new d(e,t.substring(s,r))),r}function u(e,n,t,r,o){var i=++r;return r=l(t,r,o),n.push(new h(e,t.substring(i,r))),r}function v(e,t,r,i,s){var l=++i;return i=o(r,l,s,40,41),t.push(new m(n(r,l,i),e)),i}function _(e){throw Error("Lexer pattern: "+e)}n=function(o,f,d){void 0===f&&(f=0,d=o.length);var h,y,b,x=[];e:for(;d>f;f++){switch(b=f,h=o.charCodeAt(f),y=!1,63===h&&(y=!0,b=++f,h=o.charCodeAt(f)),h){case 32:x.push(new c(y,f));continue;case 34:case 39:f=i(o,f+1,d,34===h?'"':"'"),x.push(new a(n(o,b+1,f)));continue;case 36:b=++f;var w=!1;h===o.charCodeAt(f)&&(w=!0,b=++f),f=l(o,f,d);var k=o.substring(b,f);if(y===!1&&w===!1){x.push(new s(k)),f--;continue}if(h=o.charCodeAt(f),91===h){f=e(k,x,o,f,d,y);continue}if(40===h){f=t(k,x,o,f,d);continue}if(60===h){f=u(k,x,o,f,d);continue}_("Unexpected extended type");continue;case 40:if(y===!0){f=v(y,x,o,f,d);continue}case 44:case 41:case 91:case 93:case 123:case 125:x.push(new p(String.fromCharCode(h)));continue}for(;d>f;)if(h=o.charCodeAt(++f),!(h>32&&34!==h&&39!==h&&36!==h&&44!==h)){x.push(new r(o.substring(b,f))),--f;continue e}}for(var C,A=x.length,N=-1,E=A>1;E===!0&&++N<A;)C=x[N],(C instanceof m==!1||C.optional!==!0)&&(E=!1);return E===!0&&(x=[new g(x)]),x}}();var t;!function(){t=function(e,n,t,r,o,i){for(var s,l,u=t,a=e.length,c=0;a>c;c++)if(s=e[c],l=t,t=s.consume(n,t,r,o),t===l){if(s.optional===!1){if(i!==!0){var f="Token of type `"+s.name+"`";s.token&&(f+=" Did you mean: `"+s.token+"`?"),parser_error(f,n,t)}return u}return t}return t}}();var r,s,a,c,f,p,d,h,m,g;!function(){function e(e){return new Function("obj","val","obj."+e+"= val;")}function n(e,n){var t=n.constructor;return n.name=e,n.optional=!1,n.token=null,t.prototype=n,t}c=n("Whitespace",{constructor:function(e){this.optional=e},consume:u}),r=n("Const",{constructor:function(e){this.token=e},consume:function(e,n){var t=n+this.token.length;return e=e.substring(n,t),e===this.token?t:n}}),s=n("Var",{constructor:function(n){this.token=n,this.setter=e(n)},consume:function(e,n,t,r){var o=l(e,n,t);return o===n?n:(this.setter(r,e.substring(n,o)),o)}}),d=n("ExtendedVar",{constructor:function(n,t){return this.token=t,this.setter=e(n),"*"===t?void(this.consume=this.consumeAll):void(this.rgx=new RegExp(t,"g"))},consumeAll:function(e,n,t,r){return this.setter(r,e.substring(n)),t},consume:function(e,n,t,r){this.rgx.lastIndex=n;var o=this.rgx.exec(e);if(null==o)return n;var i=o[0];return this.setter(r,i),n+i.length}}),function(){h=n("CustomVar",{constructor:function(n,r){this.fn=t[r],this.token=n,this.setter=e(n)},consume:function(e,n,t,r){for(var o,i=n;t>n&&(o=e.charCodeAt(n),36===o||95===o||58===o||(o>=48&&57>=o||o>=65&&90>=o||o>=97&&122>=o)||this.fn(o)===!0);n++);return n===i?n:(this.setter(r,e.substring(i,n)),n)}});var t={accessor:function(e){return 46===e?!0:!1}}}(),a=n("String",{constructor:function(e){this.tokens=e},consume:function(e,n,t,r){var o=e.charCodeAt(n);if(34!==o&&39!==o)return n;var s=i(e,n+1,t,34===o?'"':"'");if(1!==this.tokens.length)throw Error("Not implemented");var l=this.tokens[0];return r[l.token]=e.substring(n+1,s),++s}}),f=n("Array",{constructor:function(e,n,t,r){this.token=e,this.delim=t,this.tokens=n,this.optional=r},consume:function(e,n,r,o){for(var i,s,l;;){if(i={},s=t(this.tokens,e,n,r,i,this.optional),n===s){if(null==l)return n;throw Error("Next item expected")}if(null==l&&(l=[]),l.push(i),n=s,s=this.delim.consume(e,n,r),n===s)break;n=s}return o[this.token]=l,n}}),p=n("Punc",{constructor:function(e){this.before=new c(!0),this.delim=new r(e),this.after=new c(!0),this.token=e},consume:function(e,n,t){var r=this.before.consume(e,n,t),o=this.delim.consume(e,r,t);return r===o?n:this.after.consume(e,o,t)}}),m=n("Group",{constructor:function(e,n){this.optional=n,this.tokens=e},consume:function(e,n,r,o){return t(this.tokens,e,n,r,o,this.optional)}}),g=n("OrGroup",{constructor:function(e){this.groups=e,this.length=e.length},consume:function(e,n,t,r){for(var o=n,i=0;i<this.length;i++)if(n=this.groups[i].consume(e,n,t,r),n!==o)return n;return n}})}(),v=function(n){return 1===arguments.length&&"string"==typeof n?e(n):_(Array.prototype.slice.call(arguments))};var _;!function(){function n(e,n,r,o,i,s){return"function"==typeof e?e(n,r,o,i,s):t(e,n,r,o,i,s)}function t(e,n,t,r,o,i){for(var s=t,l=e.length,u=-1;++u<l;)if(t=e[u](n,t,r,o,!0),s!==t)return t;return i!==!0&&e[0](n,s,r,o,i),s}function r(n){if("string"==typeof n)return e(n);for(var t=n.length;--t>-1;)n[t]=e(n[t]);return n}_=function(e){for(var t=e.length,o=-1;++o<t;)e[o]=r(e[o]);return function(r,i,s,l,u){var a;for(o=-1;++o<t;)if(a=i,i=n(e[o],r,i,s,l,u),i===a)return a;return i}}}()}(),function(){function n(){var e=this.attr,n="var ";for(var t in e)"var "!==n&&(n+=","),n+=t+"="+e[t];return n+";"}custom_Parsers["var"]=function(t,r,l,u){var a,c,f=new e("var",u);f.stringify=n;for(var p,d=1,h=2,m=3,v=4,g=d;;)if(l>r&&(c=t.charCodeAt(r))<33)r++;else if(g!==d)if(g!==h)if(g!==m){if(g===v){if(44===c){g=d,r++;continue}break}}else{switch(a=r,r++,c){case 123:case 91:r=o(t,r,l,c,c+2);break;case 39:case 34:r=i(t,r,l,39===c?"'":'"');break;default:for(;l>r&&(c=t.charCodeAt(r),44!==c&&59!==c);)r++;r--}r++,f.attr[p]=t.substring(a,r),g=v}else{if(61!==c)return parser_error("Assignment expected",t,r,c,"var"),[f,r];g=m,r++}else a=r,r=s(t,r,l),p=t.substring(a,r),g=h;return[f,r,0]}}(),function(){function e(e,r,o){null!=e.scoped&&(r=n(r,o)),r=t(r,o),this.content=parser_ensureTemplateFunction(r),this.parent=o,this.attr=e}custom_Parsers.style=function(n,t,r,i){var s=n.indexOf("{",t)+1,l=parser_parseAttr(n,t,s-1),u=o(n,s,r,123,125),a=n.substring(s,u);if(null!=l.self){var c=i.attr.style;return i.attr.style=parser_ensureTemplateFunction((c||"")+a),[null,u+1]}return[new e(l,a,i),u+1,0]},e.prototype={tagName:"style",type:Dom.COMPONENT,controller:null,elements:null,model:null,stringify:function(){return"style {"+this.getStyle()+"}"},render:function(e,n,t,r){var o=document.createElement("style");o.textContent=this.getStyle(e,n,o,r);var i,s;for(i in this.attr)s=this.attr[i],null!=s&&o.setAttribute(i,s);t.appendChild(o)},getStyle:function(e,n,t,r){return is_Function(this.content)?0===arguments.length?this.content():this.content("node",e,n,t,r):this.content}};var n,t;!function(){function e(e){if(null==e)return log_warn('"style" should be inside elements node'),"";var n=e.attr.id;return null==n&&(n=e.attr.id="scoped__css__"+ ++r),"#"+n}var r=0,o=/^([\s]*)([^\{\}]+)\{/gm,i=/^([\s]*):host\s*(\(([^)]+)\))?\s*\{/gm;n=function(n,t){var r;return n=n.replace(o,function(n,o,i){if(-1!==i.indexOf(":host"))return n;null==r&&(r=e(t));for(var s=i.split(","),l=s.length,u=0;l>u;u++)s[u]=r+" "+s[u];return i=s.join(","),o+i+"{"})},t=function(n,t){var r;return n=n.replace(i,function(n,o,i,s){return o+(r||(r=e(t)))+(s||"")+"{"})}}()}(),function(){custom_Parsers["import"]=function(t,r,o,i){var s={exports:null,alias:null,path:null},l=e(t,r,o,s);return[new n(i,s),l,0]},custom_Tags["import:base"]=function(e){var n=path_normalize(ExpressionUtil.eval(e.expression));null!=n&&"/"!==n[n.length-1]&&(n+="/"),Module.cfg("base",n)};var e=v(['from "$path"','* as $alias from "$path"','$$exports[$name?( as $alias)](,) from "$path"']),n=class_create({type:Dom.COMPONENT,tagName:"import",constructor:function(e,n){this.dependency=Module.createDependency(n),this.parent=e},controller:function(e,n,r,o,i){for(var s,l=e.parent.nodes,u=[],a=[],c=l.length,f=0;c>f;f++)s=l[f],l[f]=null,"import"!==s.tagName?u.push(s):a.push(s.dependency);return new t(a,u,i)}}),t=custom_Tags.imports=class_create({compoName:"imports",constructor:function(e,n,t){this.deps=e,this.parent=t,this.base=Module.resolveLocation(t),this.nodes=n},load:function(e){function n(){0===--r&&e()}for(var t=this.deps.length,r=t,o=t;--o>-1;)this.deps[o].load(this,n)},renderStart:function(e,n){var t=Compo.pause(this,n),r=this;this.load(function(){for(var e=r.nodes||[],n=r.deps,o=n.length,i=-1;++i<o;){var s=n[i].getEmbeddableNodes();null!=s&&(is_Array(s)===!1&&(s=[s]),e=s.concat(e))}r.nodes=e,t()})},getHandler:function(){}})}(),function(){custom_Parsers.define=function(t,r,o,i){var s=new n("define",i),l=e(t,r,o,s);return[s,l,g]};var e=v("$name",'?( extends $$extends[?("$path")?($$compo<accessor>)](,))',"{"),n=class_create(Dom.Node,{name:null,"extends":null,controller:function(e,n,r,o,i){var s=Define.create(e,n,i);return customTag_register(e.name,s),new t},stringify:function(e){var n=this["extends"],t="";if(n&&0!==n.length){t=" extends ";for(var r=n.length,o=-1;++o<r;)t+=n[o].compo,r-1>o&&(t+=", ")}return"define "+this.name+t+"{"+mask_stringify(this.nodes,++e)+"}"}}),t=class_create({render:fn_doNothing})}(),function(){function e(e){return function(t,r,i,s){var l=t.indexOf("{",r)+1,u=n(t.substring(r,l-1)),a=o(t,l,i,123,125),c=t.substring(l,a);return[new e(u,c,s),a+1,0]}}function n(e){var n=/(\w+)\s*\(([^\)]*)\)/.exec(e);if(null==n)return log_error("`slot` has invalid head syntax",e),null;var t=[n[1]];return t=t.concat(n[2].replace(/\s/g,"").split(","))}function t(e,n,t){this.name=e.shift(),this.args=e,this.body=n,this.parent=t,this.fn=this.compile()}t.prototype={type:Dom.COMPONENT,controller:null,elements:null,model:null,stringify:function(){return this.tagName+" "+this.name+"("+this.args.join(",")+") {"+this.body+"}"},compile:function(){var e=_Array_slice.call(this.args);return e.push(this.body),new(Function.bind.apply(Function,[null].concat(e)))},render:function(){}};var r=class_create(t,{tagName:"slot",render:function(e,n,t,r){var o=r.slots;null==o&&(o=r.slots={}),o[this.name]=this.fn}}),i=class_create(t,{tagName:"event",render:function(e,n,t,r){this.fn=this.fn.bind(r),Compo.Dom.addEventListener(t,this.name,this.fn)}}),s=class_create(t,{tagName:"function",render:function(e,n,t,r){r[this.name]=this.fn}}),l=class_create(t,{tagName:"script",render:function(e,n,t,r){if(null!=this.attr.src){var o=document.createElement("script");for(var i in this.attr)o.addAttribute(i,this.attr[i]);return void t.appendChild(o)}this.fn.call(r)}});custom_Parsers.slot=e(r),custom_Parsers.event=e(i),custom_Parsers.script=e(l),custom_Parsers["function"]=e(s)}();var g=2,_=3,y=5,b=6,x=7,w=8,k=9;Parser={parse:function(i){for(var s,l,u,a,c,f,p,v,C=new t,A=C,N=g,E=_,j=0,O=i.length;;){for(;O>j&&(f=i.charCodeAt(j))<33;)j++;if(47===f){if(v=i.charCodeAt(j+1),47===v){for(j++;10!==f&&13!==f&&O>j;)f=i.charCodeAt(++j);continue}if(42===v){j=i.indexOf("*/",j+2)+2,1===j&&(j=O);continue}}if(E===y&&(null!=s&&(C.attr["class"]=r(s),s=null),null!=u&&(C.attr[u]=u,u=null,l=null)),null!=l){if(N===y)null==u?u=l:a=l,null!=u&&null!=a&&("class"!==u?C.attr[u]=a:s=null==s?a:s+" "+a,u=null,a=null);else if(E===_){if(null!=custom_Parsers[l]){var S=custom_Parsers[l](i,j,O,C),T=S[0],D=S[2];j=S[1],N=0===D?g:D,l=null,null!=T&&(C.appendChild(T),0!==D&&(C=T));continue}c=new e(l,C),C.appendChild(c),C=c,N=y}else if(E===w){if(c=new n(l,C),C.appendChild(c),C.__single===!0)do C=C.parent;while(null!=C&&null!=C.__single);N=g}l=null}if(j>=O){N===y&&(null!=s&&(C.attr["class"]=r(s)),null!=u&&(C.attr[u]=u)),f=null;break}if(N===k){for(C=C.parent;null!=C&&null!=C.__single;)C=C.parent;null==C&&(C=A,parser_warn("Unexpected tag closing",i,j-1)),N=g}switch(f){case 123:E=N,N=g,j++;continue;case 62:E=N,N=g,j++,C.__single=!0;continue;case 59:if(null!=C.nodes){j++;continue}case 125:125!==f||N!==_&&N!==y||j--,j++,E=N,N=k;continue;case 39:case 34:N===b?N=y:E=N=w,j++;var L=!1,M=!1,P=39===f?"'":'"';for(p=j;(j=i.indexOf(P,j))>-1&&92===i.charCodeAt(j-1);)L=!0,j++;-1===j&&(parser_warn("Literal has no ending",i,p-1),j=O),j===p&&(v=i.charCodeAt(j+1),(124===v||v===f)&&(M=!0,p=j+2,j=i.indexOf((124===v?"|":P)+P+P,p),-1===j&&(j=O))),l=i.substring(p,j),L===!0&&(l=l.replace(__rgxEscapedChar[P],P)),(N!==y||"class"!==u)&&(l=r(l)),j+=M?3:1;continue}if(N===g){if(E=_,N=_,46===f||35===f){l="div";continue}}else if(N===y)if(46===f)j++,u="class",N=x;else if(35===f)j++,u="id",N=x;else{if(61===f){j++,N=b,E===_&&null==u&&parser_warn("Unexpected tag assignment",i,j,f,N);continue}if(40===f){p=1+j,j=1+o(i,p,O,f,41),C.expression=i.substring(p,j-1),C.type=Dom.STATEMENT;continue}if(null!=u){l=u;continue}}(N===b||N===x)&&(E=N,N=y);var F=null;for(p=j;O>j;){if(f=i.charCodeAt(j),f===d&&i.charCodeAt(j+1)===h){F=!0,++j;do f=i.charCodeAt(++j);while(f!==m&&O>j)}if(E!==b&&(46===f||35===f))break;if(33>f||61===f||62===f||59===f||40===f||123===f||125===f)break;j++}if(l=i.substring(p,j),""===l){parser_warn("String expected",i,j,f,N);break}if(F===!0){if(N===_){parser_warn("Invalid interpolation (in tag name)",i,j,l,N);break}if(N===y)if("id"===u||E===b)l=r(l);else if("class"!==u){parser_warn("Invalid interpolation (in attr name)",i,j,l,N);break}}}f!==f&&parser_warn("IndexOverflow",i,j,f,N);var U=A.nodes;return null!=U&&1===U.length?U[0]:A},cleanObject:function(e){if(e instanceof Array){for(var n=0;n<e.length;n++)this.cleanObject(e[n]);return e}return delete e.parent,delete e.__single,null!=e.nodes&&this.cleanObject(e.nodes),e},setInterpolationQuotes:function(e,n){return e&&2===e.length?n&&1===n.length?(d=e.charCodeAt(0),h=e.charCodeAt(1),m=n.charCodeAt(0),c=e[0],f=e[1],void(p=n)):void log_error("Interpolation End must be of 1 Character"):void log_error("Interpolation Start must contain 2 Characters")},ensureTemplateFunction:r},parser_parse=Parser.parse,parser_ensureTemplateFunction=Parser.ensureTemplateFunction,parser_cleanObject=Parser.cleanObject,parser_setInterpolationQuotes=Parser.setInterpolationQuotes,parser_ObjectLexer=v,parser_parseAttr=function(e,n,t){for(var r,o,s={},l=n;t>l&&(l=u(e,l,t),l!==t);){for(n=l;t>l&&(o=e.charCodeAt(l),!(61===o||33>o));l++);if(r=e.substring(n,l),l=u(e,l,t),l===t){s[r]=r;break}61===e.charCodeAt(l)?(l=n=u(e,l+1,t),o=e.charCodeAt(l),34!==o&&39!==o?(l=a(e,l,t),s[r]=e.substring(n,l)):(l=i(e,l+1,t,39===o?"'":'"'),s[r]=e.substring(n+1,l),l++)):s[r]=r}return s}}(Dom.Node,Dom.TextNode,Dom.Fragment,Dom.Component);var mask_stringify;!function(){function e(e){for(var n="";e--;)n+=" ";return n}function n(n,r,o){var i,s;null==r&&(r=0),null==o&&(i=!0,o=[]);var l=o.length;if(n.type===Dom.FRAGMENT&&(n=n.nodes),n instanceof Array)for(s=0;s<n.length;s++)t(n[s],r,o);else t(n,r,o);var u=e(r);for(s=l;s<o.length;s++)o[s]=u+o[s];return i?o.join(0===a?"":"\n"):void 0}function t(e,t,c){if("function"==typeof e.stringify)return void c.push(e.stringify(a));if("string"==typeof e.content)return void c.push(l(e.content));if("function"==typeof e.content)return void c.push(l(e.content()));if(o(e))return void c.push(r(e)+";");if(i(e)){var f=u?">":" > ";return c.push(r(e)+f),void n(s(e),a,c)}c.push(r(e)+"{"),n(e.nodes,a,c),c.push("}")}function r(e){var n,t,r=e.tagName;null!=e.attr&&(n=e.attr.id||"",t=e.attr["class"]||""),"function"==typeof n&&(n=n()),"function"==typeof t&&(t=t()),n&&(n=-1!==n.indexOf(" ")?"":"#"+n),t&&(t="."+t.split(" ").join("."));var o="";for(var i in e.attr)if("id"!==i&&"class"!==i){var s=e.attr[i];"function"==typeof s&&(s=s()),i===s||u!==!1&&!/[^\w_$\-\.]/.test(s)||(s=l(s)),o+=" "+i,i!==s&&(o+="="+s)}"div"===r&&(n||t)&&(r="");var a="";return e.expression&&(a="("+e.expression+")"),r+n+t+o+a}function o(e){return null==e.nodes||e.nodes instanceof Array&&0===e.nodes.length}function i(e){return e.nodes&&(e.nodes instanceof Array==!1||1===e.nodes.length)}function s(e){return e.nodes instanceof Array?e.nodes[0]:e.nodes}function l(e){return-1===e.indexOf("'")?"'"+e.trim()+"'":-1===e.indexOf('"')?'"'+e.trim()+'"':'"'+e.replace(/"/g,'\\"').trim()+'"'}mask_stringify=function(e,t){return null==e?"":("string"==typeof e&&(e=mask.parse(e)),null==t?(a=0,u=!0):"number"==typeof t?(a=t,u=0===a):(a=t&&t.indent||4,u=0===a||t&&t.minimizeAttributes),n(e))};var u,a}();var builder_componentID=0,builder_build;!function(e,n,t){function r(e,n,t,r,i){var s=r.appendChild(document.createComment(""));return function(){return o(e,n,t,s,i)}}function o(n,t,r,o,i){null!=n.tagName&&n.tagName!==n.compoName&&(n.nodes={tagName:n.tagName,attr:n.attr,nodes:n.nodes,type:1}),null!=n.model&&(t=n.model);var s=n.nodes,l=[];if(null!=s){for(var u=s instanceof Array,a=u===!0?s.length:1,c=0,f=null,p=document.createDocumentFragment();a>c;c++)f=u===!0?s[c]:s,builder_build(f,t,r,p,n,l);o.parentNode.insertBefore(p,o)}if(null==n.tagName){var d,h,m=n.handlers&&n.handlers.attr;for(h in n.attr)d=null,m&&is_Function(m[h])&&(d=m[h]),null==d&&is_Function(e[h])&&(d=e[h]),null!=d&&d(o,n.attr[h],t,r,l[0],n)}if(is_Function(n.renderEnd)&&n.renderEnd(l,t,r,o.parentNode),null!=i&&i!==l)for(var v=i.length,g=l.length,_=-1;++_<g;)i[v+_]=l[_]}function i(e,n){var t=e.components;return null==t?void(e.components=[n]):void t.push(n)}var s,l=function(){var e=function(e){return function(n,t){n.appendChild(e.createTextNode(t))}}(document);return function(n,t,r,o,i){var s=n.content;if(is_Function(s)){var l=s("node",t,r,o,i);if("string"==typeof l)return void e(o,l);for(var u,a="",c=l.length,f=0;c>f;f++)if(u=l[f],"object"!=typeof u)a+=u;else{if(""!==a&&(e(o,a),a=""),null==u.nodeType){a+=u.toString();continue}o.appendChild(u)}return void(""!==a&&e(o,a))}e(o,s)}}();!function(){s=function(t,r,o,i,s,l){var u=t.tagName,a=t.attr,c=n(u);if(null!=c){null!=l&&(l.push(c),a["x-compo-id"]=s.ID),null!=i&&i.appendChild(c);var f,p;for(f in a)_Object_hasOwnProp.call(a,f)!==!1&&(is_Function(a[f])?(p=a[f]("attr",r,o,c,s,f),p instanceof Array&&(p=p.join(""))):p=a[f],p&&(is_Function(e[f])?e[f](t,p,r,o,c,s,i):c.setAttribute(f,p)));return c}};var n;!function(e){n=function(n){return e.createElement(n)}}(document)}();var u;!function(){function e(e,n,t,o,s,l,u){var a,c;e.ID=++builder_componentID,e.attr=a=attr_extend(e.attr,n.attr),e.parent=l,e.expression=n.expression,null==e.compoName&&(e.compoName=n.tagName),null==e.model&&(e.model=t),null==e.nodes&&(e.nodes=n.nodes);for(c in a)"function"==typeof a[c]&&(a[c]=a[c]("attr",t,o,s,l,c));return listeners_emit("compoCreated",e,t,o,s),is_Function(e.renderStart)&&e.renderStart(t,o,s),i(l,e),e.async===!0?(e.await(r(e,t,o,s,u)),null):(null!=e.tagName&&(e.nodes={tagName:e.tagName,attr:e.attr,nodes:e.nodes,type:1}),"function"==typeof e.render?(e.render(e.model,o,s),null):e)}function t(e,n,t,r,o,s,l){var u,a,c,f=e.__Ctor,p=!1;if(null!=f)c=new f(n,s);else{c=e;for(var d in n)c[d]=n[d];c.parent=s}var h=c.attr;if(null!=h)for(var d in h)"function"==typeof h[d]&&(h[d]=h[d]("attr",t,r,o,s,d));is_Function(c.renderStart)&&c.renderStart(t,r,o,s,l),c.ID=++builder_componentID,i(s,c);var m=s.components.length-1;return is_Function(c.render)&&(p=!0,u=c.render(t,r,o,s,l),arr_pushMany(l,u),is_Function(c.renderEnd)&&(a=c.renderEnd(u,t,r,o,s),null!=a&&(s.components[m]=a))),p?null:c}function o(e,n,t,r,o,s){e.ID=++builder_componentID,i(o,e),null==e.model&&(e.model=n);var l=e.elements=[];return e.render?e.render(e.model,t,r,o,l):builder_build(e.nodes,e.model,t,r,e,l),null!=s&&0!==l.length&&arr_pushMany(s,l),null}u=function(r,i,s,l,u,a){var c,f=r.tagName;if(null!=r.controller&&(c=r.controller),null==c&&(c=n[f]),null==c)return o(r,i,s,l,u,a);var p,d=!1;"function"==typeof c?p=new c(r,i,s,l,u):(p=c,d=!0);var h=d?t:e;return h(p,r,i,s,l,u,a)}}(),builder_build=function(r,o,i,a,c,f){if(null==r)return a;var p,d,h,m,v=r.type;if(null==c&&(c=new t),null==v&&(r instanceof Array?v=10:null!=r.tagName?v=1:null!=r.content&&(v=2)),1===v&&null!=n[r.tagName]&&(v=4),null==a&&1!==v&&(a=document.createDocumentFragment()),2===v)return l(r,o,i,a,c),a;if(10===v){for(h=0,m=r.length;m>h;h++)builder_build(r[h],o,i,a,c,f);return a}var g=r.tagName;if("else"===g)return a;if(15===v){var _=custom_Statements[g];if(null==_){if(null==n[g])return log_error("<mask: statement is undefined>",g),a;v=4}if(15===v)return _.render(r,o,i,a,c,f),a}if(1===v&&(a=s(r,o,i,a,c,f),f=null),4===v){if(c=u(r,o,i,a,c,f),null==c)return a;p=[],r=c,c.model!==o&&null!=c.model&&(o=c.model)}var y=r.nodes;if(null!=y){null!=f&&null==p&&(p=f);for(var b=y instanceof Array,x=b===!0?y.length:1,w=0,k=null;x>w;w++)k=b===!0?y[w]:y,builder_build(k,o,i,a,c,p)}if(4===v){if(null==r.tagName&&"%"!==r.compoName){var C,A,d,N=r.handlers&&r.handlers.attr;for(d in r.attr)A=r.attr[d],null!=A&&(C=null,null!=N&&is_Function(N[d])&&(C=N[d]),null==C&&null!=e[d]&&(C=e[d]),null!=C&&C(r,A,o,i,p[0],c))}is_Function(r.renderEnd)&&r.renderEnd(p,o,i,a)}return null!=f&&null!=p&&f!==p&&arr_pushMany(f,p),a}}(custom_Attributes,custom_Tags,Dom.Component);var mask_run;!function(){function e(e,n,t){return function(){n.parentNode.insertBefore(e,n),t()}}mask_run=function(){function n(){0===--m&&h&&t()}function t(){is_Function(c.renderEnd)&&c.renderEnd(r,o),Compo.signal.emitIn(c,"domInsert")}var r,o,i,s,l,u,a=_Array_slice.call(arguments);for(s=a.length,l=-1;++l<s;)u=a[l],u instanceof Node?r=u:is_Function(u)?i=u:is_Object(u)&&(o=u);null==r&&(r=document.body);var c=is_Function(i)?new i:new Compo;c.ID=++builder_componentID,null==o&&(o=c.model||{});var f,p=_Array_slice.call(document.getElementsByTagName("script")),d=!1,h=!1,m=0;for(s=p.length,l=-1;++l<s;)if(f=p[l],"text/mask"===f.getAttribute("type")&&"true"===f.getAttribute("data-run")){d=!0;var v={},g=builder_build(parser_parse(f.textContent),o,v,null,c);v.async!==!0?f.parentNode.insertBefore(g,f):(m++,v.done(e(g,f,n)))}return h=!0,d===!1&&log_warn("No blocks found: <script type='text/mask' data-run='true'>...</script>"),0===m&&t(),c}}();var mask_merge;!function(){function e(e,i,s,u){if(null==e)return null;var a;if(is_Array(e))a=n;else switch(e.type){case w:a=l;break;case x:case C:a=o;break;case k:a=t;break;case A:a=r}return void 0!==a?a(e,i,s,u):(log_warn("Uknown type",e.type),null)}function n(n,t,r,o){for(var i,s,l=[],u=n.length,a=-1;++a<u;){if(s=n[a],s.tagName===g){if(null!=i)continue;if(s.expression&&!m(s.expression,t,r))continue;i=e(n[a].nodes,t,r,o)}else i=e(s,t,r,o);f(l,i)}return l}function t(e,t,r,o){var i=new Dom.Fragment;return i.parent=o,i.nodes=n(e.nodes,t,r,i),i}function r(n,t,r,o){if(null==n.nodes)return n;var i=new Dom.Component;return obj_extend(i,n),i.nodes=e(i.nodes,t,r,o),i}function o(n,t,r,o){var l=n.tagName;if(64!==l.charCodeAt(0))return s(n,t,r,o);var u=n.attr.id;if(l===b&&null==u)return r.nodes;if(y===l){var a,c=t[n.expression];if(null==c)return log_error("No template node: @"+n.expression),null;if(is_Array(c)===!1)return a=c,e(n.nodes,p(a.nodes,a.nodes,new v(t)),a,o);for(var d=new Dom.Fragment,g=c.length,w=-1;++w<g;)a=c[w],f(d,e(n.nodes,p(a.nodes,a.nodes,new v(t)),a,o));return d}if(_===l){var k=m(n.expression,t,r);return k?e(n.nodes,t,r,o):null}null==u&&(u=l.substring(1));var C=t.$getNode(u);if(null==C)return null;C.parent&&h(o,C.parent);var A,N=C.nodes;if(void 0!==n.attr.as){var E=n.attr.as;A={type:x,tagName:E,attr:i(n.attr,C.attr,t,r),parent:o,nodes:N},A.attr.as=null}if(null==n.nodes)return A||N;var j=e(n.nodes,p(N,N,new v(t)),C,A||o);return null!=A?(A.nodes=j,A):j}function i(e,n,t,r){if(null==e||null==n)return e||n;var o=u(e,t,r);for(var i in n)o[i]=a(n[i],t,r);return o}function s(n,t,r,o){var i=n.tagName||n.compoName;switch(i){case":template":var s=a(n.attr.id,t,r);return Mask.templates.register(s,n.nodes),null;case":import":var s=a(n.attr.id,t,r),l=Mask.templates.resolve(n,s);return e(l,t,r,o);case"define":case"function":case"var":case"import":return n}var c={type:n.type,tagName:i,attr:u(n.attr,t,r),expression:a(n.expression,t,r),controller:n.controller,parent:o};return n.nodes&&(c.nodes=e(n.nodes,t,r,c)),c}function l(e,n,t,r){return{type:e.type,content:a(e.content,n,t),parent:r}}function u(e,n,t){var r,o=_Object_create(e);for(var i in o)r=o[i],null!=r&&(o[i]=a(r,n,t));return o}function a(e,n,t){var r=-1,o=!1,i=e;if("function"==typeof e&&(o=!0,i=e()),"string"!=typeof i||-1===(r=i.indexOf("@")))return e;for(var s,l=i.substring(0,r),u=i.length,a=91===i.charCodeAt(r+1),f=-1;u>r;){if(f=r,a===!0)r=i.indexOf("]",f),-1===r&&(r=u),f+=2;else for(;u>r&&(s=i.charCodeAt(++r),36===s||95===s||46===s||s>=48&&57>=s||s>=65&&90>=s||s>=97&&122>=s););var p=i.substring(f,r),d=a?m:c,h=d(p,n,t);null!=h&&(l+=h),f=a?r+1:r,r=i.indexOf("@",r),-1===r&&(r=u),l+=i.substring(f,r)}return o?parser_ensureTemplateFunction(l):l}function c(e,n,t){var r=e.indexOf(".");if(-1===r)return log_warn("Merge templates. Accessing node",e),"";var o=e.substring(0,r),i=o.substring(1),s=e.substring(r+1),l=null;return null!=t&&("@attr"===o?l=t.attr:o===t.tagName&&(l=t)),null==l&&(l=n.$getNode(i)),null==l?(log_error("Merge templates. Node not found",o),""):obj_getProperty(l,s)}function f(e,n){if(null!=n)if("function"!=typeof n.concat){if(n.type===k)return void f(e,n.nodes);if("function"==typeof e.appendChild)return void e.appendChild(n);var t=e.length;if(t>0){var r=e[t-1];r.nextSibling=n}e.push(n)}else for(var o=n.length,i=0;o>i;i++)f(e,n[i])}function p(e,n,t){if(null==n)return t;if(is_Array(n)){for(var r=n.length,o=-1;++o<r;)p(n===e?n[o]:e,n[o],t);return t}var i=n.type;if(i===w)return t;if(i===x){var s=n.tagName;if(null!=s&&64===s.charCodeAt(0)){var l=s.substring(1),u={tagName:n.tagName,parent:d(e,n),nodes:n.nodes,attr:n.attr,expression:n.expression};if(null==t[l])t[l]=u;else{var a=t[l];is_Array(a)?a.push(u):t[l]=[a,u]}return t}}return p(e,n.nodes,t)}function d(e,n){if(n===e)return null;for(var t,r,o=n.parent;;){if(null==o)break;if(o===e&&e.type!==x)break;var i={type:o.type,tagName:o.tagName,attr:o.attr,controller:o.controller,expression:o.expression,nodes:null,parent:null};null==r?t=r=i:(t.parent=i,t=i),o=o.parent}return r}function h(e,n){for(var t=e,r=n;null!=t&&null!=r;){r.tagName&&(t.tagName=r.tagName),r.expression&&(t.expression=r.expression);for(var o in r.attr)t.attr[o]=r.attr[o];t=t.parent,r=r.parent}}function m(e,n,t){return t&&(n.attr=t.attr),ExpressionUtil.eval(e,n,null,n)}function v(e){this.scope=this,this.parent=e}mask_merge=function(n,t,r){"string"==typeof n&&(n=parser_parse(n)),"string"==typeof t&&(t=parser_parse(t));var o=p(t,t,new v);return e(n,o,r)};var g="@else",_="@if",y="@each",b="@placeholder",x=Dom.NODE,w=Dom.TEXTNODE,k=Dom.FRAGMENT,C=Dom.STATEMENT,A=Dom.COMPONENT;v.prototype={parent:null,attr:null,scope:null,$getNode:function(e){for(var n,t=this;null!=t;){if(n=t[e],null!=n)return n;t=t.parent}}}}();var mask_optimize;!function(){function e(e){return e.type!==Dom.NODE?null:custom_Optimizers[e.tagName]}mask_optimize=function(n,t){mask_TreeWalker.walkAsync(n,function(n,t){var r=e(n);return null!=r?void r(n,t):void t()},t)}}();var Module;!function(){function e(e){return"mask"===e?u:a}function n(e){for(;null!=e;){if(e.location)return e.location;if(e.resource&&e.resource.location)return e.resource.location;e=e.parent}return r||path_resolveCurrent()}function t(e,n,t){return function(r){return r===e?n:null!=t?t(r):null}}Module={createModule:function(t,r){var o=path_getExtension(t);return""===o&&(o="mask",t+=".mask"),path_isRelative(t)&&(t=path_combine(n(r),t)),t=path_normalize(t),null!=s[t]?s[t]:s[t]=new(e(o))(t)},registerModule:function(e,n){var t;Module.isMask(e)&&(t=new u(e),t.state=1,t._handle(n,function(){t.resolve()})),s[e]=t},createDependency:function(e){return new o(e)},isMask:function(e){var n=path_getExtension(e);return""===n||"mask"===n},cfg:function(e,n){l[e](n)},resolveLocation:n},custom_Tags.module=function(e,t,r,o,i){var s=path_resolveUrl(e.attr.path,n(i));Module.registerModule(s,e.nodes)};var r,o=class_create({constructor:function(e){this.path=e.path,this.exports=e.exports,this.alias=e.alias,Module.isMask(this.path)===!0&&this.eachExport(function(e,n){var t=n||e;"*"!==t&&customTag_registerResolver(t)})},eachExport:function(e){var n=this.alias;null!=n&&e("*",n);var t=this.exports;if(null!=t)for(var r,o=t.length,i=-1;++i<o;)r=t[i],e(r.name,r.alias)},load:function(e,n){var t=this;this.module=Module.createModule(this.path,e),this.module.load().fail(n).done(function(){t.eachExport(function(n,r){t.module.register(e,n,r)}),n(null,t)})},getEmbeddableNodes:function(){var e=this.module;return null==e||"mask"!==e.type?null:null!=this.alias||null!=this.exports?null:e.nodes||e._erroredExport()}}),i=class_create(class_Dfr,{type:null,path:null,location:null,exports:null,state:0,constructor:function(e){this.path=e,this.location=path_getDir(e)},load:function(){if(0===this.state){this.state=1;var e=this;this._load(this.path).fail(function(n){e.reject(e.error=n)}).done(function(n){e._preproc(n,function(n){e.exports=n,e.resolve(e)})})}return this},get:function(e,n,t){return null==this.exports?this._erroredExport():"*"===e?this.exports:this._get(e,n,t)},getHandler:fn_doNothing,register:null,_preproc:function(e,n){n(e)},_load:null,_get:null,_erroredExport:fn_doNothing}),s={},l={base:function(e){r=e}},u=class_create(i,{_load:file_get,_handle:function(e,n){this.imports=[],this.defines={},this.exports=[],this.nodes=e;var t=this.imports,r=this.exports,o=this.defines,i=e.type,s=e;i===Dom.FRAGMENT?s=e.nodes:null!=i&&(s=[e]);for(var l,u,a=s.length,c=-1;++c<a;)if(l=s[c],u=l.tagName,"define"!==u)if("import"!==u)if("module"!==u)r.push(l);else{var f=path_resolveUrl(l.attr.path,this.location);Module.registerModule(f,l.nodes)}else t.push(l.dependency);else o[l.name]=Define.create(l);a=t.length,c=-1;var p=t.length,d=function(){--p>0||n(r)};if(0===p)return void d();for(;++c<a;)this.imports[c].load(this,d)},_preproc:function(e,n){this._handle(parser_parse(e),n)
},_get:function(e,n,t){var r=this.defines[e];if(null!=r)return new Dom.Component(e,t,r);var r=jmask(this.exports).filter(e).get(0);return null==r?(log_error("Export not found",e),log_errorNode("Error: Export not found; "+e)):r},_erroredExport:function(e){var n=(e||"")+"; Resource: "+this.path;return this.error&&(n+="; Status: "+this.error.status),log_errorNode(n)},register:function(e,n,r){var o=r||n,i={resource:{location:this.location},getHandler:this.getHandler.bind(this),nodes:this.get(n,null,e)};e.getHandler=t(o,i,e.getHandler)},type:"mask",nodes:null,modules:null,defines:null}),a=class_create(i,{_load:function(e){var n=__cfg.getScript||file_getScript;return n(e)},_get:function(e){return obj_getProperty(this.exports||{},e)},register:function(e,n,t){var r=t||n,o=this.get(n);return null==o?void log_error("Property is undefined",n):(null==e.scope&&(e.scope={}),void obj_setProperty(e.scope,r,o))},type:"js"})}();var Define;!function(){function e(e){for(var n,t={template:e,meta:{template:"merge"},renderStart:function(){Compo.prototype.renderStart.apply(this,arguments),this.nodes===this.template&&(this.nodes=mask.merge(this.nodes,[],this))}},r=e.length,o=0;r>o;o++)n=e[o],"function"===n.tagName&&(t[n.name]=n.fn,n.render=null);return t}function n(e,n,t){var r=[];if(null==e)return r;for(var o,i=e.length,s=-1;++s<i;)if(o=e[s],o.compo){var l=custom_Tags[o.compo];if(null!=l){r.unshift(l);continue}var u=ExpressionUtil.eval(o.compo,n,null,t);if(null!=u){r.unshift(u);continue}log_error("Nor component, nor scoped data is resolved:",o.compo)}else;return r}function t(t,r,o){var i=(t.name,e(t.nodes)),s=n(t["extends"],r,o);return s.push(i),Compo.apply(null,s)}Define={create:function(e,n,r){return t(e,n,r)}}}();var mask_TreeWalker;!function(){function e(e){return Dom.FRAGMENT===t(e)}function n(e){var n=e.nodes;return null==n?null:is_Array(n)?n:e.nodes=[n]}function t(e){var n=e.type;return null!=n?n:is_Array(e)?Dom.FRAGMENT:null!=e.tagName?Dom.NODE:null!=e.content?Dom.TEXTNODE:Dom.NODE}function r(n){if("string"==typeof n&&(n=parser_parse(n)),e(n)===!1){var t=new Dom.Fragment;t.appendChild(n),n=t}return n}mask_TreeWalker={walk:function(e,n){return e=r(e),new o(e,n),e},walkAsync:function(e,n,t){e=r(e),new i(e,n,t)}};var o;!function(){function t(r,o,i,u){if(null!=r){var a,c=!0;e(r)!==!0&&(a=o(r)),void 0!==a&&(a=new s(a),a.process(new l(r,i,u)),c=a.deep);var f=n(r);if(null!=f&&c!==!1)for(var p,d=f.length,h=0;d>h;h++)p=f[h],t(p,o,r,h)}}o=function(e,n){t(e,n)}}();var i;!function(){i=function(e,n,t){this.stack=[],this.done=t,this.root=e,this.fn=n,this.process=this.process.bind(this),this.visit(this.push(e))},i.prototype={current:function(){return this.stack[this.stack.length-1]},push:function(e,n,t){var r=new l(e,n,t);return this.stack.push(r),r},pop:function(){return this.stack.pop()},getNext:function(e){var t=this.current(),r=t.node,o=n(r);if(null==r)throw Error("Node is null");if(null!=o&&e!==!1&&0!==o.length){if(null==o[0])throw logger.log(r.tagName),Error("IS NULL");return this.push(o[0],r,0)}for(var i,s;0!==this.stack.length;)if(t=this.pop(),i=t.parent,s=t.index,null!=i){if(++s<i.nodes.length)return this.push(i.nodes[s],i,s)}else this.pop();return null},process:function(e){var n=!0;void 0!==e&&(e=new s(e),e.process(this.current()),n=e.deep);var t=this.getNext(n);return null==t?void this.done(this.root):void this.visit(t)},visit:function(n){var t=n.node;return e(t)===!1?void this.fn(t,this.process):void this.process()},fn:null,done:null,stack:null}}();var s;!function(){s=function(e){for(var n in e)this[n]=e[n]},s.prototype={deep:!0,replace:null,process:function(e){return null!=this.replace?(this.deep=!1,void(e.parent.nodes[e.index]=this.replace)):void 0}}}();var l=function(e,n,t){this.node=e,this.index=t,this.parent=n}}();var cache={},Mask={render:function(e,n,t,r,o){return"string"==typeof e&&(e=_Object_hasOwnProp.call(cache,e)?cache[e]:cache[e]=parser_parse(e)),null==t&&(t={}),builder_build(e,n,t,r,o)},renderAsync:function(e,n,t,r,o){null==t&&(t={});var i=mask.render(e,n,t,r,o),s=new class_Dfr;return t.async===!0?t.done(function(){s.resolve(i)}):s.resolve(i),s},compile:parser_parse,parse:parser_parse,stringify:mask_stringify,build:builder_build,run:mask_run,merge:mask_merge,optimize:mask_optimize,registerOptimizer:function(e,n){custom_Optimizers[e]=n},registerHandler:customTag_register,getHandler:function(e){return null!=e?custom_Tags[e]:custom_Tags},registerStatement:function(e,n){custom_Statements[e]=is_Function(n)?{render:n}:n},getStatement:function(e){return null!=e?custom_Statements[e]:custom_Statements},registerAttrHandler:function(e,n,t){is_Function(n)&&(t=n),custom_Attributes[e]=t},getAttrHandler:function(e){return null!=e?custom_Attributes[e]:custom_Attributes},registerUtil:customUtil_register,getUtil:customUtil_get,$utils:customUtil_$utils,registerUtility:function(e,n){this.registerUtility=this.registerUtil,this.registerUtility(e,n)},getUtility:function(){return this.getUtility=this.getUtil,this.getUtility()},clearCache:function(e){"string"==typeof e?delete cache[e]:cache={}},Utils:{Expression:ExpressionUtil,getProperty:function(e,n){return log_warn("mask.getProperty is deprecated. Use `mask.obj.get`"),obj_getProperty(e,n)},ensureTmplFn:Parser.ensureTemplateFunction},Dom:Dom,TreeWalker:mask_TreeWalker,plugin:function(){},obj:{get:obj_getProperty,set:obj_setProperty,extend:obj_extend},is:{Function:is_Function,String:is_String,ArrayLike:is_ArrayLike,Array:is_ArrayLike,Object:is_Object},"class":{create:class_create,Deferred:class_Dfr},parser:{ObjectLexer:parser_ObjectLexer},on:listeners_on,off:listeners_off,delegateReload:function(){},setInterpolationQuotes:Parser.setInterpolationQuotes,setCompoIndex:function(e){builder_componentID=e},cfg:function(){var e=arguments;if(0===e.length)return __cfg;var n;if(2===e.length)return n=e[0],void(__cfg[n]=e[1]);var t=e[0];if("object"==typeof t)for(n in t)__cfg[n]=t[n]}};Mask.renderDom=Mask.render;var Compo=exports.Compo=function(mask){function domLib_initialize(){null!=domLib&&null!=domLib.fn&&(domLib.fn.compo=function(e){if(0===this.length)return null;var n=Anchor.resolveCompo(this[0]);return null==e?n:find_findSingle(n,selector_parse(e,Dom.CONTROLLER,"up"))},domLib.fn.model=function(e){var n=this.compo(e);if(null==n)return null;for(var t=n.model;null==t&&n.parent;)n=n.parent,t=n.model;return t},function(){var e=["append","prepend","before","after"];["appendMask","prependMask","beforeMask","afterMask"].forEach(function(n,t){domLib.fn[n]=function(n,r,o,i){if(0===this.length)return this;this.length>1,null==o&&(o=2>t?this.compo():this.parent().compo());var s=!1;null==o&&(o={},s=!0),null==o.components&&(o.components=[]);for(var l=o.components,u=l.length,a=mask.render(n,r,i,null,o),c=this[e[t]](a),f=l.length;f>u;u++)Compo.signal.emitIn(l[u],"domInsert");return c}})}(),function(){function e(e,n){node_tryDispose(n)}function n(e,n){node_tryDisposeChildren(n)}var t=domLib.fn.remove,r=domLib.fn.empty;domLib.fn.removeAndDispose=function(){return this.each(e),t.call(this)},domLib.fn.emptyAndDispose=function(){return this.each(n),r.call(this)}}())}function SlotHandler(){}var Dom=mask.Dom,_mask_ensureTmplFnOrig=mask.Utils.ensureTmplFn,_mask_ensureTmplFn,_resolve_External,domLib,Class;!function(){function e(){for(var e,n=arguments.length;--n>-1;)if(e=_resolve_External(arguments[n]),null!=e)return e;return null}_mask_ensureTmplFn=function(e){return"string"!=typeof e?e:_mask_ensureTmplFnOrig(e)},_resolve_External=function(e){return n[e]||r[e]||t[e]};var n=global,t=global.atma||{},r=exports||{};domLib=e("jQuery","Zepto","$"),Class=e("Class")}();var selector_parse,selector_match;!function(){function e(e){return function(t){return n(t,e)}}function n(e,t,r){if("string"!=typeof e)return!1;if(null==r&&(r=0),r=e.indexOf(t,r),-1===r)return!1;if(r>0&&e.charCodeAt(r-1)>32)return n(e,t,r+1);var o=e.length,i=t.length;return o-i>r&&e.charCodeAt(r+i)>32?n(e,t,r+1):!0}selector_parse=function(n,t,r){if(null==n&&log_error("<compo>selector is undefined",t),"object"==typeof n)return n;var o,i,s;if(null==o)switch(n[0]){case"#":o="id",n=n.substring(1),i="attr";break;case".":o="class",n=e(n.substring(1)),i="attr";break;default:o=t===Dom.SET?"tagName":"compoName"}return s="up"===r?"parent":t===Dom.SET?"nodes":"components",{key:o,prop:i,selector:n,nextKey:s}},selector_match=function(e,n,t){is_String(n)&&(null==t&&(t=Dom[e.compoName?"CONTROLLER":"SET"]),n=selector_parse(n,t));var r=n.prop?e[n.prop]:e;return null==r?!1:is_Function(n.selector)?n.selector(r[n.key]):null!=n.selector.test?n.selector.test(r[n.key]):r[n.key]==n.selector}}();var find_findSingle,find_findAll;!function(){find_findSingle=function(e,n){if(is_Array(e)){for(var t,r=e.length,o=0;r>o;o++)if(t=find_findSingle(e[o],n),null!=t)return t;return null}return selector_match(e,n)?e:(e=e[n.nextKey],null==e?null:find_findSingle(e,n))},find_findAll=function(e,n,t){if(null==t&&(t=[]),is_Array(e)){for(var r=e.length,o=0;r>o;o++)find_findAll(e[o],n,t);return t}return selector_match(e,n)&&t.push(e),e=e[n.nextKey],null==e?t:find_findAll(e,n,t)}}();var dom_addEventListener,node_tryDispose,node_tryDisposeChildren;!function(){dom_addEventListener=function(e,n,t,r,o){return TouchHandler.supports(n)?void TouchHandler.on(e,n,t):KeyboardHandler.supports(n,r)?void KeyboardHandler.attach(e,n,r,t,o):null!=domLib?domLib(e).on(n,t):null!=e.addEventListener?e.addEventListener(n,t,!1):void(e.attachEvent&&e.attachEvent("on"+n,t))},node_tryDispose=function(e){if(e.hasAttribute("x-compo-id")){var n=e.getAttribute("x-compo-id"),t=Anchor.getByID(n);if(null!=t){if(null==t.$||1===t.$.length)return compo_dispose(t),void compo_detachChild(t);var r=_Array_indexOf.call(t.$,e);-1!==r&&_Array_splice.call(t.$,r,1)}}node_tryDisposeChildren(e)},node_tryDisposeChildren=function(e){for(var n=e.firstChild;null!=n;)1===n.nodeType&&node_tryDispose(n),n=n.nextSibling}}();var domLib_find,domLib_on;!function(){domLib_find=function(e,n){return e.filter(n).add(e.find(n))},domLib_on=function(e,n,t,r){return null==t?e.on(n,r):(e.on(n,t,r).filter(t).on(n,r),e)}}();var compo_dispose,compo_detachChild,compo_ensureTemplate,compo_ensureAttributes,compo_attachDisposer,compo_removeElements,compo_prepairAsync,compo_errored,compo_meta_prepairAttributeHandler,compo_meta_executeAttributeHandler;!function(){function e(e){var n=e.template;if(null==n){if(n=e.attr.template,null==n)return null;delete e.attr.template}if("object"==typeof n)return n;if(is_String(n)){if(35===n.charCodeAt(0)&&/^#[\w\d_-]+$/.test(n)){var t=document.getElementById(n.substring(1));if(null==t)return log_warn("Template not found by id:",n),null;n=t.innerHTML}return mask.parse(n)}return log_warn("Invalid template",typeof n),null}compo_dispose=function(e){null!=e.dispose&&e.dispose(),Anchor.removeCompo(e);var n=e.components;if(null!=n)for(var t=n.length;--t>-1;)compo_dispose(n[t])},compo_detachChild=function(e){var n=e.parent;if(null!=n){var t,r=e.$,o=n.$||n.elements;if(o&&r){var i,s,l=r.length;for(t=o.length;--t>-1;)for(i=o[t],s=l;--s>-1;)if(i===r[s]){o.splice(t,1);break}}var u=n.components;if(null!=u){for(t=u.length;--t>-1;)if(u[t]===e){u.splice(t,1);break}-1===t&&log_warn("<compo:remove> - i`m not in parents collection",e)}}},compo_ensureTemplate=function(n){if(null==n.nodes)return void(n.nodes=e(n));var t=n.meta.template;if(null!=t&&"replace"!==t){var r=e(n);return"merge"===t?void(n.nodes=mask_merge(r,n.nodes,n)):"join"===t?void(n.nodes=[r,n.nodes]):void log_error("Invalid meta.nodes behaviour",t)}},compo_attachDisposer=function(e,n){if(null==e.dispose)return void(e.dispose=n);var t=e.dispose;e.dispose=function(){n.call(this),t.call(this)}},compo_removeElements=function(e){if(e.$)return void e.$.remove();var n=e.elements;if(n)for(var t=-1,r=n.length;++t<r;)n[t].parentNode&&n[t].parentNode.removeChild(n[t]);else{var o=e.components;if(o)for(var t=-1,r=o.length;++t<r;)compo_removeElements(o[t])}},compo_prepairAsync=function(e,n,t){var r=Compo.pause(n,t);e.then(r,function(e){compo_errored(n,e),r()})},compo_errored=function(e,n){e.nodes=mask.parse('.-mask-compo-errored > "~[.]"'),e.model=n.message||String(n),e.renderEnd=fn_doNothing},function(){function e(e){return function(n,t){var o,i,s,l,u=n.attr;for(o in e)if(i=e[o],s=u[o],l=i(n,s,t),null!=l)return r(n,l,o,s),!1;return!0}}function n(e,n,r,s){var l=63===n.charCodeAt(0),u=l?n.substring(1):n,a=u.replace(/-(\w)/g,t),c=r;return"string"==typeof r?c=o[r]:r instanceof RegExp?c=i.regexp(r):"function"==typeof r?c=r:null==r&&(c=i.any()),null==c?void log_error("Function expected for the attr. handler",n):(e[a]=null,e=null,void(s[u]=function(e,n,t){if(null==n)return l?null:Error("Expected");var r=c.call(e,n,e,t,u);return r instanceof Error?r:(e[a]=r,null)}))}function t(e,n){return n.toUpperCase()}function r(e,n,t,r){n.message=e.compoName+" - attribute `"+t+"`: "+n.message,compo_errored(e,n),log_error(n.message,". Current: ",r)}compo_meta_prepairAttributeHandler=function(t){null==t.meta&&(t.meta={attributes:null,cache:null,mode:null});var r=t.meta.attributes,o=null;if(r){var i={};for(var s in r)n(t,s,r[s],i);o=e(i)}t.meta.handleAttributes=o},compo_meta_executeAttributeHandler=function(e,n){var t=e.meta&&e.meta.handleAttributes;return null==t?!0:t(e,n)};var o={string:function(e){return"string"==typeof e?e:Error("String")},number:function(e){var n=Number(e);return n===n?n:Error("Number")},"boolean":function(e,n,t,r){return"boolean"==typeof e?e:e===r?!0:"true"===e||"1"===e?!0:"false"===e||"0"===e?!1:Error("Boolean")}},i={regexp:function(e){return function(n){return e.test(n)?n:Error("RegExp")}},any:function(){return function(e){return e}}}}()}();var compo_create,compo_createConstructor;!function(){compo_create=function(e){var n,t,r=e.length,o=e[r-1];r>1&&compo_inherit(o,_Array_slice.call(e,0,r-1)),null==o&&(o={});var i=_resolve_External("include");null!=i&&(o.__resource=i.url);o.attr;for(t in o.attr)o.attr[t]=_mask_ensureTmplFn(o.attr[t]);var s=o.slots;for(t in s)"string"==typeof s[t]&&(s[t]=o[s[t]]);compo_meta_prepairAttributeHandler(o),n=o.hasOwnProperty("constructor")?o.constructor:function(){},n=compo_createConstructor(n,o);for(t in CompoProto)null==o[t]&&(o[t]=CompoProto[t]);return n.prototype=o,o=null,n},compo_createConstructor=function(e,n){var t=n.compos,r=n.pipes,o=n.scope,i=n.attr;return null==t&&null==r&&null==i&&null==o?e:function(n,s,l,u,a){if(null!=e){var c=e.call(this,n,s,l,u,a);if(null!=c)return c}null!=t&&(this.compos=obj_create(this.compos)),null!=r&&Pipes.addController(this),null!=i&&(this.attr=obj_create(this.attr)),null!=o&&(this.scope=obj_create(this.scope))}}}();var compo_inherit;!function(){function e(o,i,s){if(null!=o&&null!=i){if("node"===s){var l=o.template||o.nodes,u=i.template||i.nodes;o.template=null==l||null==u?l||u:mask.merge(u,l,o),null!=o.nodes&&(o.nodes=o.template)}var a,c,f,p=!1;for(var d in i)if(a=i[d],null!=a&&"constructor"!==d&&("node"!==s||"template"!==d&&"nodes"!==d))if(c=typeof a,null!=o[d]){if("node"===s){var h="renderStart"===d||"renderEnd"===d||"emitIn"===d||"emitOut"===d||"components"===d||"nodes"===d||"template"===d||"find"===d||"closest"===d||"on"===d||"remove"===d||"slotState"===d||"signalState"===d||"append"===d||"appendTo"===d;if(h===!0)continue}if("pipes"!==s)if("function"!==c){if("object"===c){switch(d){case"slots":case"pipes":case"events":case"attr":e(o[d],a,d);continue}t(o[d],a)}}else f=!1,"slots"===s||"events"===s||"pipe"===s?f=!0:"node"!==s||"onRenderStart"!==d&&"onRenderEnd"!==d||(f=!0),o[d]=r(o[d],a,f),p=!0;else e(o[d],a,"pipe")}else o[d]="object"===c?n(a):a;p===!0&&(null!=o.super&&log_error("`super` property is reserved. Dismissed. Current prototype",o),o.super=null)}}/*! Circular references are not handled */
function n(e){if(null==e)return null;if("object"!=typeof e)return e;if(is_Array(e)){for(var t=e.length,r=-1,o=new Array(t);++r<t;)o[r]=n(e[r]);return o}var i,s,l=obj_create(e);for(i in l)s=l[i],null!=s&&"object"==typeof s&&(l[i]=n(s));return l}function t(e,n){var r,o,i;for(var i in n)r=e[i],o=n[i],null!=r?is_rawObject(r)&&is_rawObject(o)&&t(r,o):e[i]=o}function r(e,n,t){function r(){var e=l._fn||(l._fn=s(l._fn_chain));return e.apply(this,arguments)}if("compoInheritanceWrapper"===e.name)return e._fn_chain.push(n),e;var s=t===!0?i:o,l=r;return l._fn_chain=[e,n],l._fn=null,l}function o(e){for(var n=e.length,t=e[--n];--n>-1;)t=s(e[n],t);return t}function i(e){var n=e.length;return function(){for(var t,r,o,i=n;--i>-1;)r=e[i],null!=r&&(o=fn_apply(r,this,arguments),void 0!==o&&(t=o));return t}}function s(e,n){return function(){this.super=n;var t=fn_apply(e,this,arguments);return this.super=null,t}}function l(e){var n=e.length;return function(){for(var t,r=n;--r>-1;){var o=e[r].apply(this,arguments);null!=o&&(t=o)}return t}}compo_inherit=function(n,t){for(var r,o=t.length,i=o,s=[];--i>-1;)r=t[i],"string"==typeof r&&(r=Mask.getHandler(r)),null!=r?("function"==typeof r&&(s.push(r),r=r.prototype),e(n,r,"node")):log_error("Base component not defined",t[i]);i=-1,o=s.length,o>0&&(n.hasOwnProperty("constructor")&&s.unshift(n.constructor),n.constructor=l(s));var u=n.meta;null==u&&(u=n.meta={}),null==u.template&&(u.template="merge")}}(mask.merge);var dfr_isBusy;!function(){dfr_isBusy=function(e){return null==e||"function"!=typeof e.then?!1:is_Function(e.isBusy)?e.isBusy():is_Function(e.state)?"pending"===e.state():(log_warn("Class or jQuery deferred interface expected"),!1)}}();var Children_={select:function(e,n){for(var t in n){var r=n[t],o=null,i=null;if(r instanceof Array&&(i=r[0],o=r.splice(1)),"string"==typeof r&&(i=r),null==r||null==i)return log_error("Unknown component child",t,n[t]),void log_warn("Is this object shared within multiple compo classes? Define it in constructor!");var s=i.indexOf(":"),l=i.substring(0,s);l=Compo.config.selectors[l],null==l?e.compos[t]=e.$[0].querySelector(i):(i=i.substring(++s).trim(),e.compos[t]=l(e,i));var u=e.compos[t];null!=o&&(null!=u.$&&(u=u.$),Events_.on(e,o,u))}}},Events_={on:function(e,n,t){null==t&&(t=e.$);for(var r,o=n instanceof Array,i=o?n.length:1,s=0;o?i>s:1>s;s++)if(r=o?n[s]:n,r instanceof Array)null!=EventDecorator&&(r[0]=EventDecorator(r[0])),t.on.apply(t,r);else for(var l in r){var u,a,c="string"==typeof r[l]?e[r[l]]:r[l],f=l.indexOf(":");-1!==f?(u=l.substring(0,f),a=l.substring(f+1).trim()):u=l,null!=EventDecorator&&(u=EventDecorator(u)),domLib_on(t,u,a,fn_proxy(c,e))}}},EventDecorator=null,EventDecos=function(){var e=function(){if(null==document)return!1;if("createTouch"in document)return!0;try{return!!document.createEvent("TouchEvent").initTouchEvent}catch(e){return!1}}();return{touch:function(n){return e===!1?n:"click"===n?"touchend":"mousedown"===n?"touchstart":"mouseup"===n?"touchend":"mousemove"===n?"touchmove":n}}}(),Pipes=function(){function e(e,n){return function(t){new i(e).emit(n,t)}}function n(e,n){return null==n.pipes[e]?void log_error("Controller has no pipes to be added to collection",e,n):(null==s[e]&&(s[e]=[]),void s[e].push(n))}function t(e,n){for(var t=s[e],r=t.length;--r>-1;)t[r]===n&&t.splice(r,1)}function r(){var e=this,n=e.pipes;for(var r in n)t(r,e)}function o(e){var t=e.pipes;for(var o in t)n(o,e);Compo.attachDisposer(e,r.bind(e))}function i(e){return this instanceof i==!1?new i(e):(this.pipeName=e,this)}var s={};return mask.registerAttrHandler("x-pipe-signal","client",function(n,t,r,o,i){for(var s,l=t.split(";"),u=l.length,a=-1;++a<u;)if(s=l[a].trim(),""!==s){var c,f,p=s.indexOf(":"),d=s.substring(0,p),h=s.substring(p+1).trim(),m=h.indexOf(".");if(-1===m)return void log_error('define pipeName "click: pipeName.pipeSignal"');c=h.substring(0,m),f=h.substring(++m);var v=e(c,f);dom_addEventListener(i,d,v)}}),i.prototype={constructor:i,emit:function(e){var n,t=s[this.pipeName],r=this.pipeName;if(null!=t){2===arguments.length&&is_Array(arguments[1])?n=arguments[1]:arguments.length>1&&(n=_Array_slice.call(arguments,1));for(var o,i,l,u,a=t.length;-1!==--a;)o=t[a],i=o.pipes[r],null!=i&&(l=i[e],is_Function(l)&&(l.apply(o,n),u=!0))}}},i.addController=o,i.removeController=r,{addController:o,removeController:r,pipe:i}}(),KeyboardHandler;!function(){var e,n,t;!function(){e=function(e,n,t){e.addEventListener(n,t,!1)},n=function(e,n,t){e.removeEventListener(n,t,!1)},t=function(e){var n=e.keyCode||e.which;return n>=96&&105>=n?n-48:n}}();var r,o,i;r={backspace:8,tab:9,"return":13,enter:13,shift:16,ctrl:17,control:17,alt:18,option:18,fn:255,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,start:36,left:37,up:38,right:39,down:40,insert:45,ins:45,del:46,numlock:144,scroll:145,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,";":186,"=":187,"*":106,"+":107,"-":189,".":190,"/":191,",":188,"`":192,"[":219,"\\":220,"]":221,"'":222},o={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},i={16:"shiftKey",17:"ctrlKey",18:"altKey"};var s,l,u,a;!function(){l=function(e){return e.ctrlKey||e.altKey?!1:s(e.target)},u=function(e){return null==e.$||0===e.$.length?!1:a(e.$.get(0))},a=function(e){if(document.contains(e)===!1)return!1;if("none"===e.style.display)return!1;var n=e.disabled;return n===!0?!1:!0},s=function(n){var t=n.tagName;return"TEXTAREA"===t?!0:"INPUT"!==t?!1:-1===e.indexOf(" "+n.type+" ")};var e=" button submit checkbox file hidden image radio range reset "}();var c;!function(){function n(){r=new _,e(window,"keydown",c),e(window,"keyup",c),e(window,"focus",c.reset)}c={on:function(e,t,o){null==r&&n();var i=f.create(e,"keydown",t,o);r.attach(i)},off:function(e){r.off(e)},handleEvent:function(e){r.handle(e.type,t(e),e)},reset:function(){r.reset()}};var r}();var f;!function(){function e(e){for(var n,t,o=e.split("+"),i=o.length,s=0,l=[];i>s;s++){if(n=o[s].trim(),t=r[n],void 0===t){if(1!==n.length)throw Error("Unexpected sequence. Use `+` sign to define the sequence:"+n);t=n.toUpperCase().charCodeAt(0)}l[s]=t}return{last:l[i-1],keys:l.sort()}}f=function(e){this.set=e},f.parse=function(n){for(var t=n.split(","),r=[],o=t.length,i=0;o>i;i++)r[i]=e(t[i]);return r},f.create=function(e,n,t,r){var o=f.parse(e),i=p.create(o);return null==i&&(i=new d(o)),i.init(n,t,r),i},f.prototype={type:null,ctx:null,set:null,fn:null,init:function(e,n,t){this.type=e,this.ctx=t,this.fn=n},tryCall:null}}();var p;!function(){p=class_create(f,{constructor:function(e,n,t){this.key=n,this.mods=t},tryCall:function(e,n,t){if(e.type!==this.type||t!==this.key)return m;for(var r in this.mods)if(e[r]!==this.mods[r])return m;return this.fn.call(this.ctx,e),h}}),p.create=function(e){if(1!==e.length)return null;for(var n,t,r=e[0].keys,o=r.length,s={shiftKey:!1,ctrlKey:!1,altKey:!1};--o>-1;)if(i.hasOwnProperty(r[o])!==!1)s[i[r[o]]]=!0,t=!0;else{if(null!=n)return null;n=r[o]}return new p(e,n,s)}}();var d,h=1,m=2,v=3,g=4;!function(){d=class_create(f,{index:0,tryCall:function(e,n,t){var r=this.check_(n,t);return r===h&&(this.index=0,this.fn.call(this.ctx,e)),r},fail_:function(){return this.index=0,m},check_:function(e,n){var t=this.set[this.index],r=t.keys,o=t.last,i=e.length;if(i<r.length)return v;if(i>r.length)return this.fail_();if(o!==n)return this.fail_();for(;--i>-1;)if(r[i]!==e[i])return this.fail_();return this.index<this.set.length-1?(this.index++,g):(this.index=0,h)}})}();var _;!function(){_=function(){this.keys=[],this.combs=[]},_.prototype={keys:null,combs:null,attach:function(e){this.combs.push(e)},off:function(e){for(var n=this.combs.length,t=0;n>t;t++)if(this.combs[t].fn===e)return this.combs.splice(t,1),!0;return!1},handle:function(e,n,t){return 0===this.combs.length||this.filter_(t,n)?void 0:"keydown"===e?void(this.add_(n)&&this.emit_(e,t,n)):void("keyup"===e&&(this.emit_(e,t,n),this.remove_(n)))},handleEvent:function(e){var n=t(e),r=e.type;this.handle(r,n,e)},reset:function(){this.keys.length=0},add_:function(e){for(var n,t=this.keys.length,r=0;t>r;r++){if(n=this.keys[r],n===e)return!1;if(n>e)return this.keys.splice(r,0,e),!0}return this.keys.push(e),!0},remove_:function(e){for(var n=this.keys.length;--n>-1;)if(this.keys[n]===e)return void this.keys.splice(n,1)},emit_:function(e,n,t){for(var r,o,i=!1,s=this.combs,l=s.length,u=0;l>u;u++)r=s[u],r.type===e&&(o=r.tryCall(n,this.keys,t),(h===o||o===g)&&n.preventDefault(),(o===v||o===g)&&(i=!0))},filter_:function(e,n){return l(e,n)}}}(),KeyboardHandler={supports:function(e,n){if(null==n)return!1;switch(e){case"press":case"keypress":case"keydown":case"keyup":case"hotkey":case"shortcut":return!0}return!1},on:function(n,r,o,i){("keypress"===r||"press"===r)&&(r="keydown");var s=f.create(o,r,i);if(s instanceof p)return void e(n,r,function(e){var n=t(e),r=s.tryCall(e,null,n);r===h&&e.preventDefault()});var l=new _;e(n,"keydown",l),e(n,"keyup",l),l.attach(s)},hotkeys:function(e,n){var t,r;for(r in n)t=n[r],c.on(r,t,e);compo_attachDisposer(e,function(){var e;for(e in n)c.off(n[e])})},attach:function(e,n,t,r,o){s(e)&&this.on(e,n,t,r);for(var i=o;i&&null==i.slots;)i=i.parent;if(null==i)return void log_error("Slot-component not found:",t);var l=i.hotkeys;null==l&&(l=i.hotkeys={}),l[t]=r}}}();var TouchHandler;!function(){var e,n,t,r;!function(){r="ontouchstart"in global,e=function(e,n,t){e.addEventListener(n,t,!1)},n=function(e,n,t){e.removeEventListener(n,t,!1)},t=function(e,n){var t=new CustomEvent(n,{cancelable:!0,bubbles:!0});e.dispatchEvent(t)}}();var o;!function(){function n(e){var n=null,r=e.changedTouches;return r&&r.length&&(n=r[0]),null==n&&e.touches&&(n=e.touches[0]),null==n?e:t(e,n)}function t(e,n){var t=Object.create(MouseEvent.prototype);for(var r in e)t[r]=e[r];for(var r in s)t[r]=n[r];return new MouseEvent(i[e.type],t)}o=function(n,t,o){this.el=n,this.fn=o,this.dismiss=0,e(n,t,this),e(n,r[t],this)};var r={mousemove:"touchmove",mousedown:"touchstart",mouseup:"touchend"},i={touchmove:"mousemove",touchstart:"mousedown",touchup:"mouseup"};o.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"touchmove":case"touchend":this.dismiss++,e=n(e),this.fn(e);break;case"mousedown":case"mousemove":case"mouseup":--this.dismiss<0&&(this.dismiss=0,this.fn(e))}}};var s={clientX:1,clientY:1,pageX:1,pageY:1,screenX:1,screenY:1}}();var i;!function(){i=function(n,t){this.state=0,this.el=n,this.fn=t,this.startX=0,this.startY=0,this.tStart=0,this.tEnd=0,this.dismiss=0,e(n,"touchstart",this),e(n,"touchend",this),e(n,"click",this)};var r=300,o=10;i.prototype={handleEvent:function(e){switch(e.type){case"touchmove":this.touchmove(e);break;case"touchstart":this.touchstart(e);break;case"touchend":this.touchend(e);break;case"touchcancel":this.reset();break;case"click":this.click(e)}},touchstart:function(n){e(document.body,"touchmove",this);var t=n.touches[0];this.state=1,this.tStart=n.timeStamp,this.startX=t.clientX,this.startY=t.clientY},touchend:function(e){return this.tEnd=e.timeStamp,1===this.state?(this.dismiss++,this.tEnd-this.tStart<=r?void this.call(e):void t(this.el,"taphold")):void this.reset()},click:function(e){if(!(--this.dismiss>-1)){var n=e.timeStamp-this.tEnd;400>n||(this.dismiss=0,this.call(e))}},touchmove:function(e){var n=e.touches[0],t=n.clientX-this.startX;if(0>t&&(t*=-1),t>o)return void this.reset();var r=n.clientY-this.startY;return 0>r&&(r*=-1),r>o?void this.reset():void 0},reset:function(){this.state=0,n(document.body,"touchmove",this)},call:function(e){this.reset(),this.fn(e)}}}(),TouchHandler={supports:function(e){if(r===!1)return!1;switch(e){case"click":case"mousedown":case"mouseup":case"mousemove":return!0}return!1},on:function(e,n,t){return"click"===n?new i(e,t):new o(e,n,t)}}}();var Anchor=function(){var e={};return{create:function(n){return null==n.ID?void log_warn("Component should have an ID"):void(e[n.ID]=n)},resolveCompo:function(n){if(null==n)return null;var t,r,o;do{if(r=n.getAttribute("x-compo-id"),r&&(null==t&&(t=r),o=e[r],null!=o&&(o=Compo.find(o,{key:"ID",selector:t,nextKey:"components"}),null!=o)))return o;n=n.parentNode}while(n&&1===n.nodeType);return null},removeCompo:function(n){null!=n.ID&&delete e[n.ID]},getByID:function(n){return e[n]}}}(),Compo,CompoProto;!function(){Compo=function(){return this instanceof Compo?void 0:compo_create(arguments)},obj_extend(Compo,{create:function(){return compo_create(arguments)},createClass:function(){var e=compo_create(arguments),n=e.prototype;return n.Construct=e,Class(n)},initialize:function(e,n,t,r,o){function i(e){s={controller:e,type:Dom.COMPONENT}}if(null==e)throw Error("Undefined is not a component");null==r&&(t&&null!=t.nodeType?(r=t,t=null):n&&null!=n.nodeType&&(r=n,n=null));var s;if("string"==typeof e)if(/^[^\s]+$/.test(e)){var l=mask.getHandler(e);if(null==l)throw Error("Component not found: "+e);i(l)}else i(Compo({template:e}));else"function"==typeof e&&i(e);null==o&&null!=r&&(o=Anchor.resolveCompo(r)),null==o&&(o=new Compo);var u=mask.render(s,n,t,null,o),a=o.components[o.components.length-1];return null!=r&&(r.appendChild(u),Compo.signal.emitIn(a,"domInsert")),a},find:function(e,n){return find_findSingle(e,selector_parse(n,Dom.CONTROLLER,"down"))},closest:function(e,n){return find_findSingle(e,selector_parse(n,Dom.CONTROLLER,"up"))},dispose:compo_dispose,ensureTemplate:compo_ensureTemplate,attachDisposer:compo_attachDisposer,config:{selectors:{$:function(e,n){var t=domLib_find(e.$,n);return t},compo:function(e,n){var t=Compo.find(e,n);return t}},setDOMLibrary:function(e){domLib!==e&&(domLib=e,domLib_initialize())},getDOMLibrary:function(){return domLib},eventDecorator:function(e){return"function"==typeof e?void(EventDecorator=e):"string"==typeof e?(console.error("EventDecorators are not used. Touch&Mouse support is already integrated"),void(EventDecorator=EventDecos[e])):"boolean"==typeof e&&e===!1?void(EventDecorator=null):void 0}},pipe:Pipes.pipe,resource:function(e){for(var n=e;null!=n;){if(n.resource)return n.resource;n=n.parent}return include.instance()},plugin:function(source){eval(source)},Dom:{addEventListener:dom_addEventListener}}),function(){function e(e,n,t){return null==e[n]&&(e[n]=[]),e[n].push(t),e}function n(e,n,t){var r=e[n];if(null!=r)for(var o,i=0,s=r.length;s>i;i++)o=r[i],null!=o&&(r[i]=null,null!=t?o.apply(this,t):o())}var t={done:function(n){return e(this,"_cbs_done",n)},fail:function(n){return e(this,"_cbs_fail",n)},always:function(n){return e(this,"_cbs_always",n)},resolve:function(){this.async=!1,n(this,"_cbs_done",arguments),n(this,"_cbs_always",arguments)},reject:function(){this.async=!1,n(this,"_cbs_fail",arguments),n(this,"_cbs_always")},_cbs_done:null,_cbs_fail:null,_cbs_always:null},r={async:!0,await:function(e){this.resume=e}};Compo.pause=function(e,n){return null==n.async&&(n.defers=[],obj_extend(n,t)),n.async=!0,n.defers.push(e),obj_extend(e,r),function(){Compo.resume(e,n)}},Compo.resume=function(e,n){e.resume&&e.resume(),e.async=!1;for(var t,r=!1,o=n.defers,i=o.length,s=-1;++s<i;)t=o[s],t!==e?r=r||null!=t:o[s]=null;r===!1&&n.resolve()}}(),CompoProto={type:Dom.CONTROLLER,__resource:null,ID:null,tagName:null,compoName:null,nodes:null,components:null,expression:null,attr:null,model:null,slots:null,pipes:null,compos:null,events:null,hotkeys:null,async:!1,await:null,meta:{mode:null,modelMode:null,attributes:null,serializeNodes:null,handleAttributes:null},onRenderStart:null,onRenderEnd:null,render:null,renderStart:function(e,n,t){if(1===arguments.length&&null!=e&&e instanceof Array==!1&&null!=e[0]){var r=arguments[0];e=r[0],n=r[1],t=r[2]}if(compo_meta_executeAttributeHandler(this,e)!==!1&&(compo_ensureTemplate(this),is_Function(this.onRenderStart))){var o=this.onRenderStart(e,n,t);void 0!==o&&dfr_isBusy(o)&&compo_prepairAsync(o,this,n)}},renderEnd:function(e,n,t,r){if(1===arguments.length&&e instanceof Array==!1){var o=arguments[0];e=o[0],n=o[1],t=o[2],r=o[3]}Anchor.create(this,e),this.$=domLib(e),null!=this.events&&Events_.on(this,this.events),null!=this.compos&&Children_.select(this,this.compos),null!=this.hotkeys&&KeyboardHandler.hotkeys(this,this.hotkeys),is_Function(this.onRenderEnd)&&this.onRenderEnd(e,n,t,r)},appendTo:function(e){var n="string"==typeof e?document.querySelector(e):e;if(null==n)return log_warn("Compo.appendTo: parent is undefined. Args:",arguments),this;for(var t=this.$,r=0,o=t.length;o>r;r++)n.appendChild(t[r]);return this.emitIn("domInsert"),this},append:function(e,n,t){var r;if(null==this.$){var o="string"==typeof e?mask.compile(e):e;return r=t?find_findSingle(this,selector_parse(t,Dom.CONTROLLER,"down")):this,null==r.nodes?(this.nodes=o,this):(r.nodes=[this.nodes,o],this)}var i=mask.render(e,n,null,null,this);return r=t?this.$.find(t):this.$,r.append(i),this.emitIn("domInsert"),this},find:function(e){return find_findSingle(this,selector_parse(e,Dom.CONTROLLER,"down"))},findAll:function(e){return find_findAll(this,selector_parse(e,Dom.CONTROLLER,"down"))},closest:function(e){return find_findSingle(this,selector_parse(e,Dom.CONTROLLER,"up"))},on:function(){var e=_Array_slice.call(arguments);return arguments.length<3?(log_error("Invalid Arguments Exception @use .on(type,selector,fn)"),this):(null!=this.$&&Events_.on(this,[e]),null==this.events?this.events=[e]:is_Array(this.events)?this.events.push(e):this.events=[e,this.events],this)},remove:function(){return compo_removeElements(this),compo_detachChild(this),compo_dispose(this),this.$=null,this},slotState:function(e,n){return Compo.slot.toggle(this,e,n),this},signalState:function(e,n){return Compo.signal.toggle(this,e,n),this},emitOut:function(e){return Compo.signal.emitOut(this,e,this,arguments.length>1?_Array_slice.call(arguments,1):null),this},emitIn:function(e){return Compo.signal.emitIn(this,e,this,arguments.length>1?_Array_slice.call(arguments,1):null),this}},Compo.prototype=CompoProto}(),function(){var e,n;!function(){n=function(e,t,r,o,i){if(null==e)return!1;var s=!1,l=null!=e.slots&&e.slots[t];if("string"==typeof l&&(l=e[l]),"function"==typeof l){s=!0;var u=null!=e.slots.__disabled&&e.slots.__disabled[t];if(u!==!0){var a=null==o?l.call(e,r):l.apply(e,[r].concat(o));if(a===!1)return!0;null!=a&&"object"==typeof a&&null!=a.length&&(o=a)}}if(-1===i&&null!=e.parent)return n(e.parent,t,r,o,i)||s;if(1===i&&null!=e.components)for(var c,f=e.components,p=f.length,d=0;p>d;d++)c=n(f[d],t,r,o,i),!s&&(s=c);return s},e=function(n,t,r,o){if(null==n)return!1;var i=n.slots;if(null!=i&&null!=i[t]&&("string"==typeof i[t]&&(i[t]=n[i[t]]),"function"==typeof i[t])){if(o!==!0)return!0;if(null==i.__disabled||i.__disabled[t]!==!0)return!0}if(-1===r&&null!=n.parent)return e(n.parent,t,r);if(1===r&&null!=n.components)for(var s=0,l=n.components.length;l>s;s++)if(e(n.components[s],t,r))return!0;return!1}}();var t,r;!function(){function n(e,n,t){var r=e.slots;if(null!=r&&r.hasOwnProperty(n)!==!1){var o=r.__disabled;null==o&&(o=r.__disabled={}),o[n]=t===!1}}function o(e,t,r){n(e,t,r);var i=e.components;if(null!=i)for(var s=i.length,l=0;s>l;l++)o(i[l],t,r)}function i(e,n,t){return null==e.$?void log_warn("Controller has no elements to toggle state"):void domLib().add(e.$.filter("[data-signals]")).add(e.$.find("[data-signals]")).each(function(e,r){var o=r.getAttribute("data-signals");null!=o&&-1!==o.indexOf(n)&&r[t===!0?"removeAttribute":"setAttribute"]("disabled","disabled")})}t=function(e,t,r){for(var s=e,l=e;null!=(s=s.parent);)n(s,t,r),null!=s.$&&0!==s.$.length&&(l=s);o(e,t,r),i(l,t,r)},r=function(t,r,o){n(t,r,o),(o||!e(t,r,-1,!0)&&!e(t,r,1,!0))&&i(t,r,o)}}(),function(){function t(e,n){r(e,n||e)}function r(e,n){mask.registerAttrHandler("x-"+e,"client",function(e,t,r,i,s,l){o(s,l,t,n)})}function o(e,n,t,r){for(var o,s,l,u,a,c,f,p,d=t.split(";"),h="",m=d.length,v=-1;++v<m;)o=d[v].trim(),""!==o&&(a=c=f=null,s=o.indexOf(":"),-1!==s&&(a=o.substring(0,s),l=a.indexOf("("),-1!==l&&(c=a.substring(l+1,a.lastIndexOf(")")),a=a.substring(0,l)),o=o.substring(s+1).trim()),f=o,p=i(n,f),null==r?u=a:(u=r,c=a),u||log_error("Signal: Eventname is not set",d[v]),p?(h+=","+f+",",dom_addEventListener(e,u,p,c,n)):log_warn("Slot not found:",f));if(""!==h){var g=e.getAttribute("data-signals");e.setAttribute("data-signals",g+h)}}function i(t,r){return e(t,r,-1)===!1?null:function(e){var o=arguments.length>1?_Array_slice.call(arguments,1):null;n(t,r,e,o,-1)}}r("signal"),t("change"),t("click"),t("tap","click"),t("keypress"),t("keydown"),t("keyup"),t("mousedown"),t("mouseup"),t("press","keydown"),t("shortcut","keydown")}(),obj_extend(Compo,{signal:{toggle:t,emitOut:function(e,t,r,o){n(e,t,r,o,-1)},emitIn:function(e,t,r,o){n(e,t,r,o,1)},enable:function(e,n){t(e,n,!0)},disable:function(e,n){t(e,n,!1)}},slot:{toggle:r,enable:function(e,n){r(e,n,!0)},disable:function(e,n){r(e,n,!1)},invoke:function(e,n,t,r){var o=e.slots;return null==o||"function"!=typeof o[n]?(log_error("Slot not found",n,e),null):null==r?o[n].call(e,t):o[n].apply(e,[t].concat(r))}}})}();var DomLite;return function(e){function n(e,n,t){if(null==e)return t||e;for(var r=e.length,o=-1;++o<r;)n.call(t||e,e[o],o);return t||e}function t(e,n,t){if(null==e)return-1;for(var r=e.length,o=-1;++o<r;)if(n.call(t||e,e[o],o)===!0)return o;return-1}if(null!=e){Compo.DomLite=DomLite=function(e){return this instanceof DomLite==!1?new DomLite(e):this.add(e)},null==domLib&&(domLib=DomLite);var r=DomLite.fn={constructor:DomLite,length:0,add:function(e){if(null==e)return this;if(is_Array(e)===!0)return n(e,this.add,this);var t=e.nodeType;return 11===t?n(e.childNodes,this.add,this):null==t?"number"==typeof e.length?n(e,this.add,this):(log_warn("Uknown domlite object"),this):(this[this.length++]=e,this)},on:function(){return o.call(this,i,l,arguments)},off:function(){return o.call(this,s,u,arguments)},find:function(e){return n(this,function(n){this.add(c.call(n,e))},new DomLite)},filter:function(e){return n(this,function(n){f(n,e)===!0&&this.add(n)},new DomLite)},parent:function(){var e=this[0];return new DomLite(e&&e.parentNode)},children:function(e){var t=n(this,function(e){this.add(e.childNodes)},new DomLite);return null==e?t:t.filter(e)},closest:function(e){for(var n=this[0],t=new DomLite;null!=n&&null!=n.parentNode;)if(n=n.parentNode,f(n,e))return t.add(n);return t},remove:function(){return n(this,function(e){e.parentNode.removeChild(e)})}};!function(){function e(e,n,t){null!=e&&null!=t&&e.insertBefore(t,n)}function t(n,t,r){var o=null!=t?t.nextSibling:null;e(n,o,r)}var o={append:function(e,n){t(e,e.lastChild,n)},prepend:function(n,t){e(n,n.firstChild,t)},after:function(e,n){t(e.parentNode,e,n)},before:function(n,t){e(n.parentNode,n,t)}};n(["append","prepend","before","after"],function(e){var t=o[e];r[e]=function(e){var r=is_Array(e);return n(this,function(o){return r?void n(e,function(e){t(o,e)}):void t(o,e)})}})}();var o,i,s,l,u,a=e.documentElement,c=a.querySelectorAll,f=function(){var e=a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.matchesSelector;return function(n,t){return null==n||1!==n.nodeType?!1:e.call(n,t)}}();!function(){function e(e,t,r,o){return n(e,function(e){t.call(e,r,o,!1)})}o=function(e,t,r){var o,i=r.length;return 2===i&&(o=e),3===i&&(o=t),null!=o?n(this,function(e){o.apply(DomLite(e),r)}):(log_error("`DomLite.on|off` - invalid arguments count"),this)},i=function(n,r){return e(this,t,n,r)},s=function(n,t){return e(this,r,n,t)},l=function(e,n,t){function r(e){var r=e.target,o=e.currentTarget;if(o!==r)for(;null!=r&&r!==o;){if(f(r,n))return void t(e);r=r.parentNode}}return(t._guards||(t._guards=[])).push(r),i.call(this,e,r)},u=function(e,t,r){return n(r._quards,function(n){s.call(this,e,n)},this)};var t=a.addEventListener,r=a.removeEventListener}(),function(){var e=null!=a.classList,o=e===!0?function(e,n){return e.classList.contains(n)}:function(e,n){return-1!==(" "+e.className+" ").indexOf(" "+n+" ")};r.hasClass=function(e){return-1!==t(this,function(n){return o(n,e)})};var i;!function(){function e(e,n){e.className+=" "+n}function n(e,n){e.className=(" "+e.className+" ").replace(" "+n+" "," ")}i={add:function(n,t){o(n,t)===!1&&e(n,t)},remove:function(e,t){o(e,t)===!0&&n(e,t)},toggle:function(t,r){var i=o(t,r)===!0?n:e;i(t,r)}}}(),n(["add","remove","toggle"],function(t){var o=e===!1?i[t]:function(e,n){var r=e.classList;r[t].call(r,n)};r[t+"Class"]=function(e){return n(this,function(n){o(n,e)})}})}(),function(){var t=function(n){var t=e.createEvent("Event");return t.initEvent(n,!0,!0),t},o=function(n,r){if(null==r)return t(n);var o=e.createEvent("CustomEvent");return o.initCustomEvent(n,!0,!0,r),o},i=function(e,n){e.dispatchEvent(n)};r.trigger=function(e,t){var r=o(e,t);return n(this,function(e){i(e,r)})}}(),function(){r.attr=function(e,t){return void 0===t?this[0]&&this[0].getAttribute(e):n(this,function(n){n.setAttribute(e,t)})},r.removeAttr=function(e){return n(this,function(n){n.removeAttribute(e)})}}(),Object.setPrototypeOf?Object.setPrototypeOf(r,Array.prototype):r.__proto__&&(r.__proto__=Array.prototype),DomLite.prototype=r,domLib_initialize()}}(global.document),domLib_initialize(),mask.registerHandler(":slot",SlotHandler),SlotHandler.prototype={constructor:SlotHandler,renderEnd:function(){this.slots={},this.expression=this.attr.on,this.slots[this.attr.signal]=this.handle},handle:function(){var e=this.expression;mask.Utils.Expression.eval(e,this.model,global,this)}},Compo}(Mask),jmask=exports.jmask=Mask.jmask=function(e){function n(e){return"string"!=typeof e?e:u(e)}function t(e){return this instanceof t==!1?new t(e):null==e?this:e.type===i.SET?e:this.add(e)}var r,o,i=e.Dom,s=e.render,l=e.parse,u=e.Utils.ensureTmplFn,a=(e.Compo||Compo).signal.emitIn;!function(){r=function(e,n){if(is_ArrayLike(e)===!1)return void n(e);for(var t=e.length,r=-1;++r<t;)n(e[r],r)},function(){function e(e,t){return e===t?(n=!0,0):1}o=function(t){if(n=!1,t.sort(e),n===!1)return t;for(var r=[],o=0,i=0,s=t.length-1;s>o;)t[o++]===t[o]&&(r[i++]=o);for(;i--;)t.splice(r[i],1);return t};var n=!1}()}();var c,f;!function(){function e(e){return function(t){return n(t,e)}}function n(e,t,r){if("string"!=typeof e)return!1;if(null==r&&(r=0),r=e.indexOf(t,r),-1===r)return!1;if(r>0&&e.charCodeAt(r-1)>32)return n(e,t,r+1);var o=e.length,i=t.length;return o-i>r&&e.charCodeAt(r+i)>32?n(e,t,r+1):!0}function t(e,n,t){for(var r,o=!1,i=!1;t>n&&(r=e.charCodeAt(n),(34===r||39===r)&&(o=!o),92===r&&(i=!i),!(46===r||35===r||91===r||93===r||62===r||33>r)||o===!0||i===!0);)n++;return n}c=function(n,u,a){if(null==n&&log_error("selector is null for the type",u),"object"==typeof n)return n;var c,f,p,d,h,m,v,g,_,y,b,x=0,w=n.length;for(c="up"===a?r:u===i.SET?o:s;w>x;)h=n.charCodeAt(x),33>h?x++:62!==h?(m=t(n,x+1,w),46===h?(f="class",p=l,d=e(n.substring(x+1,m))):35===h?(f="id",p=l,d=n.substring(x+1,m)):91===h?(y=n.indexOf("=",x),p=l,f=n.substring(x+1,y),h=n.charCodeAt(y+1),b=34===h||39===h?2:1,d=n.substring(y+b,m-b+1),m++):(null!=v&&(v.next={type:"any",matcher:null},_=v,v=null),p=null,f=u===i.SET?"tagName":"compoName",d=n.substring(x,m)),x=m,null!=v?(null==v.filters&&(v.filters=[]),v.filters.push({key:f,selector:d,prop:p})):(v={key:f,prop:p,selector:d,nextKey:c,filters:null},null==g&&(g=v),null!=_&&(_.next.matcher=v))):(null==v?g=v={selector:"__scope__",nextKey:c,filters:null,next:{type:"children",matcher:null}}:v.next={type:"children",matcher:null},_=v,v=null,x++);return _&&_.next&&(_.next.matcher=v),g},f=function(e,n,t){if("string"==typeof n&&(null==t&&(t=i[e.compoName?"CONTROLLER":"SET"]),n=c(n,t)),"*"===n.selector)return!0;var r=n.prop?e[n.prop]:e,o=!1;if(null==r)return!1;if("function"==typeof n.selector?o=n.selector(r[n.key]):null!=n.selector.test?n.selector.test(r[n.key])&&(o=!0):r[n.key]===n.selector&&(o=!0),o===!0&&null!=n.filters)for(var s,l=0,u=n.filters.length;u>l;l++)if(s=n.filters[l],f(e,s,t)===!1)return!1;return o};var r="parent",o="nodes",s="components",l="attr"}();var p,d,h,m,v;!function(){p=function(e,n){if(null==n)return e;var t=[];return r(e,function(e){f(e,n)&&t.push(e)}),t},d=function(e,n,t,o){return null==e?t:(null==t&&(t=[]),null==o&&("__scope__"===n.selector?(o=!1,n=n.next.matcher):o=!0),r(e,function(e){if(f(e,n)===!1)return void(null==n.next&&o!==!1&&d(e[n.nextKey],n,t,o));if(null==n.next)return t.push(e),void(o===!0&&d(e[n.nextKey],n,t,o));var r=n.next;o="children"!==r.type,d(e[n.nextKey],r.matcher,t,o)}),t)},h=function(e,n){var t={type:1,tagName:1,compoName:1,controller:1},r={parent:n};for(var o in e)1===t[o]&&(r[o]=e[o]);null!=e.attr&&(r.attr=obj_create(e.attr));var i=e.nodes;if(null!=i&&i.length>0)if(is_ArrayLike(i)===!1)r.nodes=[h(i,r)];else{r.nodes=[];for(var s=i.length,l=0;s>l;l++)r.nodes[l]=h(i[l],r)}return r},m=function(e){for(var n,t=e;null!=t;)n=t,t=t.nodes&&t.nodes[0];return n},v=function(e,n,t,r){if(i.TEXTNODE===e.type)return is_Function(e.content)?e.content("node",n,t,null,r):e.content;var o="";if(null!=e.nodes)for(var s,l=0,u=e.nodes.length;u>l;l++)s=e.nodes[l],o+=v(s,n,t,r);return o}}();var g=t.prototype={constructor:t,type:i.SET,length:0,components:null,add:function(e){var n,t;if("string"==typeof e&&(e=l(e)),is_ArrayLike(e)){for(n=0,t=e.length;t>n;n++)this.add(e[n]);return this}"function"==typeof e&&null!=e.prototype.type&&(e={controller:e,type:i.COMPONENT});var r=e.type;if(!r)return console.error("Only Mask Node/Component/NodeText/Fragment can be added to jmask set",e),this;if(r===i.FRAGMENT){var o=e.nodes;for(n=0,t=o.length;t>n;)this[this.length++]=o[n++];return this}if(r===i.CONTROLLER){if(null!=e.nodes&&e.nodes.length)for(n=e.nodes.length;0!==n;)e.nodes[--n].parent=e;null!=e.$&&(this.type=i.CONTROLLER)}return this[this.length++]=e,this},toArray:function(){return Array.prototype.slice.call(this)},render:function(e,n,t,r){if(this.components=[],1===this.length)return s(this[0],e,n,t,r||this);null==t&&(t=document.createDocumentFragment());for(var o=0,i=this.length;i>o;o++)s(this[o],e,n,t,r||this);return t},prevObject:null,end:function(){return this.prevObject||this},pushStack:function(e){var n;return n=t(e),n.prevObject=this,n},controllers:function(){return null==this.components&&console.warn("Set was not rendered"),this.pushStack(this.components||[])},mask:function(n){var t;if(null!=n)return this.empty().append(n);if(arguments.length)return this;if(0===this.length)t=new i.Node;else if(1===this.length)t=this[0];else{t=new i.Fragment,t.nodes=[];for(var r=-1;++r<this.length;)t.nodes[r]=this[r]}return e.stringify(t)},text:function(e,n,t){if("string"==typeof e&&1===arguments.length){for(var r,o=[new i.TextNode(e)],s=0,l=this.length;l>s;s++)r=this[s],r.nodes=o;return this}for(var r,u="",s=0,l=this.length;l>s;s++)r=this[s],u+=v(r,e,n,t);return u}};return arr_each(["append","prepend"],function(e){t.prototype[e]=function(n){for(var r,o,i=t(n),s=0,l=this.length;l>s;s++){o=this[s],r=i.toArray();for(var u=0,a=r.length;a>u;u++)r[u].parent=o;o.nodes=null!=o.nodes?"append"===e?o.nodes.concat(r):r.concat(o.nodes):r}return this}}),arr_each(["appendTo"],function(e){t.prototype[e]=function(e,n,r,o){return null==o&&(o=this),null!=e.nodeType&&"function"==typeof e.appendChild?(e.appendChild(this.render(n,r,null,o)),a(o,"domInsert"),this):(t(e).append(this),this)}}),function(){function e(e,n,t){e[n]=t}function t(e){var n={};return e.split(";").forEach(function(e){if(""!==e){var t=e.indexOf(":"),r=e.substring(0,t).trim(),o=e.substring(t+1).trim();n[r]=o}}),n}function r(e){var n,t="";for(n in e)t+=n+":"+e[n]+";";return t}function o(e,n){return e+":"+n+";"}g.removeAttr=g.removeProp=function(e){return coll_each(this,function(n){n.attr[e]=null})},g.attr=g.prop=function(e,t){function r(e,t,r){e.attr[t]=n(r)}function o(e,n){for(var t in n)r(e,t,n[t])}if(1===arguments.length)return this.length>0?this[0].attr[e]:null;var i=is_String(e)?r:o;return coll_each(this,function(n){i(n,e,t)})},g.tag=function(e){return 0===arguments.length?this[0]&&this[0].tagName:coll_each(this,function(n){n.tagName=e})},g.css=function(n,i){if(arguments.length<=1&&"string"==typeof n){if(null==this.length)return null;
var s=this[0].attr.style;if(null==s)return null;var l=t(s);return null==n?l:l[n]}if(null==n)return this;var u="object"==typeof n?r:o,a="object"==typeof n?obj_extend:e;return coll_each(this,function(e){var o=e.attr.style;if(null==o)return void(e.attr.style=u(n,i));var s=t(o);a(s,n,i),e.attr.style=r(s)})}}(),function(){function e(e){var n=e.attr["class"];return"string"==typeof n?n:""}function n(n,t){return-1!==(" "+e(n)+" ").indexOf(" "+t+" ")}function t(n,t){n.attr["class"]=(e(n)+" "+t).trim()}function r(n,t){n.attr["class"]=(" "+e(n)+" ").replace(" "+t+" ","").trim()}g.hasClass=function(e){return coll_find(this,function(t){return n(t,e)})};var o={add:function(e,r){n(e,r)===!1&&t(e,r)},remove:function(e,t){n(e,t)===!0&&r(e,t)},toggle:function(e,o){var i=n(e,o)===!0?r:t;i(e,o)}};arr_each(["add","remove","toggle"],function(e){var n=o[e];g[e+"Class"]=function(e){return coll_each(this,function(t){n(t,e)})}})}(),obj_extend(t.prototype,{clone:function(){return t(coll_map(this,h))},wrap:function(e){var n=t(e);if(0===n.length)return log_warn("Not valid wrapper",e),this;var r=coll_map(this,function(e){var t=n.clone()[0];if(m(t).nodes=[e],null!=e.parent){var r=coll_indexOf(e.parent.nodes,e);-1!==r&&e.parent.nodes.splice(r,1,t)}return t});return t(r)},wrapAll:function(e){var n=t(e);return 0===n.length?(log_error("Not valid wrapper",e),this):(this.parent().mask(n),m(n[0]).nodes=this.toArray(),this.pushStack(n))}}),arr_each(["empty","remove"],function(e){t.prototype[e]=function(){return coll_each(this,n[e])};var n={remove:function(e){null!=e.parent&&coll_remove(e.parent.nodes,e)},empty:function(e){e.nodes=null}}}),obj_extend(t.prototype,{each:function(e,n){for(var t=0;t<this.length;t++)e.call(n||this,this[t],t);return this},eq:function(e){return-1===e?this.slice(e):this.slice(e,e+1)},get:function(e){return 0>e?this[this.length-e]:this[e]},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments))}}),arr_each(["filter","children","closest","parent","find","first","last"],function(e){t.prototype[e]=function(n){var r,s,l=[],u=null==n?null:c(n,this.type,"closest"===e?"up":"down");switch(e){case"filter":return t(p(this,u));case"children":for(r=0;r<this.length;r++)s=this[r],null!=s.nodes&&(l=l.concat(null==u?s.nodes:p(s.nodes,u)));break;case"parent":for(r=0;r<this.length;r++)s=this[r].parent,!s||s.type===i.FRAGMENT||u&&f(s,u)||l.push(s);o(l);break;case"closest":case"find":if(null==u)break;for(r=0;r<this.length;r++)d(this[r][u.nextKey],u,l);break;case"first":case"last":var a;for(r=0;r<this.length;r++)if(a="first"===e?r:this.length-r-1,s=this[a],null==u||f(s,u)){l[0]=s;break}}return this.pushStack(l)}}),t}(Mask);return function(e,n){function t(e){return e.parentNode.removeChild(e)}function r(e){if(null!=e)for(var n=e.length,r=-1;++r<n;)t(e[r])}function o(e,n){return n.parentNode.insertBefore(e,n.nextSibling)}function i(e,n){return n.parentNode.insertBefore(e,n)}function s(){}function l(){}function u(){}function a(e,n){if(null==n&&(n=[]),null==e.components)return n;for(var t,r=e.components,o=0,i=r.length;i>o;o++)t=r[o],"validate"!==t.compoName?a(t):n.push(t);return n}var c,f,p,d,h,m,v,g,_=!1,y="undefined"!=typeof n?n:e.Compo||global.Compo,b=y.Dom.addEventListener,x=e.registerHandler,w=e.registerAttrHandler,k=e.registerUtil,C=y.config.getDOMLibrary();!function(){function e(e,n){for(var t,r=-1,o=n.length-1;++r<o;)t=n[r],null==e[t]&&(e[t]={}),e=e[t];return e}function n(e){return null==e||"object"!=typeof e?null:"number"==typeof e.length&&"function"==typeof e.slice?C.Array:"function"==typeof e.toUTCString?C.Date:null}function t(t,o,s,l){var u=l.length,c=u>1?e(t,l):t,f=l[u-1],p=c[f];if(u>1&&r(t,l),"length"===f){var d=n(c);if(null!=d)return a(c,d,function(){for(var e=s.length,n=-1;++n<e;)s[n].apply(null,arguments)}),p}return k(c,f,{get:function(){return p},set:function(e){if(e!==p){var r=p;p=e;var l=0,u=s.length,c=n(e);if(null!=c)for(;u>l;l++)a(e,c,s[l]);if(null!=t[y][w])return void(t[y][w][o]=1);for(l=0;u>l;l++)s[l](e);i(t,o,r)}},configurable:!0,enumerable:!0}),p}function r(e,n){for(var t,r=s(e),i="",l=n.length-1,u=0;l>u;u++)t=n[u],i+=t+".",o(i,e,t,r),e=e[t]}function o(e,n,t,r){var o,i=n[t];k(n,t,{get:function(){return i},set:function(n){n!==i&&(o=i,i=n,r(e,o))},configurable:!0,enumerable:!0})}function i(e,n,t){var r=e[y];if(null!=r)for(var o in r)if(0===o.indexOf(n+".")){var i,s,l=r[o].slice(0),u=l.length,a=0;if(0!==u){var f=obj_getProperty(e,o);for(a=0;u>a;a++)s=l[a],p(e,o,s),null!=t&&"object"==typeof t&&(i=o.substring(n.length+1),p(t,i,s));for(a=0;u>a;a++)l[a](f);for(a=0;u>a;a++)c(e,o,l[a])}}}function s(e){return function(n,t){l(e,n,t)}}function l(e,n,t){var r=e[y];if(null!=r)for(var o in r)if(0===o.indexOf(n)){var i=r[o].slice(0),s=i.length,l=0;if(0!==s){var u,a,f=obj_getProperty(e,o);for(l=0;s>l;l++)u=i[l],p(e,o,u),null!=t&&"object"==typeof t&&(a=o.substring(n.length),p(t,a,u));for(l=0;s>l;l++)i[l](f);for(l=0;s>l;l++)c(e,o,i[l])}}}function u(e,n,t){var r=m(e,n);return arr_contains(r,t)===!1&&r.push(t),r}c=function(e,r,o){for(var i=r.split("."),s=i.length,l=-1,c=e;++l<s&&(c=c[i[l]],null!=c);)if(null!=c[y]){var f=i.slice(l+1).join(".");if(null!=c[y][f]){u(c,f,o);var p=u(e,r,o);if(1===p.length){var d=i.splice(0,l);0!==d.length&&t(e,r,p,d,!0)}return}}var p=u(e,r,o);1===p.length&&t(e,r,p,i,!0);var h=obj_getProperty(e,r),m=n(h);null!=m&&a(h,m,o)},f=function(e,n,t){for(var r=n.split("."),o=r.length,i=-1,s=e;++i<o&&(s=s[r[i]],null!=s);)if(null!=s[y]){if(f(s,r.slice(i).join("."),t))return!0;break}var l=e[y];return null==l||null==l[n]?!1:arr_contains(l[n],t)},p=function(e,t,r){for(var o=t.split("."),i=o.length,s=-1,l=e;++s<i&&(l=l[o[s]],null!=l);)if(null!=l[y]){p(l,o.slice(s).join("."),r);break}var u=m(e,t),a=obj_getProperty(e,t);void 0===r?u.length=0:arr_remove(u,r);var c=n(a);null!=c&&_(a,c,r)},d=function(e){var n=e[y];null!=n&&(n[w]={})},h=function(e){var n=e[y],t=null==n?null:n[w];if(null!=t){n[w]=null;var r,o,i,s,l;for(r in t)if(o=e[y][r],s=null==o?0:o.length,0!==s)for(l=-1,i=r===b?e:obj_getProperty(e,r);++l<s;)o[l](i)}},m=function(e,n){var t=e[y];if(null==t&&(t={__dirty:null,__dfrTimeout:null,__mutators:null},k(e,"__observers",{value:t,enumerable:!1})),null==n)return t;var r=t[n];return null==r?t[n]=[]:r},v=function(e,t){var r=n(e);null!=r&&a(e,r,t)},g=function(e,n){_(e,null,n)};var a,_,y="__observers",b="__mutators",x="__dfrTimeout",w="__dirty",k=Object.defineProperty,C={Array:{throttle:!1,methods:["push","unshift","splice","pop","shift","reverse","sort","remove"]},Date:{throttle:!0,methods:["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds"]}};!function(){function e(e,r,o,i){var s=i===!0?t:n;return function(){return s(e,r,o,_Array_slice.call(arguments))}}function n(e,n,t,o){var i=m(e,b),s=n.apply(e,o);return r(e,i,t,o,s),s}function t(e,n,t,o){var i=m(e,b),s=n.apply(e,o),l=e[y];return null!=l[x]?s:(l[x]=setTimeout(function(){l[x]=null,r(e,i,t,o,s)}),s)}function r(e,n,t,r,o){if(0!==n.length){var i=e[y];if(null!=i[w])return void(i[w][b]=1);for(var s,l=n.length,u=-1;++u<l;)s=n[u],"function"==typeof s&&s(e,t,r,o)}}a=function(n,t,r){var o=t.methods,i=t.throttle,s=m(n,b);if(0===s.length)for(var l,u,a=o.length,c=-1;++c<a;)l=o[c],u=n[l],null!=u&&(n[l]=e(n,u,l,i));s[s.length++]=r},_=function(e,n,t){var r=m(e,b);return void 0===t?void(r.length=0):void arr_remove(r,t)}}()}();var A;!function(){A=function(e){return null==e||""===e?null:("string"==typeof e&&(e=new Date(e)),isNaN(e)===!1&&"function"==typeof e.getFullYear?e:null)}}();var N,E,j,O,S;!function(){N=function(e,n,t,r){if(null==e.components)return o(t,r||e.placeholder);var s,l=e.components,u=null,a=!0,c=l.length,f=n-1;if(null==u)for(;++f<c;)if(s=l[f].elements,s&&s.length){u=s[0];break}if(null==u)for(a=!1,f=c>n?n:c;--f>-1;)if(s=l[f].elements,s&&s.length){u=s[s.length-1];break}return null==u&&(u=r||e.placeholder),a?i(t,u):o(t,u)},E=function(n,t,r,o,i){return e.render(t,r,o,i,n)},j=function(e,n){if(null==e)return!1;null!=e.elements&&(r(e.elements),e.elements=null),y.dispose(e);var t=n&&n.components||e.parent&&e.parent.components;return null==t?(log_error("Parent Components Collection is undefined"),!1):arr_remove(t,e)},O=function(e){y.signal.emitIn(e,"domInsert")},S=function(e,n){if("function"==typeof e.dispose){var t=e.dispose;return void(e.dispose=function(){n.call(this),t.call(this)})}e.dispose=n}}();var T,D,L,M,P,F,U,$;!function(){function n(e,n,i,s,l){if(null!=s){if("object"==typeof s){var u=D(s.accessor,n,null,i);return null==u||"object"!=typeof u?void console.error("Binding failed to an object over accessor",s.ref):void e(u,s.ref,l)}var a=s,c=a.split("."),f=c.length;if(f>1){var p=c[0];if("$c"===p)return i=r(i,c.slice(1),f-1),void e(i,a.substring(3),l);if("$a"===p||"$ctx"===p)return}var u=null;o(n,c,f)&&(u=n),null==u&&(u=t(i,c,f)),null==u&&(u=n),e(u,a,l)}}function t(e,n,t){for(var r;null!=e;){if(r=e.scope,null!=r&&o(r,n,t))return r;e=e.parent}return null}function r(e,n,t){for(;null!=e;){if(o(e,n,t))return e;e=e.parent}return e}function o(e,n,t){if(null==e)return!1;for(var r=0;t>r;r++)if(e=e[n[r]],null==e)return!1;return!0}var i=e.Utils.Expression;D=i.eval,U=i.parse,$=i.varRefs,T=function(e,n,t,r){if("."===e)return n;var o=D(e,n,t,r);return null==o?"":o},L=function(e,t,r,o,i){if("."===e)return void v(t,i);var s=U(e),l=$(s,t,r,o);if(null!=l){if("string"==typeof l)return void n(c,t,o,l,i);for(var u,a=null!=l.length&&"function"==typeof l.splice,f=a===!0?l.length:1,p=0;f>p;p++)u=a===!0?l[p]:l,n(c,t,o,u,i)}},M=function(e,t,r,o){if("function"==typeof r&&log_warn("[mask.binding] - expression unbind(expr, model, controller, callback)"),"."===e)return void g(t,o);var i,s=$(e,t,null,r);if(null!=s){if("string"==typeof s)return void n(p,t,r,s,o);for(var i,l=null!=s.length&&"function"==typeof s.splice,u=l===!0?s.length:1,a=0;u>a;a++)i=l===!0?s[a]:s,n(p,t,r,i,o)}},P=function(e,n,t,r,o){var i=0;return function(){if(++i>1)return i=0,void log_warn("<mask:bind:expression> Concurent binder detected",e);var s=T(e,n,t,r);if(arguments.length>1){var l=_Array_slice.call(arguments);l[0]=s,o.apply(this,l)}else o(s);i--}},F=function(e){var n=0;return function(){return++n>1?(n=0,void log_warn("<listener:expression> concurent binder")):(e(),void n--)}}}();var R,I;!function(){R=function(e,n,t){for(var r,o,i,s,l=e.split(";"),u=[],a=0,c=l.length;c>a;a++)r=l[a].split(":"),1===r.length||2===r.length?(i=2===r.length?r[0]:t,o=r[2===r.length?1:0],s=I(o.trim(),i,n),null!=s&&u.push(s)):log_error('Too much ":" in a signal def.',l[a]);return u},I=function(e,n,t){if(t!==!0)return{signal:e,type:n};var r=e.indexOf(".");return-1===r?(log_error("No pipe name in a signal",e),null):{signal:e.substring(r+1),pipe:e.substring(0,r),type:n}}}();var H;!function(){function e(e,n,t){return null==e||"function"!=typeof e[n]?(log_error("BindingProvider.",t,"should be a function. Property:",n),!1):!0}function n(e,n){var t=e.ctr.parent;if(null!=t[n])return t;var r=e.model;return null!=r[n]?r:(log_error("BindingProvider. Accessor `",n,"`should be a function"),null)}function t(e){var n=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return n+"-"+(10>t?"0":"")+t+"-"+(10>r?"0":"")+r}function r(e){var n=e.getHours(),t=e.getMinutes();return n+":"+(10>t?"0":"")+t}var o={get:function(e,t){var r=e.objGetter;if(null==r)return T(t,e.model,e.ctx,e.ctr);var o=n(e,r);return null==o?null:o[r](t,e.model,e.ctr.parent)},set:function(e,t,r,o){var i=o.objSetter;if(null==i)return void obj_setProperty(e,t,r);var s=n(o,i);null!=s&&s[i](t,r,o.model,o.ctr.parent)}},i={get:function(n){var t=n.domGetter;if(null==t)return obj_getProperty(n,n.property);var r=n.ctr.parent;return e(r,t,"Getter")===!1?null:r[t](n.element)},set:function(n,t){var r=n.domSetter;if(null==r)return void obj_setProperty(n,n.property,t);var o=n.ctr.parent;e(o,r,"Setter")!==!1&&o[r](t,n.element)}},s={domSet:function(e){return function(n,t){var r=A(t);n.element.value=null==r?"":e(r)}},objSet:function(e){return function(n,t,r){var o=A(r);if(null!=o){var i=A(obj_getProperty(n,t));return null==i?void obj_setProperty(n,t,o):void e(i,o)}}}};H={objectWay:o,domWay:i,SELECT:{get:function(e){var n=e.element,t=n.selectedIndex;if(-1===t)return"";var r=n.options[t],o=r.getAttribute("value");return null==o?r.getAttribute("name"):o},set:function(e,n){var t,r,o,i=e.element,s=i.options,l=s.length;for(o=0;l>o;o++)if(t=s[o],r=t.getAttribute("value"),null==r&&(r=t.getAttribute("name")),r==n)return void(i.selectedIndex=o);log_warn("Value is not an option",n)}},DATE:{domWay:{get:i.get,set:function(e,n){var r=A(n);e.element.value=null==r?"":t(r)}},objectWay:{get:o.get,set:s.objSet(function(e,n){e.setFullYear(n.getFullYear()),e.setMonth(n.getMonth()),e.setDate(n.getDate())})}},TIME:{domWay:{get:i.get,set:s.domSet(r)},objectWay:{get:o.get,set:s.objSet(function(e,n){e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(n.getSeconds())})}}}}();var z={};e.registerBinding=function(e,n){z[e]=n};var B;!function(){function n(e){var n=e.expression,t=e.model,r=e.objectChanged=e.objectChanged.bind(e);if(e.binder=P(n,t,e.ctx,e.ctr,r),L(n,t,e.ctx,e.ctr,e.binder),"dual"===e.bindingType){var o=e.ctr.attr;if(!o["change-slot"]&&!o["change-pipe-event"]){var i=e.element,s=o["change-event"]||o.changeEvent||"change",l=e.domChanged.bind(e);b(i,s,l)}if(!e.objectWay.get(e,e.expression))return setTimeout(function(){e.domWay.get(e)&&e.domChanged()}),e}return e.objectChanged(),e}function t(e,n,r){if(null!=e){var o=e.slots;(null==o||"function"!=typeof o[n]||o[n].apply(e,r)!==!1)&&t(e.parent,n,r)}}e.BindingProvider=B=function(e,n,t,r){null==r&&(r=":bind"===t.compoName?"single":"dual");var o,i=t.attr;if(this.node=t,this.ctr=t,this.ctx=null,this.model=e,this.element=n,this.value=i.value,this.property=i.property,this.domSetter=i.setter||i["dom-setter"],this.domGetter=i.getter||i["dom-getter"],this.objSetter=i["obj-setter"],this.objGetter=i["obj-getter"],this["typeof"]=i["typeof"]||null,this.dismiss=0,this.bindingType=r,this.log=!1,this.signal_domChanged=null,this.signal_objectChanged=null,this.locked=!1,null==this.property&&null==this.domGetter)switch(n.tagName){case"INPUT":if(o=n.getAttribute("type"),"checkbox"===o){this.property="element.checked";break}if("date"===o){var s=H.DATE;this.domWay=s.domWay,this.objectWay=s.objectWay}"number"===o&&(this["typeof"]="Number"),this.property="element.value";break;case"TEXTAREA":this.property="element.value";break;case"SELECT":this.domWay=H.SELECT;break;default:this.property="element.innerHTML"}if(i.log&&(this.log=!0,"log"!==i.log&&(this.logExpression=i.log)),i["x-signal"]){var l=R(i["x-signal"],null,"dom")[0],u=l&&l.type;switch(u){case"dom":case"object":this["signal_"+u+"Changed"]=l.signal;break;default:log_error("Signal typs is not supported",l)}}if(i["x-pipe-signal"]){var l=R(i["x-pipe-signal"],!0,"dom")[0],u=l&&l.type;switch(u){case"dom":case"object":this["pipe_"+u+"Changed"]=l;break;default:log_error("Pipe type is not supported")}}if(i["dom-slot"]){this.slots={};var a=t.parent,c=a.parent;a.parent=this,this.parent=c,this.slots[i["dom-slot"]]=function(e,n){this.domChanged(e,n)}}var f=i["object-pipe-slot"]||i["x-pipe-slot"];if(f){var p=f,d=p.indexOf("."),h=p.substring(0,d),l=p.substring(d+1);this.pipes={},this.pipes[h]={},this.pipes[h][l]=function(){this.objectChanged()},y.pipe.addController(this)}if(i.expression){if(this.expression=i.expression,null==this.value&&"single"!==r){var m=$(this.expression);"string"==typeof m?this.value=m:log_warn("Please set value attribute in DualBind Control.")}}else this.expression=this.value},B.create=function(e,n,t,r){var o,i=t.attr.bindingProvider,s=null==i?null:z[i];return"function"==typeof s?new s(e,n,t,r):(o=new B(e,n,t,r),null!=s&&obj_extend(o,s),o)},B.bind=function(e){return n(e)},B.prototype={constructor:B,dispose:function(){M(this.expression,this.model,this.ctr,this.binder)},objectChanged:function(e){if(!(this.dismiss-->0)){if(this.locked===!0)return void log_warn("Concurance change detected",this);if(this.locked=!0,null==e&&(e=this.objectWay.get(this,this.expression)),this.domWay.set(this,e),this.log&&console.log("[BindingProvider] objectChanged -",e),this.signal_objectChanged&&t(this.ctr,this.signal_objectChanged,[e]),this.pipe_objectChanged){var n=this.pipe_objectChanged;y.pipe(n.pipe).emit(n.signal)}this.locked=!1}},domChanged:function(e,n){if(this.locked===!0)return void log_warn("Concurance change detected",this);this.locked=!0,null==n&&(n=this.domWay.get(this));var r=this["typeof"];if(null!=r){var o=window[r];n=o(n)}var i=!0,s=this.ctr.validations;if(s)for(var l,u=s.length,a=-1;++a<u;)if(l=s[a],l.validate(n,this.element,this.objectChanged.bind(this))===!1){i=!1;break}if(i&&(this.dismiss=1,this.objectWay.set(this.model,this.value,n,this),this.dismiss=0,this.log&&console.log("[BindingProvider] domChanged -",n),this.signal_domChanged&&t(this.ctr,this.signal_domChanged,[n]),this.pipe_domChanged)){var c=this.pipe_domChanged;y.pipe(c.pipe).emit(c.signal)}this.locked=!1},objectWay:H.objectWay,domWay:H.domWay},obj_extend(B,{addObserver:c,removeObserver:p})}(),x(":visible",s),s.prototype={constructor:s,refresh:function(e,n){n.style.display=T(this.attr.check,e)?"":"none"},renderStart:function(e,n,t){this.refresh(e,t),this.attr.bind&&c(e,this.attr.bind,this.refresh.bind(this,e,t))}},function(){function e(){}x(":bind",e),e.prototype={constructor:e,renderEnd:function(e,n,t,r){this.provider=B.create(n,r,this,"single"),B.bind(this.provider)},dispose:function(){this.provider&&"function"==typeof this.provider.dispose&&this.provider.dispose()}}}(),x(":dualbind",l),l.prototype={constructor:l,renderEnd:function(n,t,r,o){if(this.provider=B.create(t,o,this),this.components)for(var i,s=0,l=this.components.length;l>s;s++)i=this.components[s],":validate"===i.compoName&&(this.validations||(this.validations=[])).push(i);if(!this.attr["no-validation"]&&!this.validations){var u=t.Validate,a=this.provider.value;if(null==u&&-1!==a.indexOf(".")){for(var c=a.split("."),s=0,f=c.length,p=t[c[0]];null==u&&++s<f&&p;)u=p.Validate,p=p[c[s]];a=c.slice(s).join(".")}var d=u&&u[a];"function"==typeof d&&(d=e.getHandler(":validate").createCustom(o,d),(this.validations||(this.validations=[])).push(d))}B.bind(this.provider)},dispose:function(){this.provider&&"function"==typeof this.provider.dispose&&this.provider.dispose()},handlers:{attr:{"x-signal":function(){}}}},function(){function t(){}function r(e,n){this.fn=e,this.message=n}function o(e,n,t){log_warn("Validate Notification:",e,n);var r=C(e).next("."+s);return 0===r.length&&(r=C("<div>").addClass(s).html("<span></span><button>cancel</button>").insertAfter(e)),r.children("button").off().on("click",function(){r.hide(),t&&t()}).end().children("span").text(n).end().show()}function i(e){return C(e).next("."+s).hide()}var s="-validate-invalid";e.registerValidator=function(e,n){l[e]=n},x(":validate",t),t.prototype={constructor:t,attr:{},renderStart:function(e,n,o){if(this.element=o,this.attr.value){var i=t.resolveFromModel(e,this.attr.value);i&&(this.validators=[new r(i)])}},validate:function(e,n,t){null==n&&(n=this.element),this.attr&&(null==e&&this.attr.getter&&(e=obj_getProperty({node:this,element:n},this.attr.getter)),null==e&&this.attr.value&&(e=obj_getProperty(this.model,this.attr.value))),null==this.validators&&this.initValidators();for(var r,o=0,i=this.validators.length;i>o;o++)if(r=this.validators[o].validate(e),r&&!this.attr.silent)return this.notifyInvalid(n,r,t),!1;return this.makeValid(n),!0},notifyInvalid:function(e,n,t){return o(e,n,t)},makeValid:function(e){return i(e)},initValidators:function(){this.validators=[];for(var e in this.attr){switch(e){case"message":case"value":case"getter":continue}if(e in l!=!1){var n=l[e];this.validators.push(new r(n(this.attr[e],this),this.attr.message))}else log_error("Unknown Validator:",e,this)}}},t.resolveFromModel=function(e,n){return obj_getProperty(e.Validate,n)},t.createCustom=function(e,n){var o=new t;return o.element=e,o.validators=[new r(n)],o},r.prototype.validate=function(e){var n=this.fn(e);return n===!1?this.message||"Invalid - "+e:n},x(":validate:message",n({template:"div."+s+' { span > "~[bind:message]" button > "~[cancel]" }',onRenderStart:function(e){"string"==typeof e&&(e={message:e}),e.cancel||(e.cancel="cancel"),this.model=e},compos:{button:"$: button"},show:function(e,n){var t=this;this.model.message=e,this.compos.button.off().on(function(){t.hide(),n&&n()}),this.$.show()},hide:function(){this.$.hide()}}));var l={match:function(e){return function(n){return new RegExp(e).test(n)}},unmatch:function(e){return function(n){return!new RegExp(e).test(n)}},minLength:function(e){return function(n){return n.length>=parseInt(e,10)}},maxLength:function(e){return function(n){return n.length<=parseInt(e,10)}},check:function(e,n){return function(t){return T("x"+e,n.model,{x:t},n)}}}}(),x(":validate:group",u),u.prototype={constructor:u,validate:function(){for(var e,n=a(this),t=0,r=n.length;r>t;t++)if(e=n[t],!e.validate())return!1;return!0}},function(){function e(e,n,t){return e?null==n||""===n?e+" "+t:e.replace(n,t):t}function n(e){return function(n){e.textContent=n}}function t(n,t,r){return function(o){var i=n.getAttribute(t),s=e(i,r,o);n.setAttribute(t,s),r=o}}function r(n,t,r){return function(o){switch(typeof n[t]){case"boolean":return void(r=n[t]=!!o);case"number":return void(r=n[t]=Number(o));case"string":return void(r=n[t]=e(n[t],r,o));default:return void log_warn("Unsupported elements property type",t)}}}function o(e,o,i,s,l){if("node"===e)return n(i);if("attr"===e){switch(l){case"value":case"disabled":case"checked":case"selected":case"selectedIndex":return r(i,l,s)}return t(i,l,s)}throw Error("Unexpected binder type: "+e)}function i(e,n,t,r,i,s,l,u){var a=o(u,n,i,e,l),c=P(n,t,r,s,a);L(n,t,r,s,c),S(s,function(){M(n,t,s,c)})}k("bind",{mode:"partial",current:null,element:null,nodeRenderStart:function(e,n,t,r,o){var i=T(e,n,t,o);return this.element=document.createTextNode(i),this.current=i},node:function(e,n,t,r,o){return i(this.current,e,n,t,this.element,o,null,"node"),this.element},attrRenderStart:function(e,n,t,r,o){return this.current=T(e,n,t,o)},attr:function(e,n,t,r,o,s){return i(this.current,e,n,t,r,o,s,"attr"),this.current}})}(),w("xx-visible",function(e,n,t,r,o,i){var s=P(n,t,r,i,function(e){o.style.display=e?"":"none"});L(n,t,r,i,s),S(i,function(){M(n,t,i,s)}),T(n,t,r,i)||(o.style.display="none")}),w("x-toggle","client",function(e,n,t,r,o,i){var s=n.substring(0,n.indexOf(":")),l=n.substring(s.length+1),u=$(l);"string"!=typeof u&&(u=u[0]),b(o,s,function(){var e=T(l,t,r,i);obj_setProperty(t,u,e)})}),w("x-class-toggle","client",function(e,n,t,r,o){var i=n.substring(0,n.indexOf(":")),s=n.substring(i.length+1).trim();b(o,i,function(){C(o).toggleClass(s)})}),function(){var t,o,s,l,u,a=e.getStatement();!function(){t=function(e,n,t,r,o){return a[e].getNodes(n,t,r,o)},o=function(e,n,t,r,o){if(null==e)return null;var i=[];return builder_build(e,n,t,r,o,i),i},s=function(e,n){e.placeholder=document.createComment(""),n.appendChild(e.placeholder)},l=function(e,n,t,r,o,i){e.parent=i,e.model=t,e.refresh=fn_proxy(e.refresh,e),e.binder=P(e.expr||e.expression,t,r,i,e.refresh),L(e.expr||e.expression,t,r,i,e.binder)},u=function(e,n){if(null!=e)for(var t,r="function"==typeof e.splice,o=r?e.length:1,i=-1;++i<o;)t=r?e[i]:e,t.style.display=n?"":"none"}}(),function(){function n(){}function r(e,n,t,r,o,i,s,l){for(e.model=o,e.ctx=i,e.controller=l,e.refresh=fn_proxy(e.refresh,e),e.binder=F(e.refresh),e.index=t,e.Switch=[{node:n,elements:null}],L(n.expression,o,i,l,e.binder);;){if(n=n.nextSibling,null==n||"else"!==n.tagName)break;e.Switch.push({node:n,elements:null}),n.expression&&L(n.expression,o,i,l,e.binder)}null!=t&&(e.Switch[t].elements=r)}e.registerHandler("+if",{meta:{serializeNodes:!0},render:function(e,n,r,i,s){for(var l=this,u=t("if",l,e,n,i),a=0,c=l;;){if(c.nodes===u)break;if(a++,c=l.nextSibling,null==c||"else"!==c.tagName){a=null;break}}return this.attr["switch-index"]=a,o(u,e,n,r,i,s)},renderEnd:function(e,t,o,i,s){var l=new n,u=this.attr["switch-index"];return l.placeholder=document.createComment(""),i.appendChild(l.placeholder),r(l,this,u,e,t,o,i,s),l},serializeNodes:function(n){for(var t=[n];;){if(n=n.nextSibling,null==n||"else"!==n.tagName)break;t.push(n)}return e.stringify(t)}}),n.prototype={compoName:"+if",ctx:null,model:null,controller:null,index:null,Switch:null,binder:null,refresh:function(){for(var n,t=this,r=t.Switch,o=r.length,s=-1,l=t.index,a=t.model,c=t.ctx,f=t.controller;++s<o&&(n=r[s].node.expression,null!=n)&&!T(n,a,c,f););if(l!==s){if(null!=l&&u(r[l].elements,!1),s===o)return void(t.index=null);this.index=s;var p=r[s];if(null!=p.elements)return void u(p.elements,!0);var d=e.render(p.node.nodes,a,c,null,f),h=d.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_Array_slice.call(d.childNodes):d;i(d,t.placeholder),p.elements=h}},dispose:function(){for(var e,n,t=this.Switch,r=t.length,o=-1;++o<r;)e=t[o],n=e.node.expression,n&&M(n,this.model,this.controller,this.binder),e.node=null,e.elements=null;this.controller=null,this.model=null,this.ctx=null}}}(),function(){function n(){}function t(e,n,t,r,o){if(l=f.getNodes(e,n,t,r,o),c=null,null!=l){for(var i=n.length,s=-1;++s<i&&n[s].nodes!==l;);c=s===i?null:s}}function r(e,n,t,r,o,i,s,l){e.ctx=i,e.expr=n.expression,e.model=o,e.controller=l,e.index=t,e.nodes=n.nodes,e.refresh=fn_proxy(e.refresh,e),e.binder=P(e.expr,o,i,l,e.refresh),e.Switch=new Array(n.nodes.length),null!=t&&(e.Switch[t]=r),L(n.expression,o,i,l,e.binder)}var l,c,f=a["switch"],p="switch-index";e.registerHandler("+switch",{meta:{serializeNodes:!0},serializeNodes:function(n){return e.stringify(n)},render:function(e,n,r,i,s){var u=T(this.expression,e,n,i);return t(u,this.nodes,e,n,i),null==l?null:(this.attr[p]=c,o(l,e,n,r,i,s))},renderEnd:function(e,t,o,i,l){var u=new n,a=this.attr[p];return s(u,i),r(u,this,a,e,t,o,i,l),u}}),n.prototype={compoName:"+switch",ctx:null,model:null,controller:null,index:null,nodes:null,Switch:null,binder:null,refresh:function(n){var r=this,o=r.Switch,s=(o.length,r.index),a=r.model,f=r.ctx,p=r.controller;if(t(n,r.nodes,a,f,p),c!==s){if(null!=s&&u(o[s],!1),null==c)return void(r.index=null);this.index=c;var d=o[c];if(null!=d)return void u(d,!0);var h=e.render(l,a,f,null,p),m=h.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_Array_slice.call(h.childNodes):h;i(h,r.placeholder),o[c]=m}},dispose:function(){M(this.expr,this.model,this.controller,this.binder),this.controller=null,this.model=null,this.ctx=null;var e,n,t,r,o=this.Switch;for(e in o)if(n=o[e],null!=n)for(r=n.length,t=-1;++t<r;)null!=n[t].parentNode&&n[t].parentNode.removeChild(n[t])}}}(),function(){function t(e){this.expr=e.expression,this.nodes=e.nodes}function o(e,n,t,r,o){var i=[];return builder_build(e,n,t,r,o,i),i}a["with"];e.registerHandler("+with",{meta:{serializeNodes:!0},rootModel:null,render:function(e,n,t,r){var i=this.expression,s=this.nodes,l=D(i,e,n,r);return this.rootModel=e,o(s,l,n,t,r)},onRenderStartClient:function(e,n){this.rootModel=e,this.model=D(this.expression,e,n,this)},renderEnd:function(e,n,r,o,i){n=this.rootModel||n;var l=new t(this);return l.elements=e,l.model=n,l.parent=i,l.refresh=fn_proxy(l.refresh,l),l.binder=P(l.expr,n,r,i,l.refresh),L(l.expr,n,r,i,l.binder),s(l,o),l}}),t.prototype={compoName:"+with",elements:null,binder:null,model:null,parent:null,refresh:function(e){if(r(this.elements),this.components){for(var t=this.components.length,s=-1;++s<t;)n.dispose(this.components[s]);this.components.length=0}var l=document.createDocumentFragment();this.elements=o(this.nodes,e,null,l,this),i(l,this.placeholder),O(this)},dispose:function(){M(this.expr,this.model,this.parent,this.binder),this.parent=null,this.model=null,this.ctx=null}}}(),function(){function n(e){this.expr=e.expression,this.nodes=e.nodes}function t(e,n,t,r,o){var i=[];return builder_build(e,n,t,r,o,i),i}var r=a.visible;e.registerHandler("+visible",{meta:{serializeNodes:!0},render:function(e,n,r,o){return t(this.nodes,e,n,r,o)},renderEnd:function(e,t,r,o,i){var s=new n(this);return s.elements=e,s.model=t,s.parent=i,s.refresh=fn_proxy(s.refresh,s),s.binder=P(s.expr,t,r,i,s.refresh),L(s.expr,t,r,i,s.binder),s.refresh(),s}}),n.prototype={compoName:"+visible",elements:null,binder:null,model:null,parent:null,refresh:function(){var e=T(this.expr,this.model,this.ctx,this);r.toggle(this.elements,e)},dispose:function(){M(this.expr,this.model,this.parent,this.binder),this.parent=null,this.model=null,this.ctx=null}}}(),function(){function n(e){for(var n,t=e.length,r=-1;++r<t;)switch(n=e[r],typeof n){case"string":case"number":case"boolean":e[r]=Object(n)}}function t(e,n){for(var t=e.node.components,r=0,o=t.length,s=0,l=null,u=null,a=null,c=document.createDocumentFragment(),f=[];o>r;r++)if(a=t[r],null!=a.elements&&0!==a.elements.length)for(s=0,l=a.elements.length;l>s;s++)u=a.elements[s],u.parentNode.removeChild(u);e:for(s=0,l=n.length;l>s;s++){for(r=0;o>r;r++)if(n[s]===e._getModel(t[r])){f[s]=t[r];continue e}console.warn("No Model Found for",n[s])}for(r=0,o=f.length;o>r;r++)if(a=f[r],null!=a.elements&&0!==a.elements.length)for(s=0,l=a.elements.length;l>s;s++)u=a.elements[s],c.appendChild(u);e.components=e.node.components=f,i(c,e.placeholder)}function r(e,n,t,r,o){var i=e.node,s=i.components;null==s&&(s=i.components=[]);var l=(e.prop1,e.prop2,e.type,e.ctx),u=e.node;if(null!=n&&null!=t){var a=n,c=n+t;for(c>s.length&&(c=s.length);c>a;a++)j(s[a],i)&&(a--,c--)}if(null!=r&&o&&o.length){var f,a=s.length,p=e._build(i,o,l,u),d=s.splice(a);for(N(i,r,p,e.placeholder),s.splice.apply(s,[r,0].concat(d)),a=0,f=d.length;f>a;a++)y.signal.emitIn(d[a],"domInsert")}}function o(e,n){for(var t,r=e.components,o=r.length;--o>-1;)t=r[o],-1!==n.indexOf(t.model)&&j(t,e.node)}var s={model:null,parent:null,refresh:function(e,s,l,u){var a,c=0,f=this.node,p=(this.model,this.ctx),d=this.node;if(null==s){var h=f.components;if(null!=h){for(var a=h.length,c=-1;++c<a;)j(h[c],f)&&(c--,a--);h.length=0}var m=this._build(f,e,p,d);return i(m,this.placeholder),void arr_each(f.components,O)}var v=e;switch(n(e),s){case"push":r(this,null,null,v.length-1,v.slice(v.length-1));break;case"pop":r(this,v.length,1);break;case"unshift":r(this,null,null,0,v.slice(0,1));break;case"shift":r(this,0,1);break;case"splice":var g=l[0],_=1===l.length?this.components.length:l[1],y=l.length>2?v.slice(l[0],l.length-2+l[0]):null;r(this,g,_,g,y);break;case"sort":case"reverse":t(this,v);break;case"remove":null!=u&&u.length&&o(this,u)}},dispose:function(){M(this.expr||this.expression,this.model,this.parent,this.binder)}};!function(){function t(e,n){this.prop1=n[o],this.prop2=n[i],this.type=n[u],this.expr=n[c],null==e.components&&(e.components=[]),this.node=e,this.components=e.components}var r=a["for"],o="for-prop-1",i="for-prop-2",u="for-type",c="for-expr";e.registerHandler("+for",{meta:{serializeNodes:!0},serializeNodes:function(n){return e.stringify(n)},render:function(e,t,s,l,a){var f=r.parseFor(this.expression),p=this.attr;p[o]=f[0],p[i]=f[1],p[u]=f[2],p[c]=f[3];var d=D(f[3],e,t,l);null!=d&&(is_Array(d)&&n(d),r.build(d,f,this.nodes,e,t,s,this,a))},renderEnd:function(e,n,r,o,i){var s=new t(this,this.attr);return s.placeholder=document.createComment(""),o.appendChild(s.placeholder),l(s,this,n,r,o,i),s},getHandler:function(e,n){return r.getHandler(e,n)}}),t.prototype={compoName:"+for",model:null,parent:null,refresh:s.refresh,dispose:s.dispose,_getModel:function(e){return e.scope[this.prop1]},_build:function(e,n,t,o){var i=r.getNodes(e.nodes,n,this.prop1,this.prop2,this.type);return builder_build(i,this.model,t,null,o)}}}(),function(){function t(e,n,t,o,i,s){for(var l,u=n.length,a=(new Array(u),0);u>a;a++)l=r(e,a),builder_build(l,n[a],t,o,i,s)}function r(e,n){var t=new o;return t.scope={index:n},{type:Dom.COMPONENT,tagName:"each::item",nodes:e,controller:function(){return t}}}function o(){}function i(e){this.expression=e.expression,this.nodes=e.nodes,null==e.components&&(e.components=[]),this.node=e,this.components=e.components
}a.each;e.registerHandler("+each",{meta:{serializeNodes:!0},serializeNodes:function(n){return e.stringify(n)},render:function(e,r,o,i,s){var l=T(this.expression,e,r,i);null!=l&&(n(l),t(this.nodes,l,r,o,this,s))},renderEnd:function(e,n,t,r,o){var s=new i(this,this.attr);return s.placeholder=document.createComment(""),r.appendChild(s.placeholder),l(s,this,n,t,r,o),s}}),e.registerHandler("each::item",o),o.prototype={compoName:"each::item",scope:null,model:null,modelRef:null,parent:null,renderStart:_===!0?function(){var e=this.parent.expression;this.modelRef=""+("."===e?"":"("+e+")")+'."'+this.scope.index+'"'}:null,renderEnd:function(e){this.elements=e},dispose:function(){null!=this.elements&&(this.elements.length=0,this.elements=null)}},i.prototype={compoName:"+each",refresh:s.refresh,dispose:s.dispose,_getModel:function(e){return e.model},_build:function(e,n,r,o){var i=document.createDocumentFragment();return t(e.nodes,n,r,i,o),i}}}()}()}()}(Mask,Compo),function(){Mask.registerHandler(":html",{$meta:{mode:"server:all"},render:function(e,n,t){if(this.html=jmask(this.nodes).text(e,n,this),t.insertAdjacentHTML)return void t.insertAdjacentHTML("beforeend",this.html);if(t.ownerDocument){var r,o=document.createElement("div"),i=document.createDocumentFragment();for(o.innerHTML=this.html,r=o.firstChild;null!=r;)i.appendChild(r),r=r.nextSibling}},toHtml:function(){return this.html||""},html:null})}(),function(e){function n(e){this.name=e.name,this["extends"]=e["extends"]}function t(){for(var n,t=this.nodes,r={renderStart:function(){this.nodes=e.merge(t,this.nodes||[],this),null!=this.onRenderStart&&this.onRenderStart.apply(this,arguments)}},o=t.length,i=0;o>i;i++)n=t[i],"function"===n.tagName&&(r[n.name]=n.fn,n.render=null);e.registerHandler(this.name,Compo(r))}custom_Tags.define=n,n.prototype={name:null,"extends":null,$meta:{serializeNodes:!0},render:t,onRenderStartClient:t}}(Mask),function(){var e={},n={get:function(n){return e[n]},resolve:function(n,t){var r=e[t];if(null!=r)return r;for(var o=":template[id="+t+"]",i=n.parent,s=null;null!=i;){if(s=jmask(i.nodes).filter(o).get(0),null!=s)return s.nodes;i=i.parent}return log_warn("Template was not found",t),null},register:function(n,t){return null==n?void log_warn("`:template` must be define via id attr."):void(e[n]=t)}};Mask.templates=n,Mask.registerHandler(":template",{render:function(){n.register(this.attr.id,this.nodes)}}),Mask.registerHandler(":import",{renderStart:function(){var e=this.attr.id;return null==e?void log_error("`:import` shoud reference the template via id attr"):void(this.nodes=n.resolve(this,e))}})}(),function(){custom_Statements.log={render:function(e,n,t,r,o){var i=ExpressionUtil.evalStatements(e.expression,n,t,o);i.unshift("Mask::Log"),console.log.apply(console,i)}},customTag_register("debugger",{render:function(){}}),customTag_register(":utest",Compo({render:function(e,n,t){t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(t=t.childNodes),this.$=$(t)}}))}(),Mask.Compo=Compo,Mask.jmask=jmask,exports.mask=Mask});
//# sourceMappingURL=mask.min.js.map